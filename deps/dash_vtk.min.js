window.dash_vtk=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=29)}([function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"VOID",(function(){return a})),n.d(t,"setLoggerFunction",(function(){return c})),n.d(t,"vtkLogMacro",(function(){return u})),n.d(t,"vtkInfoMacro",(function(){return d})),n.d(t,"vtkDebugMacro",(function(){return f})),n.d(t,"vtkErrorMacro",(function(){return p})),n.d(t,"vtkWarningMacro",(function(){return m})),n.d(t,"vtkOnceErrorMacro",(function(){return h})),n.d(t,"TYPED_ARRAYS",(function(){return A})),n.d(t,"capitalize",(function(){return v})),n.d(t,"uncapitalize",(function(){return y})),n.d(t,"formatBytesToProperUnit",(function(){return b})),n.d(t,"formatNumbersWithThousandSeparator",(function(){return T})),n.d(t,"setImmediateVTK",(function(){return E})),n.d(t,"obj",(function(){return M})),n.d(t,"get",(function(){return S})),n.d(t,"set",(function(){return P})),n.d(t,"setGet",(function(){return O})),n.d(t,"getArray",(function(){return I})),n.d(t,"setArray",(function(){return D})),n.d(t,"setGetArray",(function(){return V})),n.d(t,"algo",(function(){return L})),n.d(t,"EVENT_ABORT",(function(){return _})),n.d(t,"event",(function(){return F})),n.d(t,"newInstance",(function(){return N})),n.d(t,"chain",(function(){return B})),n.d(t,"isVtkObject",(function(){return k})),n.d(t,"traverseInstanceTree",(function(){return G})),n.d(t,"debounce",(function(){return U})),n.d(t,"throttle",(function(){return W})),n.d(t,"keystore",(function(){return z})),n.d(t,"proxy",(function(){return j})),n.d(t,"proxyPropertyMapping",(function(){return K})),n.d(t,"proxyPropertyState",(function(){return X})),n.d(t,"normalizeWheel",(function(){return Q}));var r=n(3);let o=0;const a=Symbol("void");const i={};function s(){}["log","debug","info","warn","error","time","timeEnd","group","groupEnd"].forEach(e=>{i[e]=s}),e.console=console.hasOwnProperty("log")?console:i;const l={debug:s,error:e.console.error||s,info:e.console.info||s,log:e.console.log||s,warn:e.console.warn||s};function c(e,t){l[e]&&(l[e]=t||s)}function u(...e){l.log(...e)}function d(...e){l.info(...e)}function f(...e){l.debug(...e)}function p(...e){l.error(...e)}function m(...e){l.warn(...e)}const g={};function h(e){g[e]||(l.error(e),g[e]=!0)}const A={Float32Array:Float32Array,Float64Array:Float64Array,Uint8Array:Uint8Array,Int8Array:Int8Array,Uint16Array:Uint16Array,Int16Array:Int16Array,Uint32Array:Uint32Array,Int32Array:Int32Array};function v(e){return e.charAt(0).toUpperCase()+e.slice(1)}function y(e){return e.charAt(0).toLowerCase()+e.slice(1)}function b(e,t=2,n=1e3){const r=["TB","GB","MB","KB"];let o=Number(e),a="B";for(;o>n;)o/=n,a=r.pop();return`${o.toFixed(t)} ${a}`}function T(e,t=" "){const n=[];let r=e;for(;r>1e3;)n.push(("000"+r%1e3).slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(t)}function x(e){Object.keys(e).forEach(t=>{Array.isArray(e[t])&&(e[t]=[].concat(e[t]))})}function C(e){return e.isA?e.getState():e}function E(e){setTimeout(e,0)}function M(e={},t={}){x(t);const n=[];function r(e){n[e]=null}return Number.isInteger(t.mtime)||(t.mtime=++o),t.classHierarchy=["vtkObject"],e.isDeleted=()=>!!t.deleted,e.modified=r=>{t.deleted?p("instance deleted - cannot call any method"):r&&r<e.getMTime()||(t.mtime=++o,n.forEach(t=>t&&t(e)))},e.onModified=e=>{if(t.deleted)return p("instance deleted - cannot call any method"),null;const o=n.length;return n.push(e),function(e){return Object.freeze({unsubscribe:function(){r(e)}})}(o)},e.getMTime=()=>t.mtime,e.isA=e=>{let n=t.classHierarchy.length;for(;n--;)if(t.classHierarchy[n]===e)return!0;return!1},e.getClassName=(e=0)=>t.classHierarchy[t.classHierarchy.length-1-e],e.set=(n={},r=!1,o=!1)=>{let a=!1;return Object.keys(n).forEach(i=>{const s=o?null:e["set"+v(i)];s&&Array.isArray(n[i])&&s.length>1?a=s(...n[i])||a:s?a=s(n[i])||a:(-1!==["mtime"].indexOf(i)||r||m(`Warning: Set value to model directly ${i}, ${n[i]}`),t[i]=n[i],a=!0)}),a},e.get=(...e)=>{if(!e.length)return t;const n={};return e.forEach(e=>{n[e]=t[e]}),n},e.getReferenceByName=e=>t[e],e.delete=()=>{Object.keys(t).forEach(e=>delete t[e]),n.forEach((e,t)=>r(t)),t.deleted=!0},e.getState=()=>{const n={...t,vtkClass:e.getClassName()};Object.keys(n).forEach(e=>{null===n[e]||void 0===n[e]?delete n[e]:n[e].isA?n[e]=n[e].getState():Array.isArray(n[e])&&(n[e]=n[e].map(C))});const r={};return Object.keys(n).sort().forEach(e=>{r[e]=n[e]}),r.mtime&&delete r.mtime,r},e.shallowCopy=(n,r=!1)=>{if(n.getClassName()!==e.getClassName())throw new Error(`Cannot ShallowCopy ${n.getClassName()} into ${e.getClassName()}`);const o=n.get(),a=Object.keys(t).sort();Object.keys(o).sort().forEach(e=>{const n=a.indexOf(e);-1===n?r&&f(`add ${e} in shallowCopy`):a.splice(n,1),t[e]=o[e]}),a.length&&r&&f("Untouched keys: "+a.join(", ")),e.modified()},e}function S(e,t,n){n.forEach(n=>{"object"==typeof n?e["get"+v(n.name)]=()=>t[n.name]:e["get"+v(n)]=()=>t[n]})}const w={enum:(e,t,n)=>r=>{if("string"==typeof r){if(void 0!==n.enum[r])return t[n.name]!==n.enum[r]&&(t[n.name]=n.enum[r],e.modified(),!0);throw p(`Set Enum with invalid argument ${n}, ${r}`),new RangeError("Set Enum with invalid string argument")}if("number"==typeof r){if(t[n.name]!==r){if(-1!==Object.keys(n.enum).map(e=>n.enum[e]).indexOf(r))return t[n.name]=r,e.modified(),!0;throw p(`Set Enum outside numeric range ${n}, ${r}`),new RangeError("Set Enum outside numeric range")}return!1}throw p(`Set Enum with invalid argument (String/Number) ${n}, ${r}`),new TypeError("Set Enum with invalid argument (String/Number)")}};function R(e){if("object"==typeof e){const t=w[e.type];if(t)return(n,r)=>t(n,r,e);throw p("No setter for field "+e),new TypeError("No setter for field")}return function(t,n){return function(r){return n.deleted?(p("instance deleted - cannot call any method"),!1):n[e]!==r&&(n[e]=r,t.modified(),!0)}}}function P(e,t,n){n.forEach(n=>{"object"==typeof n?e["set"+v(n.name)]=R(n)(e,t):e["set"+v(n)]=R(n)(e,t)})}function O(e,t,n){S(e,t,n),P(e,t,n)}function I(e,t,n){n.forEach(n=>{e["get"+v(n)]=()=>[].concat(t[n]),e[`get${v(n)}ByReference`]=()=>t[n]})}function D(e,t,n,r,o){n.forEach(n=>{e["set"+v(n)]=(...a)=>{if(t.deleted)return p("instance deleted - cannot call any method"),!1;let i=a;if(1===i.length&&Array.isArray(i[0])&&(i=i[0]),i.length!==r){if(!(i.length<r&&void 0!==o))throw new RangeError(`Invalid number of values for array setter (${n})`);for(i=[].concat(i);i.length<r;)i.push(o)}let s=!1;return t[n].forEach((e,t)=>{if(e!==i[t]){if(s)return;s=!0}}),!(!s&&t[n].length===i.length)&&(t[n]=[].concat(i),e.modified(),!0)},e[`set${v(n)}From`]=e=>{const r=t[n];e.forEach((e,t)=>{r[t]=e})}})}function V(e,t,n,r,o){I(e,t,n),D(e,t,n,r,o)}function L(e,t,n,o){function a(n,r=0){t.deleted?p("instance deleted - cannot call any method"):r>=t.numberOfInputs?p(`algorithm ${e.getClassName()} only has ${t.numberOfInputs} input ports. To add more input ports, use addInputData()`):(t.inputData[r]!==n||t.inputConnection[r])&&(t.inputData[r]=n,t.inputConnection[r]=null,e.modified&&e.modified())}function i(n,r=0){if(t.deleted)p("instance deleted - cannot call any method");else{if(r>=t.numberOfInputs){let n=`algorithm ${e.getClassName()} only has `;return n+=""+t.numberOfInputs,n+=" input ports. To add more input ports, use addInputConnection()",void p(n)}t.inputData[r]=null,t.inputConnection[r]=n}}function s(n=0){return t.deleted?(p("instance deleted - cannot call any method"),null):(e.shouldUpdate()&&e.update(),t.output[n])}if(t.inputData?t.inputData=t.inputData.map(r.a):t.inputData=[],t.inputConnection?t.inputConnection=t.inputConnection.map(r.a):t.inputConnection=[],t.output?t.output=t.output.map(r.a):t.output=[],t.inputArrayToProcess?t.inputArrayToProcess=t.inputArrayToProcess.map(r.a):t.inputArrayToProcess=[],t.numberOfInputs=n,e.shouldUpdate=()=>{const n=e.getMTime();let r=o,a=1/0;for(;r--;){if(!t.output[r])return!0;const e=t.output[r].getMTime();if(e<n)return!0;e<a&&(a=e)}for(r=t.numberOfInputs;r--;)if(t.inputConnection[r]&&t.inputConnection[r].filter.shouldUpdate())return!0;for(r=t.numberOfInputs;r--;)if(e.getInputData(r)&&e.getInputData(r).getMTime()>a)return!0;return!1},t.numberOfInputs){let n=t.numberOfInputs;for(;n--;)t.inputData.push(null),t.inputConnection.push(null);e.setInputData=a,e.setInputConnection=i,e.addInputData=function(e){t.deleted?p("instance deleted - cannot call any method"):(t.numberOfInputs++,a(e,t.numberOfInputs-1))},e.addInputConnection=function(e){t.deleted?p("instance deleted - cannot call any method"):(t.numberOfInputs++,i(e,t.numberOfInputs-1))},e.getInputData=function(e=0){return t.inputConnection[e]&&(t.inputData[e]=t.inputConnection[e]()),t.inputData[e]},e.getInputConnection=function(e=0){return t.inputConnection[e]}}o&&(e.getOutputData=s,e.getOutputPort=function(t=0){const n=()=>s(t);return n.filter=e,n}),e.update=()=>{const n=[];if(t.numberOfInputs){let r=0;for(;r<t.numberOfInputs;)n[r]=e.getInputData(r),r++}e.shouldUpdate()&&e.requestData&&e.requestData(n,t.output)},e.getNumberOfInputPorts=()=>t.numberOfInputs,e.getNumberOfOutputPorts=()=>o||t.output.length,e.getInputArrayToProcess=e=>{const n=t.inputArrayToProcess[e],r=t.inputData[e];return n&&r?r["get"+n.fieldAssociation]().getArray(n.arrayName):null},e.setInputArrayToProcess=(e,n,r,o="Scalars")=>{for(;t.inputArrayToProcess.length<e;)t.inputArrayToProcess.push(null);t.inputArrayToProcess[e]={arrayName:n,fieldAssociation:r,attributeType:o}}}const _=Symbol("Event abort");function F(e,t,n){const r=[],o=e.delete;let a=1;function i(e){for(let t=0;t<r.length;++t){const[n]=r[t];if(n===e)return void r.splice(t,1)}}e["invoke"+v(n)]=function(){if(t.deleted)return void p("instance deleted - cannot call any method");const n=r.slice();for(let t=0;t<n.length;++t){const[,r,o]=n[t];if(r)if(o<0)setTimeout(()=>r.apply(e,arguments),1-o);else{if(r.apply(e,arguments)===_)break}}},e["on"+v(n)]=(e,o=0)=>{if(!e.apply)return console.error("Invalid callback for event "+n),null;if(t.deleted)return p("instance deleted - cannot call any method"),null;const s=a++;return r.push([s,e,o]),r.sort((e,t)=>t[2]-e[2]),function(e){return Object.freeze({unsubscribe:function(){i(e)}})}(s)},e.delete=()=>{o(),r.forEach(([e])=>i(e))}}function N(e,t){const n=(t={})=>{const n={};return e(n,{},t),Object.freeze(n)};return t&&r.a.register(t,n),n}function B(...e){return(...t)=>e.filter(e=>!!e).map(e=>e(...t))}function k(e){return e&&e.isA&&e.isA("vtkObject")}function G(e,t,n=[],r=[]){if(k(e)){if(r.indexOf(e)>=0)return n;r.push(e);const o=t(e);void 0!==o&&n.push(o);const a=e.get();Object.keys(a).forEach(e=>{const o=a[e];Array.isArray(o)?o.forEach(e=>{G(e,t,n,r)}):G(o,t,n,r)})}return n}function U(e,t,n){let r;return(...o)=>{const a=this,i=n&&!r;clearTimeout(r),r=setTimeout(()=>{r=null,n||e.apply(a,o)},t),i&&e.apply(a,o)}}function W(e,t){let n=!1,r=null;function o(){n=!1,null!==r&&(a(...r),r=null)}function a(...a){n?r=a:(n=!0,e(...a),setTimeout(o,t))}return a}function z(e,t,n={}){t.keystore=Object.assign(t.keystore||{},n),e.setKey=(e,n)=>{t.keystore[e]=n},e.getKey=e=>t.keystore[e],e.getAllKeys=()=>Object.keys(t.keystore),e.deleteKey=e=>delete t.keystore[e],e.clearKeystore=()=>e.getAllKeys().forEach(e=>delete t.keystore[e])}let H=1;function j(e,t){z(e,t);const n=e.delete;t.proxyId=""+H++,t.ui=JSON.parse(JSON.stringify(t.ui||[])),S(e,t,["proxyId","proxyGroup","proxyName"]),O(e,t,["proxyManager"]);const r={},o={};function a(e,t){o[t]||(o[t]=[]);const n=o[t];for(let t=0;t<e.length;t++)n.push(e[t].name),r[e[t].name]=e[t],e[t].children&&e[t].children.length&&a(e[t].children,e[t].name)}function i(n="__root__"){const r=[],a=t.proxyId,s=function(e="__root__"){return o[e]}(n)||[];for(let t=0;t<s.length;t++){const n=s[t],o=e["get"+v(n)],l={id:a,name:n,value:o?o():void 0},c=i(n);c.length&&(l.children=c),r.push(l)}return r}a(t.ui,"__root__"),e.updateUI=n=>{t.ui=JSON.parse(JSON.stringify(n||[])),Object.keys(r).forEach(e=>delete r[e]),Object.keys(o).forEach(e=>delete o[e]),a(t.ui,"__root__"),e.modified()},e.updateProxyProperty=(e,t)=>{const n=r[e];n?Object.assign(n,t):r[e]={...t}},e.activate=()=>{if(t.proxyManager){const n="setActive"+v(e.getProxyGroup().slice(0,-1));t.proxyManager[n]&&t.proxyManager[n](e)}},t.propertyLinkSubscribers={},e.registerPropertyLinkForGC=(e,n)=>{n in t.propertyLinkSubscribers||(t.propertyLinkSubscribers[n]=[]),t.propertyLinkSubscribers[n].push(e)},e.gcPropertyLinks=n=>{const r=t.propertyLinkSubscribers[n]||[];for(;r.length;)r.pop().unbind(e)},t.propertyLinkMap={},e.getPropertyLink=(e,n=!1)=>{if(t.propertyLinkMap[e])return t.propertyLinkMap[e];let r=null;const o=[];let a=0,i=!1;function s(n,s=!1){if(i)return null;const l=[];let c=null;for(a=o.length;a--;){const e=o[a];e.instance===n?c=e:l.push(e)}if(!c)return null;const u=c.instance["get"+v(c.propertyName)]();if(!function(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}(u,r)||s){for(r=u,i=!0;l.length;){const e=l.pop();e.instance.set({[e.propertyName]:r})}i=!1}return t.propertyLinkMap[e].persistent&&(t.propertyLinkMap[e].value=u),u}function l(e,t){const n=[];for(a=o.length;a--;){const r=o[a];r.instance!==e||r.propertyName!==t&&void 0!==t||(r.subscription.unsubscribe(),n.push(a))}for(;n.length;)o.splice(n.pop(),1)}const c={bind:function(n,r,a=!1){const i=n.onModified(s),c=o[0];return o.push({instance:n,propertyName:r,subscription:i}),a&&(t.propertyLinkMap[e].persistent&&void 0!==t.propertyLinkMap[e].value?n.set({[r]:t.propertyLinkMap[e].value}):c&&s(c.instance,!0)),{unsubscribe:()=>l(n,r)}},unbind:l,unsubscribe:function(){for(;o.length;)o.pop().subscription.unsubscribe()},persistent:n};return t.propertyLinkMap[e]=c,c},e.listPropertyNames=()=>i().map(e=>e.name),e.getPropertyByName=e=>i().find(t=>t.name===e),e.getPropertyDomainByName=e=>(r[e]||{}).domain,e.getProxySection=()=>({id:t.proxyId,name:t.proxyGroup,ui:t.ui,properties:i()}),e.delete=()=>{const r=Object.keys(t.propertyLinkMap);let o=r.length;for(;o--;)t.propertyLinkMap[r[o]].unsubscribe();Object.keys(t.propertyLinkSubscribers).forEach(e.gcPropertyLinks),n()},E((function(){if(t.links)for(let n=0;n<t.links.length;n++){const{link:r,property:o,persistent:a,updateOnBind:i,type:s}=t.links[n];if("application"===s){const n=t.proxyManager.getPropertyLink(r,a);e.registerPropertyLinkForGC(n,"application"),n.bind(e,o,i)}}}))}function K(e,t,n){const r=e.delete,o=[],a=Object.keys(n);let i=a.length;for(;i--;){const r=a[i],{modelKey:s,property:l,modified:c=!0}=n[r],u=v(l),d=v(r);e["get"+d]=t[s]["get"+u],e["set"+d]=t[s]["set"+u],c&&o.push(t[s].onModified(e.modified))}e.delete=()=>{for(;o.length;)o.pop().unsubscribe();r()}}function X(e,t,n={},r={}){function o(e){const n=Object.keys(e);let r=n.length;for(;r--;){const o=n[r];t[o].set(e[o])}}t.this=e;const a=Object.keys(r);let i=a.length;for(;i--;){const s=a[i];t[s]=r[s];const l=n[s];e["set"+v(s)]=n=>{if(n!==t[s]){t[s]=n;o(l[n]),e.modified()}}}a.length&&S(e,t,a)}function Q(e){let t=0,n=0,r=0,o=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=10*t,o=10*n,"deltaY"in e&&(o=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||o)&&e.deltaMode&&(1===e.deltaMode?(r*=40,o*=40):(r*=800,o*=800)),r&&!t&&(t=r<1?-1:1),o&&!n&&(n=o<1?-1:1),{spinX:t,spinY:n,pixelX:r,pixelY:o}}t.default={algo:L,capitalize:v,chain:B,debounce:U,enumToString:function(e,t){return Object.keys(e).find(n=>e[n]===t)},event:F,EVENT_ABORT:_,formatBytesToProperUnit:b,formatNumbersWithThousandSeparator:T,get:S,getArray:I,getCurrentGlobalMTime:function(){return o},getStateArrayMapFunc:C,isVtkObject:k,keystore:z,newInstance:N,normalizeWheel:Q,obj:M,proxy:j,proxyPropertyMapping:K,proxyPropertyState:X,safeArrays:x,set:P,setArray:D,setGet:O,setGetArray:V,setImmediate:E,setLoggerFunction:c,throttle:W,traverseInstanceTree:G,TYPED_ARRAYS:A,uncapitalize:y,VOID:a,vtkDebugMacro:f,vtkErrorMacro:p,vtkInfoMacro:d,vtkLogMacro:u,vtkOnceErrorMacro:h,vtkWarningMacro:m}}.call(this,n(9))},function(e,t){e.exports=window.PropTypes},function(e,t){e.exports=window.React},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));const r={vtkObject:()=>null};function o(t){if(null==t)return t;if(t.isA)return t;if(!t.vtkClass)return e.console&&e.console.error&&e.console.error("Invalid VTK object"),null;const n=r[t.vtkClass];if(!n)return e.console&&e.console.error&&e.console.error("No vtk class found for Object of type "+t.vtkClass),null;const a={...t};Object.keys(a).forEach(e=>{a[e]&&"object"==typeof a[e]&&a[e].vtkClass&&(a[e]=o(a[e]))});const i=n(a);return i&&i.modified&&i.modified(),i}o.register=function(e,t){r[e]=t}}).call(this,n(9))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){e.exports="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyDataFS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// Template for the polydata mappers fragment shader\n\nuniform int PrimitiveIDOffset;\n\n// VC position of this fragment\n//VTK::PositionVC::Dec\n\n// optional color passed in from the vertex shader, vertexColor\n//VTK::Color::Dec\n\n// optional surface normal declaration\n//VTK::Normal::Dec\n\n// extra lighting parameters\n//VTK::Light::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// picking support\n//VTK::Picking::Dec\n\n// Depth Peeling Support\n//VTK::DepthPeeling::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// the output of this shader\n//VTK::Output::Dec\n\n// Apple Bug\n//VTK::PrimID::Dec\n\n// handle coincident offsets\n//VTK::Coincident::Dec\n\n//VTK::ZBuffer::Dec\n\nvoid main()\n{\n  // VC position of this fragment. This should not branch/return/discard.\n  //VTK::PositionVC::Impl\n\n  // Place any calls that require uniform flow (e.g. dFdx) here.\n  //VTK::UniformFlow::Impl\n\n  // Set gl_FragDepth here (gl_FragCoord.z by default)\n  //VTK::Depth::Impl\n\n  // Early depth peeling abort:\n  //VTK::DepthPeeling::PreColor\n\n  // Apple Bug\n  //VTK::PrimID::Impl\n\n  //VTK::Clip::Impl\n\n  //VTK::Color::Impl\n\n  // Generate the normal if we are not passed in one\n  //VTK::Normal::Impl\n\n  //VTK::Light::Impl\n\n  //VTK::TCoord::Impl\n\n  if (gl_FragData[0].a <= 0.0)\n    {\n    discard;\n    }\n\n  //VTK::DepthPeeling::Impl\n\n  //VTK::Picking::Impl\n\n  // handle coincident offsets\n  //VTK::Coincident::Impl\n\n  //VTK::ZBuffer::Impl\n}\n"},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t){e.exports="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyDataVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\nattribute vec4 vertexMC;\n\n// frag position in VC\n//VTK::PositionVC::Dec\n\n// optional normal declaration\n//VTK::Normal::Dec\n\n// extra lighting parameters\n//VTK::Light::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// material property values\n//VTK::Color::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\n// Apple Bug\n//VTK::PrimID::Dec\n\n// picking support\n//VTK::Picking::Dec\n\nvoid main()\n{\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Clip::Impl\n\n  //VTK::PrimID::Impl\n\n  //VTK::PositionVC::Impl\n\n  //VTK::Light::Impl\n\n  //VTK::Picking::Impl\n}\n"},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(21),o=n(22),a=n(23),i=n(24),s=n(25),l=n(26),c=n(27);c.alea=r,c.xor128=o,c.xorwow=a,c.xorshift7=i,c.xor4096=s,c.tychei=l,e.exports=c},function(e,t){e.exports="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkSphereMapperVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// this shader implements imposters in OpenGL for Spheres\n\nattribute vec4 vertexMC;\nattribute vec2 offsetMC;\n\n// optional normal declaration\n//VTK::Normal::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\nuniform mat3 normalMatrix; // transform model coordinate directions to view coordinates\n\n// material property values\n//VTK::Color::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\nvarying vec4 vertexVCVSOutput;\nvarying float radiusVCVSOutput;\nvarying vec3 centerVCVSOutput;\n\nuniform int cameraParallel;\n\nvoid main()\n{\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Clip::Impl\n\n  // compute the projected vertex position\n  vertexVCVSOutput = MCVCMatrix * vertexMC;\n  centerVCVSOutput = vertexVCVSOutput.xyz;\n  radiusVCVSOutput = length(offsetMC)*0.5;\n\n  // make the triangle face the camera\n  if (cameraParallel == 0)\n    {\n    vec3 dir = normalize(-vertexVCVSOutput.xyz);\n    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));\n    vec3 base1 = cross(base2,dir);\n    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + offsetMC.x*base1 + offsetMC.y*base2;\n    }\n  else\n    {\n    // add in the offset\n    vertexVCVSOutput.xy = vertexVCVSOutput.xy + offsetMC;\n    }\n\n  gl_Position = VCPCMatrix * vertexVCVSOutput;\n}\n"},function(e,t){e.exports="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkStickMapperVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// this shader implements imposters in OpenGL for Sticks\n\nattribute vec4 vertexMC;\nattribute vec3 orientMC;\nattribute vec4 offsetMC;\nattribute float radiusMC;\n\n// optional normal declaration\n//VTK::Normal::Dec\n\n//VTK::Picking::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\nuniform mat3 normalMatrix; // transform model coordinate directions to view coordinates\n\n// material property values\n//VTK::Color::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\nvarying vec4 vertexVCVSOutput;\nvarying float radiusVCVSOutput;\nvarying float lengthVCVSOutput;\nvarying vec3 centerVCVSOutput;\nvarying vec3 orientVCVSOutput;\n\nuniform int cameraParallel;\n\nvoid main()\n{\n  //VTK::Picking::Impl\n\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Clip::Impl\n\n  vertexVCVSOutput = MCVCMatrix * vertexMC;\n  centerVCVSOutput = vertexVCVSOutput.xyz;\n  radiusVCVSOutput = radiusMC;\n  lengthVCVSOutput = length(orientMC);\n  orientVCVSOutput = normalMatrix * normalize(orientMC);\n\n  // make sure it is pointing out of the screen\n  if (orientVCVSOutput.z < 0.0)\n    {\n    orientVCVSOutput = -orientVCVSOutput;\n    }\n\n  // make the basis\n  vec3 xbase;\n  vec3 ybase;\n  vec3 dir = vec3(0.0,0.0,1.0);\n  if (cameraParallel == 0)\n    {\n    dir = normalize(-vertexVCVSOutput.xyz);\n    }\n  if (abs(dot(dir,orientVCVSOutput)) == 1.0)\n    {\n    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));\n    ybase = cross(xbase,orientVCVSOutput);\n    }\n  else\n    {\n    xbase = normalize(cross(orientVCVSOutput,dir));\n    ybase = cross(orientVCVSOutput,xbase);\n    }\n\n  vec3 offsets = offsetMC.xyz*2.0-1.0;\n  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +\n    radiusVCVSOutput*offsets.x*xbase +\n    radiusVCVSOutput*offsets.y*ybase +\n    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;\n\n  gl_Position = VCPCMatrix * vertexVCVSOutput;\n}\n"},function(e,t){e.exports="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyDataVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\nattribute vec4 vertexDC;\n\nvarying vec3 vertexVCVSOutput;\nuniform mat4 PCVCMatrix;\n\nuniform float dcxmin;\nuniform float dcxmax;\nuniform float dcymin;\nuniform float dcymax;\n\nvoid main()\n{\n  // dcsmall is the device coords reduced to the\n  // x y area covered by the volume\n  vec4 dcsmall = vec4(\n    dcxmin + 0.5 * (vertexDC.x + 1.0) * (dcxmax - dcxmin),\n    dcymin + 0.5 * (vertexDC.y + 1.0) * (dcymax - dcymin),\n    vertexDC.z,\n    vertexDC.w);\n  vec4 vcpos = PCVCMatrix * dcsmall;\n  vertexVCVSOutput = vcpos.xyz/vcpos.w;\n  gl_Position = dcsmall;\n}\n"},function(e,t){e.exports="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkVolumeFS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// Template for the volume mappers fragment shader\n\n// the output of this shader\n//VTK::Output::Dec\n\nvarying vec3 vertexVCVSOutput;\n\n// first declare the settings from the mapper\n// that impact the code paths in here\n\n// always set vtkNumComponents 1,2,3,4\n//VTK::NumComponents\n\n// possibly define vtkUseTriliear\n//VTK::TrilinearOn\n\n// possibly define vtkIndependentComponents\n//VTK::IndependentComponentsOn\n\n// possibly define any \"proportional\" components\n//VTK::vtkProportionalComponents\n\n// Define the blend mode to use\n#define vtkBlendMode //VTK::BlendMode\n\n// Possibly define vtkImageLabelOutlineOn\n//VTK::ImageLabelOutlineOn\n\n#ifdef vtkImageLabelOutlineOn\nuniform int outlineThickness;\nuniform float vpWidth;\nuniform float vpHeight;\nuniform mat4 PCWCMatrix;\nuniform mat4 vWCtoIDX;\n#endif\n\n// define vtkLightComplexity\n//VTK::LightComplexity\n#if vtkLightComplexity > 0\nuniform float vSpecularPower;\nuniform float vAmbient;\nuniform float vDiffuse;\nuniform float vSpecular;\n//VTK::Light::Dec\n#endif\n\n// possibly define vtkGradientOpacityOn\n//VTK::GradientOpacityOn\n#ifdef vtkGradientOpacityOn\nuniform float goscale0;\nuniform float goshift0;\nuniform float gomin0;\nuniform float gomax0;\n#if defined(vtkIndependentComponentsOn) && (vtkNumComponents > 1)\nuniform float goscale1;\nuniform float goshift1;\nuniform float gomin1;\nuniform float gomax1;\n#if vtkNumComponents >= 3\nuniform float goscale2;\nuniform float goshift2;\nuniform float gomin2;\nuniform float gomax2;\n#endif\n#if vtkNumComponents >= 4\nuniform float goscale3;\nuniform float goshift3;\nuniform float gomin3;\nuniform float gomax3;\n#endif\n#endif\n#endif\n\n// if you want to see the raw tiled\n// data in webgl1 uncomment the following line\n// #define debugtile\n\n// camera values\nuniform float camThick;\nuniform float camNear;\nuniform float camFar;\nuniform int cameraParallel;\n\n// values describing the volume geometry\nuniform vec3 vOriginVC;\nuniform vec3 vSpacing;\nuniform ivec3 volumeDimensions; // 3d texture dimensions\nuniform vec3 vPlaneNormal0;\nuniform float vPlaneDistance0;\nuniform vec3 vPlaneNormal1;\nuniform float vPlaneDistance1;\nuniform vec3 vPlaneNormal2;\nuniform float vPlaneDistance2;\nuniform vec3 vPlaneNormal3;\nuniform float vPlaneDistance3;\nuniform vec3 vPlaneNormal4;\nuniform float vPlaneDistance4;\nuniform vec3 vPlaneNormal5;\nuniform float vPlaneDistance5;\n\n// opacity and color textures\nuniform sampler2D otexture;\nuniform float oshift0;\nuniform float oscale0;\nuniform sampler2D ctexture;\nuniform float cshift0;\nuniform float cscale0;\n\n// jitter texture\nuniform sampler2D jtexture;\n\n// some 3D texture values\nuniform float sampleDistance;\nuniform vec3 vVCToIJK;\n\n// the heights defined below are the locations\n// for the up to four components of the tfuns\n// the tfuns have a height of 2XnumComps pixels so the\n// values are computed to hit the middle of the two rows\n// for that component\n#ifdef vtkIndependentComponentsOn\n#if vtkNumComponents == 2\nuniform float mix0;\nuniform float mix1;\n#define height0 0.25\n#define height1 0.75\n#endif\n#if vtkNumComponents == 3\nuniform float mix0;\nuniform float mix1;\nuniform float mix2;\n#define height0 0.17\n#define height1 0.5\n#define height2 0.83\n#endif\n#if vtkNumComponents == 4\nuniform float mix0;\nuniform float mix1;\nuniform float mix2;\nuniform float mix3;\n#define height0 0.125\n#define height1 0.375\n#define height2 0.625\n#define height3 0.875\n#endif\n#endif\n\n#if vtkNumComponents >= 2\nuniform float oshift1;\nuniform float oscale1;\nuniform float cshift1;\nuniform float cscale1;\n#endif\n#if vtkNumComponents >= 3\nuniform float oshift2;\nuniform float oscale2;\nuniform float cshift2;\nuniform float cscale2;\n#endif\n#if vtkNumComponents >= 4\nuniform float oshift3;\nuniform float oscale3;\nuniform float cshift3;\nuniform float cscale3;\n#endif\n\n// declaration for intermixed geometry\n//VTK::ZBuffer::Dec\n\n// Lighting values\n//VTK::Light::Dec\n\n//=======================================================================\n// Webgl2 specific version of functions\n#if __VERSION__ == 300\n\nuniform highp sampler3D texture1;\n\nvec4 getTextureValue(vec3 pos)\n{\n  vec4 tmp = texture(texture1, pos);\n#if vtkNumComponents == 1\n  tmp.a = tmp.r;\n#endif\n#if vtkNumComponents == 2\n  tmp.a = tmp.g;\n#endif\n#if vtkNumComponents == 3\n  tmp.a = length(tmp.rgb);\n#endif\n  return tmp;\n}\n\n//=======================================================================\n// WebGL1 specific version of functions\n#else\n\nuniform sampler2D texture1;\n\nuniform float texWidth;\nuniform float texHeight;\nuniform int xreps;\nuniform int xstride;\nuniform int ystride;\n\n// if computing triliear values from multiple z slices\n#ifdef vtkTriliearOn\nvec4 getTextureValue(vec3 ijk)\n{\n  float zoff = 1.0/float(volumeDimensions.z);\n  vec4 val1 = getOneTextureValue(ijk);\n  vec4 val2 = getOneTextureValue(vec3(ijk.xy, ijk.z + zoff));\n\n  float indexZ = float(volumeDimensions)*ijk.z;\n  float zmix =  indexZ - floor(indexZ);\n\n  return mix(val1, val2, zmix);\n}\n\nvec4 getOneTextureValue(vec3 ijk)\n#else // nearest or fast linear\nvec4 getTextureValue(vec3 ijk)\n#endif\n{\n  vec3 tdims = vec3(volumeDimensions);\n\n#ifdef debugtile\n  vec2 tpos = vec2(ijk.x, ijk.y);\n  vec4 tmp = texture2D(texture1, tpos);\n  tmp.a = 1.0;\n\n#else\n  int z = int(ijk.z * tdims.z);\n  int yz = z / xreps;\n  int xz = z - yz*xreps;\n\n  int tileWidth = volumeDimensions.x/xstride;\n  int tileHeight = volumeDimensions.y/ystride;\n\n  xz *= tileWidth;\n  yz *= tileHeight;\n\n  float ni = float(xz) + (ijk.x*float(tileWidth));\n  float nj = float(yz) + (ijk.y*float(tileHeight));\n\n  vec2 tpos = vec2(ni/texWidth, nj/texHeight);\n\n  vec4 tmp = texture2D(texture1, tpos);\n\n#if vtkNumComponents == 1\n  tmp.a = tmp.r;\n#endif\n#if vtkNumComponents == 2\n  tmp.g = tmp.a;\n#endif\n#if vtkNumComponents == 3\n  tmp.a = length(tmp.rgb);\n#endif\n#endif\n\n  return tmp;\n}\n\n// End of Webgl1 specific code\n//=======================================================================\n#endif\n\n//=======================================================================\n// compute the normal and gradient magnitude for a position\nvec4 computeNormal(vec3 pos, float scalar, vec3 tstep)\n{\n  vec4 result;\n\n  result.x = getTextureValue(pos + vec3(tstep.x, 0.0, 0.0)).a - scalar;\n  result.y = getTextureValue(pos + vec3(0.0, tstep.y, 0.0)).a - scalar;\n  result.z = getTextureValue(pos + vec3(0.0, 0.0, tstep.z)).a - scalar;\n\n  // divide by spacing\n  result.xyz /= vSpacing;\n\n  result.w = length(result.xyz);\n\n  // rotate to View Coords\n  result.xyz =\n    result.x * vPlaneNormal0 +\n    result.y * vPlaneNormal2 +\n    result.z * vPlaneNormal4;\n\n  if (result.w > 0.0)\n  {\n    result.xyz /= result.w;\n  }\n  return result;\n}\n\n#ifdef vtkImageLabelOutlineOn\nvec3 fragCoordToIndexSpace(vec4 fragCoord) {\n  vec4 pcPos = vec4(\n    (fragCoord.x / vpWidth - 0.5) * 2.0,\n    (fragCoord.y / vpHeight - 0.5) * 2.0,\n    (fragCoord.z - 0.5) * 2.0,\n    1.0);\n\n  vec4 worldCoord = PCWCMatrix * pcPos;\n  vec4 vertex = (worldCoord/worldCoord.w);\n\n  return (vWCtoIDX * vertex).xyz / vec3(volumeDimensions);\n}\n#endif\n\n//=======================================================================\n// compute the normals and gradient magnitudes for a position\n// for independent components\nmat4 computeMat4Normal(vec3 pos, vec4 tValue, vec3 tstep)\n{\n  mat4 result;\n  vec4 distX = getTextureValue(pos + vec3(tstep.x, 0.0, 0.0)) - tValue;\n  vec4 distY = getTextureValue(pos + vec3(0.0, tstep.y, 0.0)) - tValue;\n  vec4 distZ = getTextureValue(pos + vec3(0.0, 0.0, tstep.z)) - tValue;\n\n  // divide by spacing\n  distX /= vSpacing.x;\n  distY /= vSpacing.y;\n  distZ /= vSpacing.z;\n\n  mat3 rot;\n  rot[0] = vPlaneNormal0;\n  rot[1] = vPlaneNormal2;\n  rot[2] = vPlaneNormal4;\n\n#if !defined(vtkComponent0Proportional)\n  result[0].xyz = vec3(distX.r, distY.r, distZ.r);\n  result[0].a = length(result[0].xyz);\n  result[0].xyz *= rot;\n  if (result[0].w > 0.0)\n  {\n    result[0].xyz /= result[0].w;\n  }\n#endif\n\n// optionally compute the 2nd component\n#if vtkNumComponents >= 2 && !defined(vtkComponent1Proportional)\n  result[1].xyz = vec3(distX.g, distY.g, distZ.g);\n  result[1].a = length(result[1].xyz);\n  result[1].xyz *= rot;\n  if (result[1].w > 0.0)\n  {\n    result[1].xyz /= result[1].w;\n  }\n#endif\n\n// optionally compute the 3rd component\n#if vtkNumComponents >= 3 && !defined(vtkComponent2Proportional)\n  result[2].xyz = vec3(distX.b, distY.b, distZ.b);\n  result[2].a = length(result[2].xyz);\n  result[2].xyz *= rot;\n  if (result[2].w > 0.0)\n  {\n    result[2].xyz /= result[2].w;\n  }\n#endif\n\n// optionally compute the 4th component\n#if vtkNumComponents >= 4 && !defined(vtkComponent3Proportional)\n  result[3].xyz = vec3(distX.a, distY.a, distZ.a);\n  result[3].a = length(result[3].xyz);\n  result[3].xyz *= rot;\n  if (result[3].w > 0.0)\n  {\n    result[3].xyz /= result[3].w;\n  }\n#endif\n\n  return result;\n}\n\n//=======================================================================\n// Given a normal compute the gradient opacity factors\n//\nfloat computeGradientOpacityFactor(\n  vec4 normal, float goscale, float goshift, float gomin, float gomax)\n{\n#if defined(vtkGradientOpacityOn)\n  return clamp(normal.a*goscale + goshift, gomin, gomax);\n#else\n  return 1.0;\n#endif\n}\n\n#if vtkLightComplexity > 0\nvoid applyLighting(inout vec3 tColor, vec4 normal)\n{\n  vec3 diffuse = vec3(0.0, 0.0, 0.0);\n  vec3 specular = vec3(0.0, 0.0, 0.0);\n  //VTK::Light::Impl\n  tColor.rgb = tColor.rgb*(diffuse*vDiffuse + vAmbient) + specular*vSpecular;\n}\n#endif\n\n//=======================================================================\n// Given a texture value compute the color and opacity\n//\nvec4 getColorForValue(vec4 tValue, vec3 posIS, vec3 tstep)\n{\n#ifdef vtkImageLabelOutlineOn\n  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord); // pos in texture space\n  vec4 centerValue = getTextureValue(centerPosIS);\n  bool pixelOnBorder = false;\n  vec4 tColor = texture2D(ctexture, vec2(centerValue.r * cscale0 + cshift0, 0.5));\n\n  // Get alpha of segment from opacity function.\n  tColor.a = texture2D(otexture, vec2(centerValue.r * oscale0 + oshift0, 0.5)).r;\n\n  // Only perform outline check on fragments rendering voxels that aren't invisible.\n  // Saves a bunch of needless checks on the background.\n  // TODO define epsilon when building shader?\n  if (float(tColor.a) > 0.01) {\n    for (int i = -outlineThickness; i <= outlineThickness; i++) {\n      for (int j = -outlineThickness; j <= outlineThickness; j++) {\n        if (i == 0 || j == 0) {\n          continue;\n        }\n\n        vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),\n          gl_FragCoord.y + float(j),\n          gl_FragCoord.z, gl_FragCoord.w);\n\n        vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);\n        vec4 value = getTextureValue(neighborPosIS);\n\n        // If any of my neighbours are not the same value as I\n        // am, this means I am on the border of the segment.\n        // We can break the loops\n        if (any(notEqual(value, centerValue))) {\n          pixelOnBorder = true;\n          break;\n        }\n      }\n\n      if (pixelOnBorder == true) {\n        break;\n      }\n    }\n\n    // If I am on the border, I am displayed at full opacity\n    if (pixelOnBorder == true) {\n      tColor.a = 1.0;\n    }\n  }\n\n#else\n  // compute the normal and gradient magnitude if needed\n  // We compute it as a vec4 if possible otherwise a mat4\n  //\n  vec4 goFactor = vec4(1.0,1.0,1.0,1.0);\n\n  // compute the normal vectors as needed\n  #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)\n    #if defined(vtkIndependentComponentsOn) && (vtkNumComponents > 1)\n      mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);\n      #if !defined(vtkComponent0Proportional)\n        vec4 normal0 = normalMat[0];\n      #endif\n      #if !defined(vtkComponent1Proportional)\n        vec4 normal1 = normalMat[1];\n      #endif\n      #if vtkNumComponents > 2\n        #if !defined(vtkComponent2Proportional)\n          vec4 normal2 = normalMat[2];\n        #endif\n        #if vtkNumComponents > 3\n          #if !defined(vtkComponent3Proportional)\n            vec4 normal3 = normalMat[3];\n          #endif\n        #endif\n      #endif\n    #else\n      vec4 normal0 = computeNormal(posIS, tValue.a, tstep);\n    #endif\n  #endif\n\n  // compute gradient opacity factors as needed\n  #if defined(vtkGradientOpacityOn)\n    #if !defined(vtkComponent0Proportional)\n      goFactor.x =\n        computeGradientOpacityFactor(normal0, goscale0, goshift0, gomin0, gomax0);\n    #endif\n    #if defined(vtkIndependentComponentsOn) && (vtkNumComponents > 1)\n      #if !defined(vtkComponent1Proportional)\n        goFactor.y =\n          computeGradientOpacityFactor(normal1, goscale1, goshift1, gomin1, gomax1);\n      #endif\n      #if vtkNumComponents > 2\n        #if !defined(vtkComponent2Proportional)\n          goFactor.z =\n            computeGradientOpacityFactor(normal2, goscale2, goshift2, gomin2, gomax2);\n        #endif\n        #if vtkNumComponents > 3\n          #if !defined(vtkComponent3Proportional)\n            goFactor.w =\n              computeGradientOpacityFactor(normal3, goscale3, goshift3, gomin3, gomax3);\n          #endif\n        #endif\n      #endif\n    #endif\n  #endif\n\n  // single component is always independent\n  #if vtkNumComponents == 1\n    vec4 tColor = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, 0.5));\n    tColor.a = goFactor.x*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;\n  #endif\n\n  #if defined(vtkIndependentComponentsOn) && vtkNumComponents >= 2\n    vec4 tColor = mix0*texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, height0));\n    #if !defined(vtkComponent0Proportional)\n      tColor.a = goFactor.x*mix0*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, height0)).r;\n    #else\n      float pwfValue = texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, height0)).r;\n      tColor *= pwfValue;\n      tColor.a *= mix(pwfValue, 1.0, (1.0 - mix0));\n    #endif\n\n    vec3 tColor1 = mix1*texture2D(ctexture, vec2(tValue.g * cscale1 + cshift1, height1)).rgb;\n    #if !defined(vtkComponent1Proportional)\n      tColor.a += goFactor.y*mix1*texture2D(otexture, vec2(tValue.g * oscale1 + oshift1, height1)).r;\n    #else\n      float pwfValue = texture2D(otexture, vec2(tValue.g * oscale1 + oshift1, height1)).r;\n      tColor1 *= pwfValue;\n      tColor.a *= mix(pwfValue, 1.0, (1.0 - mix1));\n    #endif\n\n    #if vtkNumComponents >= 3\n      vec3 tColor2 = mix2*texture2D(ctexture, vec2(tValue.b * cscale2 + cshift2, height2)).rgb;\n      #if !defined(vtkComponent2Proportional)\n        tColor.a += goFactor.z*mix2*texture2D(otexture, vec2(tValue.b * oscale2 + oshift2, height2)).r;\n      #else\n        float pwfValue = texture2D(otexture, vec2(tValue.b * oscale2 + oshift2, height2)).r;\n        tColor2 *= pwfValue;\n        tColor.a *= mix(pwfValue, 1.0, (1.0 - mix2));\n      #endif\n\n      #if vtkNumComponents >= 4\n        vec3 tColor3 = mix3*texture2D(ctexture, vec2(tValue.a * cscale3 + cshift3, height3)).rgb;\n        #if !defined(vtkComponent3Proportional)\n          tColor.a += goFactor.w*mix3*texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, height3)).r;\n        #else\n          float pwfValue = texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, height3)).r;\n          tColor3 *= pwfValue;\n          tColor.a *= mix(pwfValue, 1.0, (1.0 - mix3));\n        #endif\n      #endif\n    #endif\n  #else // then not independent\n\n  #if vtkNumComponents == 2\n    float lum = tValue.r * cscale0 + cshift0;\n    float alpha = goFactor.x*texture2D(otexture, vec2(tValue.a * oscale1 + oshift1, 0.5)).r;\n    vec4 tColor = vec4(lum, lum, lum, alpha);\n  #endif\n  #if vtkNumComponents == 3\n    vec4 tColor;\n    tColor.r = tValue.r * cscale0 + cshift0;\n    tColor.g = tValue.g * cscale1 + cshift1;\n    tColor.b = tValue.b * cscale2 + cshift2;\n    tColor.a = goFactor.x*texture2D(otexture, vec2(tValue.a * oscale0 + oshift0, 0.5)).r;\n  #endif\n  #if vtkNumComponents == 4\n    vec4 tColor;\n    tColor.r = tValue.r * cscale0 + cshift0;\n    tColor.g = tValue.g * cscale1 + cshift1;\n    tColor.b = tValue.b * cscale2 + cshift2;\n    tColor.a = goFactor.x*texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, 0.5)).r;\n  #endif\n  #endif // dependent\n\n  // apply lighting if requested as appropriate\n  #if vtkLightComplexity > 0\n    #if !defined(vtkComponent0Proportional)\n      applyLighting(tColor.rgb, normal0);\n    #endif\n  #if defined(vtkIndependentComponentsOn) && vtkNumComponents >= 2\n    #if !defined(vtkComponent1Proportional)\n      applyLighting(tColor1, normal1);\n    #endif\n  #if vtkNumComponents >= 3\n    #if !defined(vtkComponent2Proportional)\n      applyLighting(tColor2, normal2);\n    #endif\n  #if vtkNumComponents >= 4\n    #if !defined(vtkComponent3Proportional)\n      applyLighting(tColor3, normal3);\n    #endif\n  #endif\n  #endif\n  #endif\n#endif\n\n// perform final independent blend as needed\n#if defined(vtkIndependentComponentsOn) && vtkNumComponents >= 2\n  tColor.rgb += tColor1;\n#if vtkNumComponents >= 3\n  tColor.rgb += tColor2;\n#if vtkNumComponents >= 4\n  tColor.rgb += tColor3;\n#endif\n#endif\n#endif\n\n#endif\n\n\n\n\n\n\n\nreturn tColor;\n}\n\n\n\n//=======================================================================\n// Apply the specified blend mode operation along the ray's path.\n//\nvoid applyBlend(vec3 posIS, vec3 endIS, float sampleDistanceIS, vec3 tdims)\n{\n  vec3 tstep = 1.0/tdims;\n\n  // start slightly inside and apply some jitter\n  vec3 delta = endIS - posIS;\n  vec3 stepIS = normalize(delta)*sampleDistanceIS;\n  float raySteps = length(delta)/sampleDistanceIS;\n\n  // avoid 0.0 jitter\n  float jitter = 0.01 + 0.99*texture2D(jtexture, gl_FragCoord.xy/32.0).r;\n  float stepsTraveled = jitter;\n\n  // local vars for the loop\n  vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 tValue;\n  vec4 tColor;\n\n  // if we have less than one step then pick the middle point\n  // as our value\n  // if (raySteps <= 1.0)\n  // {\n  //   posIS = (posIS + endIS)*0.5;\n  // }\n\n  // Perform initial step at the volume boundary\n  // compute the scalar\n  tValue = getTextureValue(posIS);\n\n  #if vtkBlendMode == 0 // COMPOSITE_BLEND\n    // now map through opacity and color\n    tColor = getColorForValue(tValue, posIS, tstep);\n\n    // handle very thin volumes\n    if (raySteps <= 1.0)\n    {\n      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps);\n      gl_FragData[0] = tColor;\n      return;\n    }\n\n    tColor.a = 1.0 - pow(1.0 - tColor.a, jitter);\n    color = vec4(tColor.rgb*tColor.a, tColor.a);\n    posIS += (jitter*stepIS);\n\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // now map through opacity and color\n      tColor = getColorForValue(tValue, posIS, tstep);\n\n      float mix = (1.0 - color.a);\n\n      // this line should not be needed but nvidia seems to not handle\n      // the break correctly on windows/chrome 58 angle\n      //mix = mix * sign(max(raySteps - stepsTraveled - 1.0, 0.0));\n\n      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;\n      stepsTraveled++;\n      posIS += stepIS;\n      if (color.a > 0.99) { color.a = 1.0; break; }\n    }\n\n    if (color.a < 0.99 && (raySteps - stepsTraveled) > 0.0)\n    {\n      posIS = endIS;\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // now map through opacity and color\n      tColor = getColorForValue(tValue, posIS, tstep);\n      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps - stepsTraveled);\n\n      float mix = (1.0 - color.a);\n      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;\n    }\n\n    gl_FragData[0] = vec4(color.rgb/color.a, color.a);\n  #endif\n  #if vtkBlendMode == 1 || vtkBlendMode == 2\n    // MAXIMUM_INTENSITY_BLEND || MINIMUM_INTENSITY_BLEND\n    // Find maximum/minimum intensity along the ray.\n\n    // Define the operation we will use (min or max)\n    #if vtkBlendMode == 1\n    #define OP max\n    #else\n    #define OP min\n    #endif\n\n    // If the clipping range is shorter than the sample distance\n    // we can skip the sampling loop along the ray.\n    if (raySteps <= 1.0)\n    {\n      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);\n      return;\n    }\n\n    vec4 value = tValue;\n    posIS += (jitter*stepIS);\n\n    // Sample along the ray until MaximumSamplesValue,\n    // ending slightly inside the total distance\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      // If we have reached the last step, break\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // Update the maximum value if necessary\n      value = OP(tValue, value);\n\n      // Otherwise, continue along the ray\n      stepsTraveled++;\n      posIS += stepIS;\n    }\n\n    // Perform the last step along the ray using the\n    // residual distance\n    posIS = endIS;\n    tValue = getTextureValue(posIS);\n    value = OP(tValue, value);\n\n    // Now map through opacity and color\n    gl_FragData[0] = getColorForValue(value, posIS, tstep);\n  #endif\n  #if vtkBlendMode == 3 //AVERAGE_INTENSITY_BLEND\n    vec4 averageIPScalarRangeMin = vec4 (\n      //VTK::AverageIPScalarRangeMin,\n      //VTK::AverageIPScalarRangeMin,\n      //VTK::AverageIPScalarRangeMin,\n      1.0);\n    vec4 averageIPScalarRangeMax = vec4(\n      //VTK::AverageIPScalarRangeMax,\n      //VTK::AverageIPScalarRangeMax,\n      //VTK::AverageIPScalarRangeMax,\n      1.0);\n\n    vec4 sum = vec4(0.);\n\n    averageIPScalarRangeMin.a = tValue.a;\n    averageIPScalarRangeMax.a = tValue.a;\n\n    if (all(greaterThanEqual(tValue, averageIPScalarRangeMin)) &&\n    all(lessThanEqual(tValue, averageIPScalarRangeMax))) {\n      sum += tValue;\n    }\n\n    if (raySteps <= 1.0) {\n      gl_FragData[0] = getColorForValue(sum, posIS, tstep);\n      return;\n    }\n\n    posIS += (jitter*stepIS);\n\n    // Sample along the ray until MaximumSamplesValue,\n    // ending slightly inside the total distance\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      // If we have reached the last step, break\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // One can control the scalar range by setting the AverageIPScalarRange to disregard scalar values, not in the range of interest, from the average computation.\n      // Notes:\n      // - We are comparing all values in the texture to see if any of them\n      //   are outside of the scalar range. In the future we might want to allow\n      //   scalar ranges for each component.\n      // - We are setting the alpha channel for averageIPScalarRangeMin and\n      //   averageIPScalarRangeMax so that we do not trigger this 'continue'\n      //   based on the alpha channel comparison.\n      // - There might be a better way to do this. I'm not sure if there is an\n      //   equivalent of 'any' which only operates on RGB, though I suppose\n      //   we could write an 'anyRGB' function and see if that is faster.\n      averageIPScalarRangeMin.a = tValue.a;\n      averageIPScalarRangeMax.a = tValue.a;\n      if (any(lessThan(tValue, averageIPScalarRangeMin)) ||\n          any(greaterThan(tValue, averageIPScalarRangeMax))) {\n        continue;\n      }\n\n      // Sum the values across each step in the path\n      sum += tValue;\n\n      // Otherwise, continue along the ray\n      stepsTraveled++;\n      posIS += stepIS;\n    }\n\n    // Perform the last step along the ray using the\n    // residual distance\n    posIS = endIS;\n\n    // compute the scalar\n    tValue = getTextureValue(posIS);\n\n    // One can control the scalar range by setting the AverageIPScalarRange to disregard scalar values, not in the range of interest, from the average computation\n    if (all(greaterThanEqual(tValue, averageIPScalarRangeMin)) &&\n        all(lessThanEqual(tValue, averageIPScalarRangeMax))) {\n      sum += tValue;\n\n      stepsTraveled++;\n    }\n\n    sum /= vec4(stepsTraveled, stepsTraveled, stepsTraveled, 1.0);\n\n    gl_FragData[0] = getColorForValue(sum, posIS, tstep);\n  #endif\n}\n\n//=======================================================================\n// Compute a new start and end point for a given ray based\n// on the provided bounded clipping plane (aka a rectangle)\nvoid getRayPointIntersectionBounds(\n  vec3 rayPos, vec3 rayDir,\n  vec3 planeDir, float planeDist,\n  inout vec2 tbounds, vec3 vPlaneX, vec3 vPlaneY,\n  float vSize1, float vSize2)\n{\n  float result = dot(rayDir, planeDir);\n  if (result == 0.0)\n  {\n    return;\n  }\n  result = -1.0 * (dot(rayPos, planeDir) + planeDist) / result;\n  vec3 xposVC = rayPos + rayDir*result;\n  vec3 vxpos = xposVC - vOriginVC;\n  vec2 vpos = vec2(\n    dot(vxpos, vPlaneX),\n    dot(vxpos, vPlaneY));\n\n  // on some apple nvidia systems this does not work\n  // if (vpos.x < 0.0 || vpos.x > vSize1 ||\n  //     vpos.y < 0.0 || vpos.y > vSize2)\n  // even just\n  // if (vpos.x < 0.0 || vpos.y < 0.0)\n  // fails\n  // so instead we compute a value that represents in and out\n  //and then compute the return using this value\n  float xcheck = max(0.0, vpos.x * (vpos.x - vSize1)); //  0 means in bounds\n  float check = sign(max(xcheck, vpos.y * (vpos.y - vSize2))); //  0 means in bounds, 1 = out\n\n  tbounds = mix(\n   vec2(min(tbounds.x, result), max(tbounds.y, result)), // in value\n   tbounds, // out value\n   check);  // 0 in 1 out\n}\n\n//=======================================================================\n// given a\n// - ray direction (rayDir)\n// - starting point (vertexVCVSOutput)\n// - bounding planes of the volume\n// - optionally depth buffer values\n// - far clipping plane\n// compute the start/end distances of the ray we need to cast\nvec2 computeRayDistances(vec3 rayDir, vec3 tdims)\n{\n  vec2 dists = vec2(100.0*camFar, -1.0);\n\n  vec3 vSize = vSpacing*(tdims - 1.0);\n\n  // all this is in View Coordinates\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal0, vPlaneDistance0, dists, vPlaneNormal2, vPlaneNormal4,\n    vSize.y, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal1, vPlaneDistance1, dists, vPlaneNormal2, vPlaneNormal4,\n    vSize.y, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal2, vPlaneDistance2, dists, vPlaneNormal0, vPlaneNormal4,\n    vSize.x, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal3, vPlaneDistance3, dists, vPlaneNormal0, vPlaneNormal4,\n    vSize.x, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal4, vPlaneDistance4, dists, vPlaneNormal0, vPlaneNormal2,\n    vSize.x, vSize.y);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal5, vPlaneDistance5, dists, vPlaneNormal0, vPlaneNormal2,\n    vSize.x, vSize.y);\n\n  // do not go behind front clipping plane\n  dists.x = max(0.0,dists.x);\n\n  // do not go PAST far clipping plane\n  float farDist = -camThick/rayDir.z;\n  dists.y = min(farDist,dists.y);\n\n  // Do not go past the zbuffer value if set\n  // This is used for intermixing opaque geometry\n  //VTK::ZBuffer::Impl\n\n  return dists;\n}\n\n//=======================================================================\n// Compute the index space starting position (pos) and end\n// position\n//\nvoid computeIndexSpaceValues(out vec3 pos, out vec3 endPos, out float sampleDistanceIS, vec3 rayDir, vec2 dists)\n{\n  // compute starting and ending values in volume space\n  pos = vertexVCVSOutput + dists.x*rayDir;\n  pos = pos - vOriginVC;\n  // convert to volume basis and origin\n  pos = vec3(\n    dot(pos, vPlaneNormal0),\n    dot(pos, vPlaneNormal2),\n    dot(pos, vPlaneNormal4));\n\n  endPos = vertexVCVSOutput + dists.y*rayDir;\n  endPos = endPos - vOriginVC;\n  endPos = vec3(\n    dot(endPos, vPlaneNormal0),\n    dot(endPos, vPlaneNormal2),\n    dot(endPos, vPlaneNormal4));\n\n  float delta = length(endPos - pos);\n\n  pos *= vVCToIJK;\n  endPos *= vVCToIJK;\n\n  float delta2 = length(endPos - pos);\n  sampleDistanceIS = sampleDistance*delta2/delta;\n}\n\nvoid main()\n{\n\n  vec3 rayDirVC;\n\n  if (cameraParallel == 1)\n  {\n    // Camera is parallel, so the rayDir is just the direction of the camera.\n    rayDirVC = vec3(0.0, 0.0, -1.0);\n  } else {\n    // camera is at 0,0,0 so rayDir for perspective is just the vc coord\n    rayDirVC = normalize(vertexVCVSOutput);\n  }\n\n  vec3 tdims = vec3(volumeDimensions);\n\n  // compute the start and end points for the ray\n  vec2 rayStartEndDistancesVC = computeRayDistances(rayDirVC, tdims);\n\n  // do we need to composite? aka does the ray have any length\n  // If not, bail out early\n  if (rayStartEndDistancesVC.y <= rayStartEndDistancesVC.x)\n  {\n    discard;\n  }\n\n  // IS = Index Space\n  vec3 posIS;\n  vec3 endIS;\n  float sampleDistanceIS;\n  computeIndexSpaceValues(posIS, endIS, sampleDistanceIS, rayDirVC, rayStartEndDistancesVC);\n\n  // Perform the blending operation along the ray\n  applyBlend(posIS, endIS, sampleDistanceIS, tdims);\n}\n"},function(e,t,n){var r;!function(o){"use strict";function a(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,r,o,i){return a((s=a(a(t,e),a(r,i)))<<(l=o)|s>>>32-l,n);var s,l}function s(e,t,n,r,o,a,s){return i(t&n|~t&r,e,t,o,a,s)}function l(e,t,n,r,o,a,s){return i(t&r|n&~r,e,t,o,a,s)}function c(e,t,n,r,o,a,s){return i(t^n^r,e,t,o,a,s)}function u(e,t,n,r,o,a,s){return i(n^(t|~r),e,t,o,a,s)}function d(e,t){var n,r,o,i,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var f=1732584193,p=-271733879,m=-1732584194,g=271733878;for(n=0;n<e.length;n+=16)r=f,o=p,i=m,d=g,f=s(f,p,m,g,e[n],7,-680876936),g=s(g,f,p,m,e[n+1],12,-389564586),m=s(m,g,f,p,e[n+2],17,606105819),p=s(p,m,g,f,e[n+3],22,-1044525330),f=s(f,p,m,g,e[n+4],7,-176418897),g=s(g,f,p,m,e[n+5],12,1200080426),m=s(m,g,f,p,e[n+6],17,-1473231341),p=s(p,m,g,f,e[n+7],22,-45705983),f=s(f,p,m,g,e[n+8],7,1770035416),g=s(g,f,p,m,e[n+9],12,-1958414417),m=s(m,g,f,p,e[n+10],17,-42063),p=s(p,m,g,f,e[n+11],22,-1990404162),f=s(f,p,m,g,e[n+12],7,1804603682),g=s(g,f,p,m,e[n+13],12,-40341101),m=s(m,g,f,p,e[n+14],17,-1502002290),f=l(f,p=s(p,m,g,f,e[n+15],22,1236535329),m,g,e[n+1],5,-165796510),g=l(g,f,p,m,e[n+6],9,-1069501632),m=l(m,g,f,p,e[n+11],14,643717713),p=l(p,m,g,f,e[n],20,-373897302),f=l(f,p,m,g,e[n+5],5,-701558691),g=l(g,f,p,m,e[n+10],9,38016083),m=l(m,g,f,p,e[n+15],14,-660478335),p=l(p,m,g,f,e[n+4],20,-405537848),f=l(f,p,m,g,e[n+9],5,568446438),g=l(g,f,p,m,e[n+14],9,-1019803690),m=l(m,g,f,p,e[n+3],14,-187363961),p=l(p,m,g,f,e[n+8],20,1163531501),f=l(f,p,m,g,e[n+13],5,-1444681467),g=l(g,f,p,m,e[n+2],9,-51403784),m=l(m,g,f,p,e[n+7],14,1735328473),f=c(f,p=l(p,m,g,f,e[n+12],20,-1926607734),m,g,e[n+5],4,-378558),g=c(g,f,p,m,e[n+8],11,-2022574463),m=c(m,g,f,p,e[n+11],16,1839030562),p=c(p,m,g,f,e[n+14],23,-35309556),f=c(f,p,m,g,e[n+1],4,-1530992060),g=c(g,f,p,m,e[n+4],11,1272893353),m=c(m,g,f,p,e[n+7],16,-155497632),p=c(p,m,g,f,e[n+10],23,-1094730640),f=c(f,p,m,g,e[n+13],4,681279174),g=c(g,f,p,m,e[n],11,-358537222),m=c(m,g,f,p,e[n+3],16,-722521979),p=c(p,m,g,f,e[n+6],23,76029189),f=c(f,p,m,g,e[n+9],4,-640364487),g=c(g,f,p,m,e[n+12],11,-421815835),m=c(m,g,f,p,e[n+15],16,530742520),f=u(f,p=c(p,m,g,f,e[n+2],23,-995338651),m,g,e[n],6,-198630844),g=u(g,f,p,m,e[n+7],10,1126891415),m=u(m,g,f,p,e[n+14],15,-1416354905),p=u(p,m,g,f,e[n+5],21,-57434055),f=u(f,p,m,g,e[n+12],6,1700485571),g=u(g,f,p,m,e[n+3],10,-1894986606),m=u(m,g,f,p,e[n+10],15,-1051523),p=u(p,m,g,f,e[n+1],21,-2054922799),f=u(f,p,m,g,e[n+8],6,1873313359),g=u(g,f,p,m,e[n+15],10,-30611744),m=u(m,g,f,p,e[n+6],15,-1560198380),p=u(p,m,g,f,e[n+13],21,1309151649),f=u(f,p,m,g,e[n+4],6,-145523070),g=u(g,f,p,m,e[n+11],10,-1120210379),m=u(m,g,f,p,e[n+2],15,718787259),p=u(p,m,g,f,e[n+9],21,-343485551),f=a(f,r),p=a(p,o),m=a(m,i),g=a(g,d);return[f,p,m,g]}function f(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function p(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function m(e){var t,n,r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return r}function g(e){return unescape(encodeURIComponent(e))}function h(e){return function(e){return f(d(p(e),8*e.length))}(g(e))}function A(e,t){return function(e,t){var n,r,o=p(e),a=[],i=[];for(a[15]=i[15]=void 0,o.length>16&&(o=d(o,8*e.length)),n=0;n<16;n+=1)a[n]=909522486^o[n],i[n]=1549556828^o[n];return r=d(a.concat(p(t)),512+8*t.length),f(d(i.concat(r),640))}(g(e),g(t))}function v(e,t,n){return t?n?A(t,e):m(A(t,e)):n?h(e):m(h(e))}void 0===(r=function(){return v}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){(function(t){
/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
/**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var n;n=function(){"use strict";var e,n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},r=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},o=function(e,t){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]},a=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},i=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){
/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
/**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
e.exports=function(){var e,t,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(e,t,n){return e+(t-e)*n},s=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}(),l=function(){var e=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return e}}(),c=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return e}}(),u=function(){var e=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return e}}(),d=(t=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),r=t?parseInt(t[1],10):null,function(){return r}),f=function(){var e;return e=s()&&c()&&-1!==navigator.userAgent.indexOf("13_4"),function(){return e}}(),p=function(){var e=!1;if(65===d()){var t=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(t){var n=t[1].split("."),r=a(n,4),o=(r[0],r[1],r[2]),i=r[3];e=3325===parseInt(o,10)&&parseInt(i,10)<148}}return function(){return e}}(),m=function(){var e=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return e}}(),g=function(){var e=90==window.orientation||-90==window.orientation;return m()?!e:e},h=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},A=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},v=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},y=function(e,t,n,r){var o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,t),e.compileShader(o);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,n),e.compileShader(a);var i=e.createProgram();for(var s in e.attachShader(i,o),e.attachShader(i,a),r)e.bindAttribLocation(i,r[s],s);return e.linkProgram(i),e.deleteShader(o),e.deleteShader(a),i},b=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o="",a=0;a<r;a++)n[o=e.getActiveUniform(t,a).name.replace("[0]","")]=e.getUniformLocation(t,o);return n},T=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},x=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},C=function(e){if(s()){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(n)+"px",setTimeout((function(){e.style.width=t,e.style.height=n}),100)}window.canvas=e},E=function(){var e=Math.PI/180,t=.25*Math.PI,n=new Float32Array([0,0,0,1]),r=new Float32Array([0,0,0]);function o(o,a,i,s,l,c){!function(n,r,o,a){var i=Math.tan(r?r.upDegrees*e:t),s=Math.tan(r?r.downDegrees*e:t),l=Math.tan(r?r.leftDegrees*e:t),c=Math.tan(r?r.rightDegrees*e:t),u=2/(l+c),d=2/(i+s);n[0]=u,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=d,n[6]=0,n[7]=0,n[8]=-(l-c)*u*.5,n[9]=(i-s)*d*.5,n[10]=a/(o-a),n[11]=-1,n[12]=0,n[13]=0,n[14]=a*o/(o-a),n[15]=0}(o,s||null,c.depthNear,c.depthFar);var u,d,f,p,m,g,h,A,v,y,b,T,x,C,E,M,S,w,R,P=i.orientation||n,O=i.position||r;u=a,f=O,p=(d=P)[0],m=d[1],g=d[2],h=d[3],b=p*(A=p+p),T=p*(v=m+m),x=p*(y=g+g),C=m*v,E=m*y,M=g*y,S=h*A,w=h*v,R=h*y,u[0]=1-(C+M),u[1]=T+R,u[2]=x-w,u[3]=0,u[4]=T-R,u[5]=1-(b+M),u[6]=E+S,u[7]=0,u[8]=x+w,u[9]=E-S,u[10]=1-(b+C),u[11]=0,u[12]=f[0],u[13]=f[1],u[14]=f[2],u[15]=1,l&&function(e,t,n){var r,o,a,i,s,l,c,u,d,f,p,m,g=n[0],h=n[1],A=n[2];t===e?(e[12]=t[0]*g+t[4]*h+t[8]*A+t[12],e[13]=t[1]*g+t[5]*h+t[9]*A+t[13],e[14]=t[2]*g+t[6]*h+t[10]*A+t[14],e[15]=t[3]*g+t[7]*h+t[11]*A+t[15]):(r=t[0],o=t[1],a=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=t[9],p=t[10],m=t[11],e[0]=r,e[1]=o,e[2]=a,e[3]=i,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=f,e[10]=p,e[11]=m,e[12]=r*g+s*h+d*A+t[12],e[13]=o*g+l*h+f*A+t[13],e[14]=a*g+c*h+p*A+t[14],e[15]=i*g+u*h+m*A+t[15])}(a,a,l),function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],h=t[14],A=t[15],v=n*s-r*i,y=n*l-o*i,b=n*c-a*i,T=r*l-o*s,x=r*c-a*s,C=o*c-a*l,E=u*g-d*m,M=u*h-f*m,S=u*A-p*m,w=d*h-f*g,R=d*A-p*g,P=f*A-p*h,O=v*P-y*R+b*w+T*S-x*M+C*E;O&&(O=1/O,e[0]=(s*P-l*R+c*w)*O,e[1]=(o*R-r*P-a*w)*O,e[2]=(g*C-h*x+A*T)*O,e[3]=(f*x-d*C-p*T)*O,e[4]=(l*S-i*P-c*M)*O,e[5]=(n*P-o*S+a*M)*O,e[6]=(h*b-m*C-A*y)*O,e[7]=(u*C-f*b+p*y)*O,e[8]=(i*R-s*S+c*E)*O,e[9]=(r*S-n*R-a*E)*O,e[10]=(m*x-g*b+A*v)*O,e[11]=(d*b-u*x-p*v)*O,e[12]=(s*M-i*w-l*E)*O,e[13]=(n*w-r*M+o*E)*O,e[14]=(g*y-m*T-h*v)*O,e[15]=(u*T-d*y+f*v)*O)}(a,a)}return function(e,t,n){return!(!e||!t||(e.pose=t,e.timestamp=t.timestamp,o(e.leftProjectionMatrix,e.leftViewMatrix,t,n._getFieldOfView("left"),n._getEyeOffset("left"),n),o(e.rightProjectionMatrix,e.rightViewMatrix,t,n._getFieldOfView("right"),n._getEyeOffset("right"),n),0))}}(),M=function(e){var t,n=e.indexOf("://");t=-1!==n?n+3:0;var r=e.indexOf("/",t);return-1===r&&(r=e.length),e.substring(0,r)},S=(e={},function(t,n){void 0===e[t]&&(console.warn("webvr-polyfill: "+n),e[t]=!0)}),w=function(e,t){S(e,e+" has been deprecated. This may not work on native WebVR displays. "+(t?"Please use "+t+" instead.":""))},R=function(e,t,n){if(t){for(var r=[],o=null,a=0;a<t.length;++a)switch(i=t[a]){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:if((l=t[++a])<e.TEXTURE0||l>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),r.push(null,null);break}o||(o=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(l),r.push(e.getParameter(i),null);break;case e.ACTIVE_TEXTURE:o=e.getParameter(e.ACTIVE_TEXTURE),r.push(null);break;default:r.push(e.getParameter(i))}for(n(e),a=0;a<t.length;++a){var i=t[a],s=r[a];switch(i){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,s);break;case e.COLOR_CLEAR_VALUE:e.clearColor(s[0],s[1],s[2],s[3]);break;case e.COLOR_WRITEMASK:e.colorMask(s[0],s[1],s[2],s[3]);break;case e.CURRENT_PROGRAM:e.useProgram(s);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,s);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,s);break;case e.TEXTURE_BINDING_2D:if((l=t[++a])<e.TEXTURE0||l>e.TEXTURE31)break;e.activeTexture(l),e.bindTexture(e.TEXTURE_2D,s);break;case e.TEXTURE_BINDING_CUBE_MAP:var l;if((l=t[++a])<e.TEXTURE0||l>e.TEXTURE31)break;e.activeTexture(l),e.bindTexture(e.TEXTURE_CUBE_MAP,s);break;case e.VIEWPORT:e.viewport(s[0],s[1],s[2],s[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:s?e.enable(i):e.disable(i);break;default:console.log("No GL restore behavior for 0x"+i.toString(16))}o&&e.activeTexture(o)}}else n(e)},P=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),O=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function I(e,t,n,r){this.gl=e,this.cardboardUI=t,this.bufferScale=n,this.dirtySubmitFrameBindings=r,this.ctxAttribs=e.getContextAttributes(),this.instanceExt=e.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,s()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=y(e,P,O,this.attribs),this.uniforms=b(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize()}I.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},I.prototype.onResize=function(){var e=this.gl,t=this,n=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];R(e,n,(function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0),t.ctxAttribs.depth&&t.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)):t.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)):t.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),t.realClearColor.apply(e,t.clearColor)})),this.cardboardUI&&this.cardboardUI.onResize()},I.prototype.patch=function(){if(!this.isPatched){var e=this,t=this.gl.canvas,n=this.gl;s()||(t.width=h()*this.bufferScale,t.height=A()*this.bufferScale,Object.defineProperty(t,"width",{configurable:!0,enumerable:!0,get:function(){return e.bufferWidth},set:function(n){e.bufferWidth=n,e.realCanvasWidth.set.call(t,n),e.onResize()}}),Object.defineProperty(t,"height",{configurable:!0,enumerable:!0,get:function(){return e.bufferHeight},set:function(n){e.bufferHeight=n,e.realCanvasHeight.set.call(t,n),e.onResize()}})),this.lastBoundFramebuffer=n.getParameter(n.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(t,r){e.lastBoundFramebuffer=r||e.framebuffer,e.realBindFramebuffer.call(n,t,e.lastBoundFramebuffer)},this.cullFace=n.getParameter(n.CULL_FACE),this.depthTest=n.getParameter(n.DEPTH_TEST),this.blend=n.getParameter(n.BLEND),this.scissorTest=n.getParameter(n.SCISSOR_TEST),this.stencilTest=n.getParameter(n.STENCIL_TEST),n.enable=function(t){switch(t){case n.CULL_FACE:e.cullFace=!0;break;case n.DEPTH_TEST:e.depthTest=!0;break;case n.BLEND:e.blend=!0;break;case n.SCISSOR_TEST:e.scissorTest=!0;break;case n.STENCIL_TEST:e.stencilTest=!0}e.realEnable.call(n,t)},n.disable=function(t){switch(t){case n.CULL_FACE:e.cullFace=!1;break;case n.DEPTH_TEST:e.depthTest=!1;break;case n.BLEND:e.blend=!1;break;case n.SCISSOR_TEST:e.scissorTest=!1;break;case n.STENCIL_TEST:e.stencilTest=!1}e.realDisable.call(n,t)},this.colorMask=n.getParameter(n.COLOR_WRITEMASK),n.colorMask=function(t,r,o,a){e.colorMask[0]=t,e.colorMask[1]=r,e.colorMask[2]=o,e.colorMask[3]=a,e.realColorMask.call(n,t,r,o,a)},this.clearColor=n.getParameter(n.COLOR_CLEAR_VALUE),n.clearColor=function(t,r,o,a){e.clearColor[0]=t,e.clearColor[1]=r,e.clearColor[2]=o,e.clearColor[3]=a,e.realClearColor.call(n,t,r,o,a)},this.viewport=n.getParameter(n.VIEWPORT),n.viewport=function(t,r,o,a){e.viewport[0]=t,e.viewport[1]=r,e.viewport[2]=o,e.viewport[3]=a,e.realViewport.call(n,t,r,o,a)},this.isPatched=!0,C(t)}},I.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,t=this.gl.canvas;s()||(Object.defineProperty(t,"width",this.realCanvasWidth),Object.defineProperty(t,"height",this.realCanvasHeight)),t.width=this.bufferWidth,t.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout((function(){C(t)}),1)}},I.prototype.setTextureBounds=function(e,t){e||(e=[0,0,.5,1]),t||(t=[.5,0,.5,1]),this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=t[0],this.viewportOffsetScale[5]=t[1],this.viewportOffsetScale[6]=t[2],this.viewportOffsetScale[7]=t[3]},I.prototype.submitFrame=function(){var e=this.gl,t=this,n=[];if(this.dirtySubmitFrameBindings||n.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),R(e,n,(function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null);var n=0,r=0;t.instanceExt&&(n=e.getVertexAttrib(t.attribs.position,t.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),r=e.getVertexAttrib(t.attribs.texCoord,t.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),t.cullFace&&t.realDisable.call(e,e.CULL_FACE),t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST),t.blend&&t.realDisable.call(e,e.BLEND),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(t.ctxAttribs.alpha||s())&&(t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(t.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(t.attribs.position),e.enableVertexAttribArray(t.attribs.texCoord),e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,!1,20,8),t.instanceExt&&(0!=n&&t.instanceExt.vertexAttribDivisorANGLE(t.attribs.position,0),0!=r&&t.instanceExt.vertexAttribDivisorANGLE(t.attribs.texCoord,0)),e.activeTexture(e.TEXTURE0),e.uniform1i(t.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale),e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0),t.cardboardUI&&t.cardboardUI.renderNoState(),t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer),t.ctxAttribs.preserveDrawingBuffer||(t.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),t.dirtySubmitFrameBindings||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.cullFace&&t.realEnable.call(e,e.CULL_FACE),t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST),t.blend&&t.realEnable.call(e,e.BLEND),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor),t.instanceExt&&(0!=n&&t.instanceExt.vertexAttribDivisorANGLE(t.attribs.position,n),0!=r&&t.instanceExt.vertexAttribDivisorANGLE(t.attribs.texCoord,r))})),s()){var r=e.canvas;r.width==t.bufferWidth&&r.height==t.bufferHeight||(t.bufferWidth=r.width,t.bufferHeight=r.height,t.onResize())}},I.prototype.updateDeviceInfo=function(e){var t=this.gl,n=this,r=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING];R(t,r,(function(t){var r=n.computeMeshVertices_(n.meshWidth,n.meshHeight,e);if(t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),!n.indexCount){var o=n.computeMeshIndices_(n.meshWidth,n.meshHeight);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,o,t.STATIC_DRAW),n.indexCount=o.length}}))},I.prototype.computeMeshVertices_=function(e,t,n){for(var r=new Float32Array(2*e*t*5),o=n.getLeftEyeVisibleTanAngles(),a=n.getLeftEyeNoLensTanAngles(),s=n.getLeftEyeVisibleScreenRect(a),l=0,c=0;c<2;c++){for(var u=0;u<t;u++)for(var d=0;d<e;d++,l++){var f=d/(e-1),p=u/(t-1),m=f,g=p,h=i(o[0],o[2],f),A=i(o[3],o[1],p),v=Math.sqrt(h*h+A*A),y=n.distortion.distortInverse(v),b=A*y/v;f=(h*y/v-a[0])/(a[2]-a[0]),p=(b-a[3])/(a[1]-a[3]),f=2*(s.x+f*s.width-.5),p=2*(s.y+p*s.height-.5),r[5*l+0]=f,r[5*l+1]=p,r[5*l+2]=m,r[5*l+3]=g,r[5*l+4]=c}var T=o[2]-o[0];o[0]=-(T+o[0]),o[2]=T-o[2],T=a[2]-a[0],a[0]=-(T+a[0]),a[2]=T-a[2],s.x=1-(s.x+s.width)}return r},I.prototype.computeMeshIndices_=function(e,t){for(var n=new Uint16Array(2*(e-1)*(t-1)*6),r=e/2,o=t/2,a=0,i=0,s=0;s<2;s++)for(var l=0;l<t;l++)for(var c=0;c<e;c++,a++)0!=c&&0!=l&&(c<=r==l<=o?(n[i++]=a,n[i++]=a-e-1,n[i++]=a-e,n[i++]=a-e-1,n[i++]=a,n[i++]=a-1):(n[i++]=a-1,n[i++]=a-e,n[i++]=a,n[i++]=a-e,n[i++]=a-1,n[i++]=a-e-1));return n},I.prototype.getOwnPropertyDescriptor_=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return void 0!==n.get&&void 0!==n.set||(n.configurable=!0,n.enumerable=!0,n.get=function(){return this.getAttribute(t)},n.set=function(e){this.setAttribute(t,e)}),n};var D=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),V=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),L=Math.PI/180;function _(e){this.gl=e,this.attribs={position:0},this.program=y(e,D,V,this.attribs),this.uniforms=b(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}function F(e){this.coefficients=e}_.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},_.prototype.listen=function(e,t){var n=this.gl.canvas;this.listener=function(r){var o=n.clientWidth/2;r.clientX>o-42&&r.clientX<o+42&&r.clientY>n.clientHeight-42?e(r):r.clientX<42&&r.clientY<42&&t(r)},n.addEventListener("click",this.listener,!1)},_.prototype.onResize=function(){var e=this.gl,t=this,n=[e.ARRAY_BUFFER_BINDING];R(e,n,(function(e){var n=[],r=e.drawingBufferWidth/2,o=Math.max(screen.width,screen.height)*window.devicePixelRatio,a=e.drawingBufferWidth/o*window.devicePixelRatio,i=4*a/2,s=42*a,l=28*a/2,c=14*a;function u(e,t){var o=(90-e)*L,a=Math.cos(o),i=Math.sin(o);n.push(.3125*a*l+r,.3125*i*l+l),n.push(t*a*l+r,t*i*l+l)}n.push(r-i,s),n.push(r-i,e.drawingBufferHeight),n.push(r+i,s),n.push(r+i,e.drawingBufferHeight),t.gearOffset=n.length/2;for(var d=0;d<=6;d++){var f=60*d;u(f,1),u(f+12,1),u(f+20,.75),u(f+40,.75),u(f+48,1)}function p(t,r){n.push(c+t,e.drawingBufferHeight-c-r)}t.gearVertexCount=n.length/2-t.gearOffset,t.arrowOffset=n.length/2;var m=i/Math.sin(45*L);p(0,l),p(l,0),p(l+m,m),p(m,l+m),p(m,l-m),p(0,l),p(l,2*l),p(l+m,2*l-m),p(m,l-m),p(0,l),p(m,l-i),p(28*a,l-i),p(m,l+i),p(28*a,l+i),t.arrowVertexCount=n.length/2-t.arrowOffset,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW)}))},_.prototype.render=function(){var e=this.gl,t=this,n=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];R(e,n,(function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.renderNoState()}))},_.prototype.renderNoState=function(){var e,t,n,r,o,a,i,s,l,c,u=this.gl;u.useProgram(this.program),u.bindBuffer(u.ARRAY_BUFFER,this.vertexBuffer),u.enableVertexAttribArray(this.attribs.position),u.vertexAttribPointer(this.attribs.position,2,u.FLOAT,!1,8,0),u.uniform4f(this.uniforms.color,1,1,1,1),e=this.projMat,t=0,n=u.drawingBufferWidth,r=0,o=u.drawingBufferHeight,s=1/(t-n),l=1/(r-o),c=1/((a=.1)-(i=1024)),e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(o+r)*l,e[14]=(i+a)*c,e[15]=1,u.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),u.drawArrays(u.TRIANGLE_STRIP,0,4),u.drawArrays(u.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),u.drawArrays(u.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},F.prototype.distortInverse=function(e){for(var t=0,n=1,r=e-this.distort(t);Math.abs(n-t)>1e-4;){var o=e-this.distort(n),a=n-o*((n-t)/(o-r));t=n,n=a,r=o}return n},F.prototype.distort=function(e){for(var t=e*e,n=0,r=0;r<this.coefficients.length;r++)n=t*(n+this.coefficients[r]);return(n+1)*e};var N=Math.PI/180,B=180/Math.PI,k=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};k.prototype={constructor:k,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,o=e.x,a=e.y,i=e.z,s=e.w,l=s*t+a*r-i*n,c=s*n+i*t-o*r,u=s*r+o*n-a*t,d=-o*t-a*n-i*r;return this.x=l*s+d*-o+c*-i-u*-a,this.y=c*s+d*-a+u*-o-l*-i,this.z=u*s+d*-i+l*-a-c*-o,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var n=e.x,r=e.y,o=e.z,a=t.x,i=t.y,s=t.z;return this.x=r*s-o*i,this.y=o*a-n*s,this.z=n*i-r*a,this}};var G,U,W=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1};function z(e){this.width=e.width||h(),this.height=e.height||A(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}W.prototype={constructor:W,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,n){var r=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(n/2),i=Math.sin(e/2),s=Math.sin(t/2),l=Math.sin(n/2);return this.x=i*o*a+r*s*l,this.y=r*s*a-i*o*l,this.z=r*o*l+i*s*a,this.w=r*o*a-i*s*l,this},setFromEulerYXZ:function(e,t,n){var r=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(n/2),i=Math.sin(e/2),s=Math.sin(t/2),l=Math.sin(n/2);return this.x=i*o*a+r*s*l,this.y=r*s*a-i*o*l,this.z=r*o*l-i*s*a,this.w=r*o*a+i*s*l,this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(n),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,r=e.y,o=e.z,a=e.w,i=t.x,s=t.y,l=t.z,c=t.w;return this.x=n*c+a*i+r*l-o*s,this.y=r*c+a*s+o*i-n*l,this.z=o*c+a*l+n*s-r*i,this.w=a*c-n*i-r*s-o*l,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this.x,r=this.y,o=this.z,a=this.w,i=a*e.w+n*e.x+r*e.y+o*e.z;if(i<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,i=-i):this.copy(e),i>=1)return this.w=a,this.x=n,this.y=r,this.z=o,this;var s=Math.acos(i),l=Math.sqrt(1-i*i);if(Math.abs(l)<.001)return this.w=.5*(a+this.w),this.x=.5*(n+this.x),this.y=.5*(r+this.y),this.z=.5*(o+this.z),this;var c=Math.sin((1-t)*s)/l,u=Math.sin(t*s)/l;return this.w=a*c+this.w*u,this.x=n*c+this.x*u,this.y=r*c+this.y*u,this.z=o*c+this.z*u,this},setFromUnitVectors:function(e,t){return void 0===G&&(G=new k),(U=e.dot(t)+1)<1e-6?(U=0,Math.abs(e.x)>Math.abs(e.z)?G.set(-e.y,e.x,0):G.set(0,-e.z,e.y)):G.crossVectors(e,t),this.x=G.x,this.y=G.y,this.z=G.z,this.w=U,this.normalize(),this}};var H=new z({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),j=new z({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),K={CardboardV1:new Q({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Q({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function X(e,t){this.viewer=K.CardboardV2,this.updateDeviceParams(e),this.distortion=new F(this.viewer.distortionCoefficients);for(var n=0;n<t.length;n++){var r=t[n];K[r.id]=new Q(r)}}function Q(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}X.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},X.prototype.getDevice=function(){return this.device},X.prototype.setViewer=function(e){this.viewer=e,this.distortion=new F(this.viewer.distortionCoefficients)},X.prototype.determineDevice_=function(e){if(!e)return s()?(console.warn("Using fallback iOS device measurements."),j):(console.warn("Using fallback Android device measurements."),H);var t=.0254/e.xdpi,n=.0254/e.ydpi;return new z({widthMeters:t*h(),heightMeters:n*A(),bevelMeters:.001*e.bevelMm})},X.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,n=this.distortion,r=e.screenLensDistance,o=(t.widthMeters-e.interLensDistance)/2,a=e.interLensDistance/2,i=e.baselineLensDistance-t.bevelMeters,s=t.heightMeters-i,l=B*Math.atan(n.distort(o/r)),c=B*Math.atan(n.distort(a/r)),u=B*Math.atan(n.distort(i/r)),d=B*Math.atan(n.distort(s/r));return{leftDegrees:Math.min(l,e.fov),rightDegrees:Math.min(c,e.fov),downDegrees:Math.min(u,e.fov),upDegrees:Math.min(d,e.fov)}},X.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,r=Math.tan(-N*e.fov),o=Math.tan(N*e.fov),a=Math.tan(N*e.fov),i=Math.tan(-N*e.fov),s=t.widthMeters/4,l=t.heightMeters/2,c=e.baselineLensDistance-t.bevelMeters-l,u=e.interLensDistance/2-s,d=-c,f=e.screenLensDistance,p=n.distort((u-s)/f),m=n.distort((d+l)/f),g=n.distort((u+s)/f),h=n.distort((d-l)/f),A=new Float32Array(4);return A[0]=Math.max(r,p),A[1]=Math.min(o,m),A[2]=Math.min(a,g),A[3]=Math.max(i,h),A},X.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,r=new Float32Array(4),o=n.distortInverse(Math.tan(-N*e.fov)),a=n.distortInverse(Math.tan(N*e.fov)),i=n.distortInverse(Math.tan(N*e.fov)),s=n.distortInverse(Math.tan(-N*e.fov)),l=t.widthMeters/4,c=t.heightMeters/2,u=e.baselineLensDistance-t.bevelMeters-c,d=e.interLensDistance/2-l,f=-u,p=e.screenLensDistance,m=(d-l)/p,g=(f+c)/p,h=(d+l)/p,A=(f-c)/p;return r[0]=Math.max(o,m),r[1]=Math.min(a,g),r[2]=Math.min(i,h),r[3]=Math.max(s,A),r},X.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer,n=this.device,r=t.screenLensDistance,o=(n.widthMeters-t.interLensDistance)/2,a=t.baselineLensDistance-n.bevelMeters,i=(e[0]*r+o)/n.widthMeters,s=(e[1]*r+a)/n.heightMeters,l=(e[2]*r+o)/n.widthMeters,c=(e[3]*r+a)/n.heightMeters;return{x:i,y:c,width:l-i,height:s-c}},X.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},X.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},X.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:B*Math.atan(e.outerDist),rightDegrees:B*Math.atan(e.innerDist),downDegrees:B*Math.atan(e.bottomDist),upDegrees:B*Math.atan(e.topDist)}},X.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,n=this.device,r=t.screenLensDistance,o=n.widthMeters/r,a=n.heightMeters/r,i=n.width/o,s=n.height/a,l=Math.round((e.eyePosX-e.outerDist)*i),c=Math.round((e.eyePosY-e.bottomDist)*s);return{x:l,y:c,width:Math.round((e.eyePosX+e.innerDist)*i)-l,height:Math.round((e.eyePosY+e.topDist)*s)-c}},X.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,n=this.distortion,r=e.screenLensDistance,o=e.interLensDistance/2/r,a=t.widthMeters/r,i=t.heightMeters/r,s=a/2-o,l=(e.baselineLensDistance-t.bevelMeters)/r,c=e.fov,u=n.distortInverse(Math.tan(N*c)),d=Math.min(s,u),f=Math.min(o,u),p=Math.min(l,u);return{outerDist:d,innerDist:f,topDist:Math.min(i-l,u),bottomDist:p,eyePosX:s,eyePosY:l}},X.Viewers=K;var Y={format:1,last_updated:"2019-11-09T17:36:14Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}]};function q(e,t){if(this.dpdb=Y,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var n=new XMLHttpRequest,r=this;n.open("GET",e,!0),n.addEventListener("load",(function(){r.loading=!1,n.status>=200&&n.status<=299?(r.dpdb=JSON.parse(n.response),r.recalculateDeviceParams_()):console.error("Error loading online DPDB!")})),n.send()}}function Z(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}function $(e,t){this.set(e,t)}function J(e,t){this.kFilter=e,this.isDebug=t,this.currentAccelMeasurement=new $,this.currentGyroMeasurement=new $,this.previousGyroMeasurement=new $,s()?this.filterQ=new W(-1,0,0,1):this.filterQ=new W(1,0,0,1),this.previousFilterQ=new W,this.previousFilterQ.copy(this.filterQ),this.accelQ=new W,this.isOrientationInitialized=!1,this.estimatedGravity=new k,this.measuredGravity=new k,this.gyroIntegralQ=new W}function ee(e,t){this.predictionTimeS=e,this.isDebug=t,this.previousQ=new W,this.previousTimestampS=null,this.deltaQ=new W,this.outQ=new W}function te(e,t,n,r){this.yawOnly=n,this.accelerometer=new k,this.gyroscope=new k,this.filter=new J(e,r),this.posePredictor=new ee(t,r),this.isFirefoxAndroid=u(),this.isIOS=s();var o=d();this.isDeviceMotionInRadians=!this.isIOS&&o&&o<66,this.isWithoutDeviceMotion=p()||f(),this.filterToWorldQ=new W,s()?this.filterToWorldQ.setFromAxisAngle(new k(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new k(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new W,this.worldToScreenQ=new W,this.originalPoseAdjustQ=new W,this.originalPoseAdjustQ.setFromAxisAngle(new k(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),g()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new W,this.orientationOut_=new Float32Array(4),this.start()}q.prototype.getDeviceParams=function(){return this.deviceParams},q.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},q.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var t=navigator.userAgent||navigator.vendor||window.opera,n=h(),r=A();if(!e.devices)return console.error("DPDB has no devices section."),null;for(var o=0;o<e.devices.length;o++){var a=e.devices[o];if(a.rules)if("ios"==a.type||"android"==a.type){if(s()==("ios"==a.type)){for(var i=!1,l=0;l<a.rules.length;l++){var c=a.rules[l];if(this.ruleMatches_(c,t,n,r)){i=!0;break}}if(i)return new Z({xdpi:a.dpi[0]||a.dpi,ydpi:a.dpi[1]||a.dpi,bevelMm:a.bw})}}else console.warn("Device["+o+"] has invalid type.");else console.warn("Device["+o+"] has no rules section.")}return console.warn("No DPDB device match."),null},q.prototype.ruleMatches_=function(e,t,n,r){if(!e.ua&&!e.res)return!1;if(e.ua&&"SM"===e.ua.substring(0,2)&&(e.ua=e.ua.substring(0,7)),e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var o=e.res[0],a=e.res[1];if(Math.min(n,r)!=Math.min(o,a)||Math.max(n,r)!=Math.max(o,a))return!1}return!0},$.prototype.set=function(e,t){this.sample=e,this.timestampS=t},$.prototype.copy=function(e){this.set(e.sample,e.timestampS)},J.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},J.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var n,r=t-this.previousGyroMeasurement.timestampS;n=r,isNaN(n)||n<=.001||n>1||this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},J.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new W;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var r,o=new W;o.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),o.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",B*((r=o).w>1?(console.warn("getQuaternionAngle: w > 1"),0):2*Math.acos(r.w)),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var a=new W;a.copy(this.filterQ),a.multiply(o),this.filterQ.slerp(a,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},J.prototype.getOrientation=function(){return this.filterQ},J.prototype.accelToQuaternion_=function(e){var t=new k;t.copy(e),t.normalize();var n=new W;return n.setFromUnitVectors(new k(0,0,-1),t),n.inverse(),n},J.prototype.gyroToQuaternionDelta_=function(e,t){var n=new W,r=new k;return r.copy(e),r.normalize(),n.setFromAxisAngle(r,e.length()*t),n},ee.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=n,e;var r=new k;r.copy(t),r.normalize();var o=t.length();if(o<20*N)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(B*o).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var a=o*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(r,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=n,this.outQ},te.prototype.getPosition=function(){return null},te.prototype.getOrientation=function(){var e=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ)return this.deviceOrientationFixQ=this.deviceOrientationFixQ||(n=(new W).setFromAxisAngle(new k(0,0,-1),0),r=new W,-90===window.orientation?r.setFromAxisAngle(new k(0,1,0),Math.PI/-2):r.setFromAxisAngle(new k(0,1,0),Math.PI/2),n.multiply(r)),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||((t=new W).setFromAxisAngle(new k(1,0,0),-Math.PI/2),t),e=this._deviceOrientationQ,(o=new W).copy(e),o.multiply(this.deviceOrientationFilterToWorldQ),o.multiply(this.resetQ),o.multiply(this.worldToScreenQ),o.multiplyQuaternions(this.deviceOrientationFixQ,o),this.yawOnly&&(o.x=0,o.z=0,o.normalize()),this.orientationOut_[0]=o.x,this.orientationOut_[1]=o.y,this.orientationOut_[2]=o.z,this.orientationOut_[3]=o.w,this.orientationOut_;var t,n,r,o,a=this.filter.getOrientation();return e=this.posePredictor.getPrediction(a,this.gyroscope,this.previousTimestampS),(o=new W).copy(this.filterToWorldQ),o.multiply(this.resetQ),o.multiply(e),o.multiply(this.worldToScreenQ),this.yawOnly&&(o.x=0,o.z=0,o.normalize()),this.orientationOut_[0]=o.x,this.orientationOut_[1]=o.y,this.orientationOut_[2]=o.z,this.orientationOut_[3]=o.w,this.orientationOut_},te.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),g()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},te.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new W;var t=e.alpha,n=e.beta,r=e.gamma;t=(t||0)*Math.PI/180,n=(n||0)*Math.PI/180,r=(r||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(n,t,-r)},te.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)},te.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity,n=e.rotationRate,r=e.timeStamp/1e3,o=r-this.previousTimestampS;return o<0?(S("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),void(this.previousTimestampS=r)):o<=.001||o>1?(S("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),void(this.previousTimestampS=r)):(this.accelerometer.set(-t.x,-t.y,-t.z),n&&(m()?this.gyroscope.set(-n.beta,n.alpha,n.gamma):this.gyroscope.set(n.alpha,n.beta,n.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,r)),this.filter.addAccelMeasurement(this.accelerometer,r),void(this.previousTimestampS=r))},te.prototype.onOrientationChange_=function(e){this.setScreenTransform_()},te.prototype.onMessage_=function(e){var t=e.data;t&&t.type&&"devicemotion"===t.type.toLowerCase()&&this.updateDeviceMotion_(t.deviceMotionEvent)},te.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new k(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new k(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},te.prototype.start=function(){var e,t,n;this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),s()&&(e=window.self!==window.top,t=M(document.referrer),n=M(window.location.href),e&&t!==n)&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},te.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var ne=new k(1,0,0),re=new k(0,0,1),oe=new W;oe.setFromAxisAngle(ne,-Math.PI/2),oe.multiply((new W).setFromAxisAngle(re,Math.PI/2));var ae=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new W,this._outQ=new W,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return o(e,[{key:"init",value:function(){var e=null;try{(e=new RelativeOrientationSensor({frequency:60,referenceFrame:"screen"})).addEventListener("error",this._onSensorError)}catch(e){this.errors.push(e),"SecurityError"===e.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===e.name?this.useDeviceMotion():console.error(e)}e&&(this.api="sensor",this.sensor=e,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new te(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var e=this.sensor.quaternion;this._sensorQ.set(e[0],e[1],e[2],e[3]);var t=this._outQ;return t.copy(oe),t.multiply(this._sensorQ),this.config.YAW_ONLY&&(t.x=t.z=0,t.normalize()),this._out[0]=t.x,this._out[1]=t.y,this._out[2]=t.z,this._out[3]=t.w,this._out}},{key:"_onSensorError",value:function(e){this.errors.push(e.error),"NotAllowedError"===e.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===e.error.name?console.error("Sensor could not be read"):console.error(e.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),e}();function ie(){this.loadIcon_();var e=document.createElement("div");(a=e.style).position="fixed",a.top=0,a.right=0,a.bottom=0,a.left=0,a.backgroundColor="gray",a.fontFamily="sans-serif",a.zIndex=1e6;var t=document.createElement("img");t.src=this.icon,(a=t.style).marginLeft="25%",a.marginTop="25%",a.width="50%",e.appendChild(t);var n=document.createElement("div");(a=n.style).textAlign="center",a.fontSize="16px",a.lineHeight="24px",a.margin="24px 25%",a.width="50%",n.innerHTML="Place your phone into your Cardboard viewer.",e.appendChild(n);var r=document.createElement("div");(a=r.style).backgroundColor="#CFD8DC",a.position="fixed",a.bottom=0,a.width="100%",a.height="48px",a.padding="14px 24px",a.boxSizing="border-box",a.color="#656A6B",e.appendChild(r);var o=document.createElement("div");o.style.float="left",o.innerHTML="No Cardboard viewer?";var a,i=document.createElement("a");i.href="https://www.google.com/get/cardboard/get-cardboard/",i.innerHTML="get one",i.target="_blank",(a=i.style).float="right",a.fontWeight=600,a.textTransform="uppercase",a.borderLeft="1px solid gray",a.paddingLeft="24px",a.textDecoration="none",a.color="#656A6B",r.appendChild(o),r.appendChild(i),this.overlay=e,this.text=n,this.hide()}function se(e){try{this.selectedKey=localStorage.getItem("WEBVR_CARDBOARD_VIEWER")}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=e||"CardboardV1"),this.dialog=this.createDialog_(X.Viewers),this.root=null,this.onChangeCallbacks_=[]}ie.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var t=this.overlay.querySelector("img").style;g()?(t.width="20%",t.marginLeft="40%",t.marginTop="3%"):(t.width="50%",t.marginLeft="25%",t.marginTop="25%")},ie.prototype.hide=function(){this.overlay.style.display="none"},ie.prototype.showTemporarily=function(e,t){this.show(t),this.timer=setTimeout(this.hide.bind(this),e)},ie.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},ie.prototype.update=function(){this.disableShowTemporarily(),!g()&&T()?this.show():this.hide()},ie.prototype.loadIcon_=function(){this.icon="data:image/svg+xml,"+encodeURIComponent("<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>")},se.prototype.show=function(e){this.root=e,e.appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},se.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},se.prototype.getCurrentViewer=function(){return X.Viewers[this.selectedKey]},se.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},se.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)},se.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)},se.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),this.selectedKey&&X.Viewers[this.selectedKey]){this.fireOnChange_(X.Viewers[this.selectedKey]);try{localStorage.setItem("WEBVR_CARDBOARD_VIEWER",this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")},se.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add("webvr-polyfill-viewer-selector"),t.style.display="none";var n=document.createElement("div");(o=n.style).position="fixed",o.left=0,o.top=0,o.width="100%",o.height="100%",o.background="rgba(0, 0, 0, 0.3)",n.addEventListener("click",this.hide.bind(this));var r=document.createElement("div"),o=r.style;for(var a in o.boxSizing="border-box",o.position="fixed",o.top="24px",o.left="50%",o.marginLeft="-140px",o.width="280px",o.padding="24px",o.overflow="hidden",o.background="#fafafa",o.fontFamily="'Roboto', sans-serif",o.boxShadow="0px 5px 20px #666",r.appendChild(this.createH1_("Select your viewer")),e)r.appendChild(this.createChoice_(a,e[a].label));return r.appendChild(this.createButton_("Save",this.onSave_.bind(this))),t.appendChild(n),t.appendChild(r),t},se.prototype.createH1_=function(e){var t=document.createElement("h1"),n=t.style;return n.color="black",n.fontSize="20px",n.fontWeight="bold",n.marginTop=0,n.marginBottom="24px",t.innerHTML=e,t},se.prototype.createChoice_=function(e,t){var n=document.createElement("div");n.style.marginTop="8px",n.style.color="black";var r=document.createElement("input");r.style.fontSize="30px",r.setAttribute("id",e),r.setAttribute("type","radio"),r.setAttribute("value",e),r.setAttribute("name","field");var o=document.createElement("label");return o.style.marginLeft="4px",o.setAttribute("for",e),o.innerHTML=t,n.appendChild(r),n.appendChild(o),n},se.prototype.createButton_=function(e,t){var n=document.createElement("button");n.innerHTML=e;var r=n.style;return r.float="right",r.textTransform="uppercase",r.color="#1094f7",r.fontSize="14px",r.letterSpacing=0,r.border=0,r.background="none",r.marginTop="16px",n.addEventListener("click",t),n},"undefined"!=typeof window?window:void 0!==n||"undefined"!=typeof self&&self;var le,ce=(le=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){!function(t,n){e.exports=n()}(0,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a="undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",o),this.noSleepVideo.addEventListener("timeupdate",function(e){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return r(e,[{key:"enable",value:function(){a?(this.disable(),this.noSleepTimer=window.setInterval((function(){window.location.href="/",window.setTimeout(window.stop,0)}),15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){a?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),e}();e.exports=i},function(e,t,n){e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])}))})))&&le.__esModule&&Object.prototype.hasOwnProperty.call(le,"default")?le.default:le,ue=1e3,de=[0,0,.5,1],fe=[.5,0,.5,1],pe=window.requestAnimationFrame,me=window.cancelAnimationFrame;function ge(e){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:e.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:e.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:e.canPresent},maxLayers:{writable:!1,enumerable:!0,value:e.maxLayers},hasOrientation:{enumerable:!0,get:function(){return w("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),e.hasOrientation}}})}function he(e){var t=!("wakelock"in(e=e||{}))||e.wakelock;this.isPolyfilled=!0,this.displayId=ue++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return w("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new ge({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,t&&T()&&(this.wakelock_=new ce)}he.prototype.getFrameData=function(e){return E(e,this._getPose(),this)},he.prototype.getPose=function(){return w("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},he.prototype.resetPose=function(){return w("VRDisplay.prototype.resetPose"),this._resetPose()},he.prototype.getImmediatePose=function(){return w("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},he.prototype.requestAnimationFrame=function(e){return pe(e)},he.prototype.cancelAnimationFrame=function(e){return me(e)},he.prototype.wrapForFullscreen=function(e){if(s())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=e,this.originalParent_=e.parentElement,this.originalParent_||document.body.appendChild(e),!this.fullscreenWrapper_.parentElement){var n=this.fullscreenElement_.parentElement;n.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),n.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var r=this;return function(){if(r.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];r.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}(),this.fullscreenWrapper_},he.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),this.originalParent_===t?t.insertBefore(e,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(e),t.removeChild(this.fullscreenWrapper_),e}},he.prototype.requestPresent=function(e){var t=this.isPresenting,n=this;return e instanceof Array||(w("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),e=[e]),new Promise((function(r,o){if(n.capabilities.canPresent)if(0==e.length||e.length>n.capabilities.maxLayers)o(new Error("Invalid number of layers."));else{var a=e[0];if(a.source){var i=a.leftBounds||de,c=a.rightBounds||fe;if(t){var u=n.layer_;u.source!==a.source&&(u.source=a.source);for(var d=0;d<4;d++)u.leftBounds[d]=i[d],u.rightBounds[d]=c[d];return n.wrapForFullscreen(n.layer_.source),n.updatePresent_(),void r()}if(n.layer_={predistorted:a.predistorted,source:a.source,leftBounds:i.slice(0),rightBounds:c.slice(0)},n.waitingForPresent_=!1,n.layer_&&n.layer_.source){var f=n.wrapForFullscreen(n.layer_.source);n.addFullscreenListeners_(f,(function(){var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n.isPresenting=f===e,n.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch((function(e){console.error("screen.orientation.lock() failed due to",e.message)})),n.waitingForPresent_=!1,n.beginPresent_(),r()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),n.removeFullscreenWrapper(),n.disableWakeLock(),n.endPresent_(),n.removeFullscreenListeners_()),n.fireVRDisplayPresentChange_()}),(function(){n.waitingForPresent_&&(n.removeFullscreenWrapper(),n.removeFullscreenListeners_(),n.disableWakeLock(),n.waitingForPresent_=!1,n.isPresenting=!1,o(new Error("Unable to present.")))})),function(e){if(l())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0}(f)?(n.enableWakeLock(),n.waitingForPresent_=!0):(s()||l())&&(n.enableWakeLock(),n.isPresenting=!0,n.beginPresent_(),n.fireVRDisplayPresentChange_(),r())}n.waitingForPresent_||s()||(v(),o(new Error("Unable to present.")))}else r()}else o(new Error("VRDisplay is not capable of presenting."))}))},he.prototype.exitPresent=function(){var e=this.isPresenting,t=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise((function(n,r){e?(!v()&&s()&&(t.endPresent_(),t.fireVRDisplayPresentChange_()),l()&&(t.removeFullscreenWrapper(),t.removeFullscreenListeners_(),t.endPresent_(),t.fireVRDisplayPresentChange_()),n()):r(new Error("Was not presenting to VRDisplay."))}))},he.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},he.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},he.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)},he.prototype.addFullscreenListeners_=function(e,t,n){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=t,this.fullscreenErrorHandler_=n,t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,!1)),n&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",n,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",n,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",n,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",n,!1))},he.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("msfullscreenchange",t,!1)}if(this.fullscreenErrorHandler_){var n=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",n,!1),e.removeEventListener("webkitfullscreenerror",n,!1),document.removeEventListener("mozfullscreenerror",n,!1),e.removeEventListener("msfullscreenerror",n,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},he.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},he.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},he.prototype.beginPresent_=function(){},he.prototype.endPresent_=function(){},he.prototype.submitFrame=function(e){},he.prototype.getEyeParameters=function(e){return null};var Ae={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},ve="left",ye="right";function be(e){var t=x({},Ae);e=x(t,e||{}),he.call(this,{wakelock:e.MOBILE_WAKE_LOCK}),this.config=e,this.displayName="Cardboard VRDisplay",this.capabilities=new ge({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new ae(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new q(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new X(this.dpdb_.getDeviceParams(),e.ADDITIONAL_VIEWERS),this.viewerSelector_=new se(e.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new ie),s()&&window.addEventListener("resize",this.onResize_.bind(this))}return be.prototype=Object.create(he.prototype),be.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},be.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},be.prototype._getFieldOfView=function(e){var t;if(e==ve)t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=ye)return console.error("Invalid eye provided: %s",e),null;t=this.deviceInfo_.getFieldOfViewRightEye()}return t},be.prototype._getEyeOffset=function(e){var t;if(e==ve)t=[.5*-this.deviceInfo_.viewer.interLensDistance,0,0];else{if(e!=ye)return console.error("Invalid eye provided: %s",e),null;t=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return t},be.prototype.getEyeParameters=function(e){var t=this._getEyeOffset(e),n=this._getFieldOfView(e),r={offset:t,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(r,"fieldOfView",{enumerable:!0,get:function(){return w("VRFieldOfView","VRFrameData's projection matrices"),n}}),r},be.prototype.onDeviceParamsUpdated_=function(e){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},be.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},be.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(e.canvas.width=h()*this.bufferScale_,e.canvas.height=A()*this.bufferScale_,this.cardboardUI_=new _(e)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new _(e)),this.distorter_=new I(e,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(g()&&T()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},be.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},be.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},be.prototype.submitFrame=function(e){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2"));var n=t.canvas;n.width==this.lastWidth&&n.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=n.width,this.lastHeight=n.height,this.cardboardUI_.render()}},be.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},be.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2")),t.canvas.setAttribute("style",["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"].join("; ")+";"),C(t.canvas)}},be.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},be.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},be.VRFrameData=function(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null},be.VRDisplay=he,be}()})),s=(e=i)&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,l={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function c(e){this.config=a(a({},l),e),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&r())&&(this.enable(),this.getVRDisplays().then((function(e){e&&e[0]&&e[0].fireVRDisplayConnect_&&e[0].fireVRDisplayConnect_()})))}c.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(r()){var e=new s({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(e)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},c.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var e=this.native.VRFrameData,t=new this.native.VRFrameData,n=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(r){r instanceof e?n.call(this,r):(n.call(this,t),r.pose=t.pose,o(t.leftProjectionMatrix,r.leftProjectionMatrix),o(t.rightProjectionMatrix,r.rightProjectionMatrix),o(t.leftViewMatrix,r.leftViewMatrix),o(t.rightViewMatrix,r.rightViewMatrix))}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=s.VRDisplay,window.VRFrameData=s.VRFrameData},c.prototype.getVRDisplays=function(){var e=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then((function(t){return t.length>0?t:e.getPolyfillDisplays()})):Promise.resolve(this.getPolyfillDisplays())},c.version="0.10.12",c.VRFrameData=s.VRFrameData,c.VRDisplay=s.VRDisplay;var u=Object.freeze({default:c}),d=u&&c||u;return void 0!==n&&n.window&&(n.document||(n.document=n.window.document),n.navigator||(n.navigator=n.window.navigator)),d},e.exports=n()}).call(this,n(9))},,,,,function(e,t,n){(function(e){var r;!function(e,o,a){function i(e){var t,n=this,r=(t=4022871197,function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var n=new i(e),r=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(4)&&n(7)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.alea=l}(0,e,n(4))}).call(this,n(6)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var n=new i(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(4)&&n(7)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xor128=l}(0,e,n(4))}).call(this,n(6)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var n=new i(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(4)&&n(7)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xorwow=l}(0,e,n(4))}).call(this,n(6)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(4)&&n(7)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xorshift7=l}(0,e,n(4))}).call(this,n(6)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,a=t.i;return t.w=r=r+1640531527|0,n=o[a+34&127],e=o[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,o,a,i,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),o=0,a=-32;a<l;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,o=0==(n=s[127&a]^=r+i)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,a=512;a>0;--a)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=i,e.X=s,e.i=o}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(4)&&n(7)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.xor4096=l}(0,e,n(4))}).call(this,n(6)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var n=new i(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=l:n(4)&&n(7)?void 0===(r=function(){return l}.call(t,n,t,o))||(o.exports=r):this.tychei=l}(0,e,n(4))}).call(this,n(6)(e))},function(e,t,n){var r;!function(o,a,i){var s,l=i.pow(256,6),c=i.pow(2,52),u=2*c;function d(e,t,n){var r=[],d=m(function e(t,n){var r,o=[],a=typeof t;if(n&&"object"==a)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==a?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,g(a)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(256):(e=new Uint8Array(256),(o.crypto||o.msCrypto).getRandomValues(e)),g(e)}catch(e){var t=o.navigator,n=t&&t.plugins;return[+new Date,o,n,o.screen,g(a)]}}():e,3),r),h=new f(r),A=function(){for(var e=h.g(6),t=l,n=0;e<c;)e=256*(e+n),t*=256,n=h.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return A.int32=function(){return 0|h.g(4)},A.quick=function(){return h.g(4)/4294967296},A.double=A,m(g(h.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&p(r,h),e.state=function(){return p(h,{})}),n?(i.random=e,t):e})(A,d,"global"in t?t.global:this==i,t.state)}function f(e){var t,n=e.length,r=this,o=0,a=r.i=r.j=0,i=r.S=[];for(n||(e=[n++]);o<256;)i[o]=o++;for(o=0;o<256;o++)i[o]=i[a=255&a+e[o%n]+(t=i[o])],i[a]=t;(r.g=function(e){for(var t,n=0,o=r.i,a=r.j,i=r.S;e--;)t=i[o=255&o+1],n=256*n+i[255&(i[o]=i[a=255&a+t])+(i[a]=t)];return r.i=o,r.j=a,n})(256)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",o=0;o<r.length;)t[255&o]=255&(n^=19*t[255&o])+r.charCodeAt(o++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(m(i.random(),a),e.exports){e.exports=d;try{s=n(28)}catch(e){}}else void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof self?self:this,[],Math)},function(e,t){},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"EPSILON",(function(){return E})),n.d(r,"ARRAY_TYPE",(function(){return M})),n.d(r,"RANDOM",(function(){return S})),n.d(r,"setMatrixArrayType",(function(){return w})),n.d(r,"toRadian",(function(){return P})),n.d(r,"equals",(function(){return O}));var o={};n.r(o),n.d(o,"create",(function(){return I})),n.d(o,"fromMat4",(function(){return D})),n.d(o,"clone",(function(){return V})),n.d(o,"copy",(function(){return L})),n.d(o,"fromValues",(function(){return _})),n.d(o,"set",(function(){return F})),n.d(o,"identity",(function(){return N})),n.d(o,"transpose",(function(){return B})),n.d(o,"invert",(function(){return k})),n.d(o,"adjoint",(function(){return G})),n.d(o,"determinant",(function(){return U})),n.d(o,"multiply",(function(){return W})),n.d(o,"translate",(function(){return z})),n.d(o,"rotate",(function(){return H})),n.d(o,"scale",(function(){return j})),n.d(o,"fromTranslation",(function(){return K})),n.d(o,"fromRotation",(function(){return X})),n.d(o,"fromScaling",(function(){return Q})),n.d(o,"fromMat2d",(function(){return Y})),n.d(o,"fromQuat",(function(){return q})),n.d(o,"normalFromMat4",(function(){return Z})),n.d(o,"projection",(function(){return $})),n.d(o,"str",(function(){return J})),n.d(o,"frob",(function(){return ee})),n.d(o,"add",(function(){return te})),n.d(o,"subtract",(function(){return ne})),n.d(o,"multiplyScalar",(function(){return re})),n.d(o,"multiplyScalarAndAdd",(function(){return oe})),n.d(o,"exactEquals",(function(){return ae})),n.d(o,"equals",(function(){return ie})),n.d(o,"mul",(function(){return se})),n.d(o,"sub",(function(){return le}));var a={};n.r(a),n.d(a,"create",(function(){return ce})),n.d(a,"clone",(function(){return ue})),n.d(a,"copy",(function(){return de})),n.d(a,"fromValues",(function(){return fe})),n.d(a,"set",(function(){return pe})),n.d(a,"identity",(function(){return me})),n.d(a,"transpose",(function(){return ge})),n.d(a,"invert",(function(){return he})),n.d(a,"adjoint",(function(){return Ae})),n.d(a,"determinant",(function(){return ve})),n.d(a,"multiply",(function(){return ye})),n.d(a,"translate",(function(){return be})),n.d(a,"scale",(function(){return Te})),n.d(a,"rotate",(function(){return xe})),n.d(a,"rotateX",(function(){return Ce})),n.d(a,"rotateY",(function(){return Ee})),n.d(a,"rotateZ",(function(){return Me})),n.d(a,"fromTranslation",(function(){return Se})),n.d(a,"fromScaling",(function(){return we})),n.d(a,"fromRotation",(function(){return Re})),n.d(a,"fromXRotation",(function(){return Pe})),n.d(a,"fromYRotation",(function(){return Oe})),n.d(a,"fromZRotation",(function(){return Ie})),n.d(a,"fromRotationTranslation",(function(){return De})),n.d(a,"fromQuat2",(function(){return Ve})),n.d(a,"getTranslation",(function(){return Le})),n.d(a,"getScaling",(function(){return _e})),n.d(a,"getRotation",(function(){return Fe})),n.d(a,"fromRotationTranslationScale",(function(){return Ne})),n.d(a,"fromRotationTranslationScaleOrigin",(function(){return Be})),n.d(a,"fromQuat",(function(){return ke})),n.d(a,"frustum",(function(){return Ge})),n.d(a,"perspective",(function(){return Ue})),n.d(a,"perspectiveFromFieldOfView",(function(){return We})),n.d(a,"ortho",(function(){return ze})),n.d(a,"lookAt",(function(){return He})),n.d(a,"targetTo",(function(){return je})),n.d(a,"str",(function(){return Ke})),n.d(a,"frob",(function(){return Xe})),n.d(a,"add",(function(){return Qe})),n.d(a,"subtract",(function(){return Ye})),n.d(a,"multiplyScalar",(function(){return qe})),n.d(a,"multiplyScalarAndAdd",(function(){return Ze})),n.d(a,"exactEquals",(function(){return $e})),n.d(a,"equals",(function(){return Je})),n.d(a,"mul",(function(){return et})),n.d(a,"sub",(function(){return tt}));var i={};n.r(i),n.d(i,"create",(function(){return nt})),n.d(i,"clone",(function(){return rt})),n.d(i,"length",(function(){return ot})),n.d(i,"fromValues",(function(){return at})),n.d(i,"copy",(function(){return it})),n.d(i,"set",(function(){return st})),n.d(i,"add",(function(){return lt})),n.d(i,"subtract",(function(){return ct})),n.d(i,"multiply",(function(){return ut})),n.d(i,"divide",(function(){return dt})),n.d(i,"ceil",(function(){return ft})),n.d(i,"floor",(function(){return pt})),n.d(i,"min",(function(){return mt})),n.d(i,"max",(function(){return gt})),n.d(i,"round",(function(){return ht})),n.d(i,"scale",(function(){return At})),n.d(i,"scaleAndAdd",(function(){return vt})),n.d(i,"distance",(function(){return yt})),n.d(i,"squaredDistance",(function(){return bt})),n.d(i,"squaredLength",(function(){return Tt})),n.d(i,"negate",(function(){return xt})),n.d(i,"inverse",(function(){return Ct})),n.d(i,"normalize",(function(){return Et})),n.d(i,"dot",(function(){return Mt})),n.d(i,"cross",(function(){return St})),n.d(i,"lerp",(function(){return wt})),n.d(i,"hermite",(function(){return Rt})),n.d(i,"bezier",(function(){return Pt})),n.d(i,"random",(function(){return Ot})),n.d(i,"transformMat4",(function(){return It})),n.d(i,"transformMat3",(function(){return Dt})),n.d(i,"transformQuat",(function(){return Vt})),n.d(i,"rotateX",(function(){return Lt})),n.d(i,"rotateY",(function(){return _t})),n.d(i,"rotateZ",(function(){return Ft})),n.d(i,"angle",(function(){return Nt})),n.d(i,"zero",(function(){return Bt})),n.d(i,"str",(function(){return kt})),n.d(i,"exactEquals",(function(){return Gt})),n.d(i,"equals",(function(){return Ut})),n.d(i,"sub",(function(){return zt})),n.d(i,"mul",(function(){return Ht})),n.d(i,"div",(function(){return jt})),n.d(i,"dist",(function(){return Kt})),n.d(i,"sqrDist",(function(){return Xt})),n.d(i,"len",(function(){return Qt})),n.d(i,"sqrLen",(function(){return Yt})),n.d(i,"forEach",(function(){return qt}));var s={};n.r(s),n.d(s,"create",(function(){return Zt})),n.d(s,"clone",(function(){return $t})),n.d(s,"fromValues",(function(){return Jt})),n.d(s,"copy",(function(){return en})),n.d(s,"set",(function(){return tn})),n.d(s,"add",(function(){return nn})),n.d(s,"subtract",(function(){return rn})),n.d(s,"multiply",(function(){return on})),n.d(s,"divide",(function(){return an})),n.d(s,"ceil",(function(){return sn})),n.d(s,"floor",(function(){return ln})),n.d(s,"min",(function(){return cn})),n.d(s,"max",(function(){return un})),n.d(s,"round",(function(){return dn})),n.d(s,"scale",(function(){return fn})),n.d(s,"scaleAndAdd",(function(){return pn})),n.d(s,"distance",(function(){return mn})),n.d(s,"squaredDistance",(function(){return gn})),n.d(s,"length",(function(){return hn})),n.d(s,"squaredLength",(function(){return An})),n.d(s,"negate",(function(){return vn})),n.d(s,"inverse",(function(){return yn})),n.d(s,"normalize",(function(){return bn})),n.d(s,"dot",(function(){return Tn})),n.d(s,"cross",(function(){return xn})),n.d(s,"lerp",(function(){return Cn})),n.d(s,"random",(function(){return En})),n.d(s,"transformMat4",(function(){return Mn})),n.d(s,"transformQuat",(function(){return Sn})),n.d(s,"zero",(function(){return wn})),n.d(s,"str",(function(){return Rn})),n.d(s,"exactEquals",(function(){return Pn})),n.d(s,"equals",(function(){return On})),n.d(s,"sub",(function(){return In})),n.d(s,"mul",(function(){return Dn})),n.d(s,"div",(function(){return Vn})),n.d(s,"dist",(function(){return Ln})),n.d(s,"sqrDist",(function(){return _n})),n.d(s,"len",(function(){return Fn})),n.d(s,"sqrLen",(function(){return Nn})),n.d(s,"forEach",(function(){return Bn}));var l={};n.r(l),n.d(l,"create",(function(){return kn})),n.d(l,"identity",(function(){return Gn})),n.d(l,"setAxisAngle",(function(){return Un})),n.d(l,"getAxisAngle",(function(){return Wn})),n.d(l,"getAngle",(function(){return zn})),n.d(l,"multiply",(function(){return Hn})),n.d(l,"rotateX",(function(){return jn})),n.d(l,"rotateY",(function(){return Kn})),n.d(l,"rotateZ",(function(){return Xn})),n.d(l,"calculateW",(function(){return Qn})),n.d(l,"exp",(function(){return Yn})),n.d(l,"ln",(function(){return qn})),n.d(l,"pow",(function(){return Zn})),n.d(l,"slerp",(function(){return $n})),n.d(l,"random",(function(){return Jn})),n.d(l,"invert",(function(){return er})),n.d(l,"conjugate",(function(){return tr})),n.d(l,"fromMat3",(function(){return nr})),n.d(l,"fromEuler",(function(){return rr})),n.d(l,"str",(function(){return or})),n.d(l,"clone",(function(){return dr})),n.d(l,"fromValues",(function(){return fr})),n.d(l,"copy",(function(){return pr})),n.d(l,"set",(function(){return mr})),n.d(l,"add",(function(){return gr})),n.d(l,"mul",(function(){return hr})),n.d(l,"scale",(function(){return Ar})),n.d(l,"dot",(function(){return vr})),n.d(l,"lerp",(function(){return yr})),n.d(l,"length",(function(){return br})),n.d(l,"len",(function(){return Tr})),n.d(l,"squaredLength",(function(){return xr})),n.d(l,"sqrLen",(function(){return Cr})),n.d(l,"normalize",(function(){return Er})),n.d(l,"exactEquals",(function(){return Mr})),n.d(l,"equals",(function(){return Sr})),n.d(l,"rotationTo",(function(){return wr})),n.d(l,"sqlerp",(function(){return Rr})),n.d(l,"setAxes",(function(){return Pr}));var c=n(2),u=n.n(c),d=n(1),f=n.n(d);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(a,e);var t,n,r,o=A(a);function a(){return m(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){var e=this.props,t=e.id,n=e.setProps,r=e.children,o=e.view,a=e.representation,i=e.dataset,s={fields:i.getCellData(),dataset:i,representation:a,view:o,setProps:n},l=u.a.Children.map(r,(function(e){return u.a.cloneElement(e,s)}));return u.a.createElement("div",{id:t},l)}}])&&g(t.prototype,n),r&&g(t,r),a}(c.Component);b.defaultProps={},b.propTypes={id:f.a.string,setProps:f.a.func,children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])};const T={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"};var x={DefaultDataType:T.FLOAT,DataTypeByteSize:{Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},VtkDataTypes:T},C=n(0),E=(n(10),1e-6),M="undefined"!=typeof Float32Array?Float32Array:Array,S=Math.random;function w(e){M=e}var R=Math.PI/180;function P(e){return e*R}function O(e,t){return Math.abs(e-t)<=E*Math.max(1,Math.abs(e),Math.abs(t))}function I(){var e=new M(9);return M!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function D(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function V(e){var t=new M(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function L(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function _(e,t,n,r,o,a,i,s,l){var c=new M(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=o,c[5]=a,c[6]=i,c[7]=s,c[8]=l,c}function F(e,t,n,r,o,a,i,s,l,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=i,e[6]=s,e[7]=l,e[8]=c,e}function N(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function B(e,t){if(e===t){var n=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function k(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=u*i-s*c,f=-u*a+s*l,p=c*a-i*l,m=n*d+r*f+o*p;return m?(m=1/m,e[0]=d*m,e[1]=(-u*r+o*c)*m,e[2]=(s*r-o*i)*m,e[3]=f*m,e[4]=(u*n-o*l)*m,e[5]=(-s*n+o*a)*m,e[6]=p*m,e[7]=(-c*n+r*l)*m,e[8]=(i*n-r*a)*m,e):null}function G(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8];return e[0]=i*u-s*c,e[1]=o*c-r*u,e[2]=r*s-o*i,e[3]=s*l-a*u,e[4]=n*u-o*l,e[5]=o*a-n*s,e[6]=a*c-i*l,e[7]=r*l-n*c,e[8]=n*i-r*a,e}function U(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=e[4],i=e[5],s=e[6],l=e[7],c=e[8];return t*(c*a-i*l)+n*(-c*o+i*s)+r*(l*o-a*s)}function W(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=n[0],p=n[1],m=n[2],g=n[3],h=n[4],A=n[5],v=n[6],y=n[7],b=n[8];return e[0]=f*r+p*i+m*c,e[1]=f*o+p*s+m*u,e[2]=f*a+p*l+m*d,e[3]=g*r+h*i+A*c,e[4]=g*o+h*s+A*u,e[5]=g*a+h*l+A*d,e[6]=v*r+y*i+b*c,e[7]=v*o+y*s+b*u,e[8]=v*a+y*l+b*d,e}function z(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=n[0],p=n[1];return e[0]=r,e[1]=o,e[2]=a,e[3]=i,e[4]=s,e[5]=l,e[6]=f*r+p*i+c,e[7]=f*o+p*s+u,e[8]=f*a+p*l+d,e}function H(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=Math.sin(n),p=Math.cos(n);return e[0]=p*r+f*i,e[1]=p*o+f*s,e[2]=p*a+f*l,e[3]=p*i-f*r,e[4]=p*s-f*o,e[5]=p*l-f*a,e[6]=c,e[7]=u,e[8]=d,e}function j(e,t,n){var r=n[0],o=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function K(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function X(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Q(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function q(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=n+n,s=r+r,l=o+o,c=n*i,u=r*i,d=r*s,f=o*i,p=o*s,m=o*l,g=a*i,h=a*s,A=a*l;return e[0]=1-d-m,e[3]=u-A,e[6]=f+h,e[1]=u+A,e[4]=1-c-m,e[7]=p-g,e[2]=f-h,e[5]=p+g,e[8]=1-c-d,e}function Z(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],h=t[14],A=t[15],v=n*s-r*i,y=n*l-o*i,b=n*c-a*i,T=r*l-o*s,x=r*c-a*s,C=o*c-a*l,E=u*g-d*m,M=u*h-f*m,S=u*A-p*m,w=d*h-f*g,R=d*A-p*g,P=f*A-p*h,O=v*P-y*R+b*w+T*S-x*M+C*E;return O?(O=1/O,e[0]=(s*P-l*R+c*w)*O,e[1]=(l*S-i*P-c*M)*O,e[2]=(i*R-s*S+c*E)*O,e[3]=(o*R-r*P-a*w)*O,e[4]=(n*P-o*S+a*M)*O,e[5]=(r*S-n*R-a*E)*O,e[6]=(g*C-h*x+A*T)*O,e[7]=(h*b-m*C-A*y)*O,e[8]=(m*x-g*b+A*v)*O,e):null}function $(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function J(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function ee(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function te(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function ne(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function re(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function oe(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function ae(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function ie(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=t[0],f=t[1],p=t[2],m=t[3],g=t[4],h=t[5],A=t[6],v=t[7],y=t[8];return Math.abs(n-d)<=E*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-f)<=E*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-p)<=E*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-m)<=E*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(i-g)<=E*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-h)<=E*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(l-A)<=E*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-v)<=E*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-y)<=E*Math.max(1,Math.abs(u),Math.abs(y))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var se=W,le=ne;function ce(){var e=new M(16);return M!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ue(e){var t=new M(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function de(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function fe(e,t,n,r,o,a,i,s,l,c,u,d,f,p,m,g){var h=new M(16);return h[0]=e,h[1]=t,h[2]=n,h[3]=r,h[4]=o,h[5]=a,h[6]=i,h[7]=s,h[8]=l,h[9]=c,h[10]=u,h[11]=d,h[12]=f,h[13]=p,h[14]=m,h[15]=g,h}function pe(e,t,n,r,o,a,i,s,l,c,u,d,f,p,m,g,h){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=i,e[6]=s,e[7]=l,e[8]=c,e[9]=u,e[10]=d,e[11]=f,e[12]=p,e[13]=m,e[14]=g,e[15]=h,e}function me(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ge(e,t){if(e===t){var n=t[1],r=t[2],o=t[3],a=t[6],i=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=o,e[13]=i,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function he(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],h=t[14],A=t[15],v=n*s-r*i,y=n*l-o*i,b=n*c-a*i,T=r*l-o*s,x=r*c-a*s,C=o*c-a*l,E=u*g-d*m,M=u*h-f*m,S=u*A-p*m,w=d*h-f*g,R=d*A-p*g,P=f*A-p*h,O=v*P-y*R+b*w+T*S-x*M+C*E;return O?(O=1/O,e[0]=(s*P-l*R+c*w)*O,e[1]=(o*R-r*P-a*w)*O,e[2]=(g*C-h*x+A*T)*O,e[3]=(f*x-d*C-p*T)*O,e[4]=(l*S-i*P-c*M)*O,e[5]=(n*P-o*S+a*M)*O,e[6]=(h*b-m*C-A*y)*O,e[7]=(u*C-f*b+p*y)*O,e[8]=(i*R-s*S+c*E)*O,e[9]=(r*S-n*R-a*E)*O,e[10]=(m*x-g*b+A*v)*O,e[11]=(d*b-u*x-p*v)*O,e[12]=(s*M-i*w-l*E)*O,e[13]=(n*w-r*M+o*E)*O,e[14]=(g*y-m*T-h*v)*O,e[15]=(u*T-d*y+f*v)*O,e):null}function Ae(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],h=t[14],A=t[15];return e[0]=s*(f*A-p*h)-d*(l*A-c*h)+g*(l*p-c*f),e[1]=-(r*(f*A-p*h)-d*(o*A-a*h)+g*(o*p-a*f)),e[2]=r*(l*A-c*h)-s*(o*A-a*h)+g*(o*c-a*l),e[3]=-(r*(l*p-c*f)-s*(o*p-a*f)+d*(o*c-a*l)),e[4]=-(i*(f*A-p*h)-u*(l*A-c*h)+m*(l*p-c*f)),e[5]=n*(f*A-p*h)-u*(o*A-a*h)+m*(o*p-a*f),e[6]=-(n*(l*A-c*h)-i*(o*A-a*h)+m*(o*c-a*l)),e[7]=n*(l*p-c*f)-i*(o*p-a*f)+u*(o*c-a*l),e[8]=i*(d*A-p*g)-u*(s*A-c*g)+m*(s*p-c*d),e[9]=-(n*(d*A-p*g)-u*(r*A-a*g)+m*(r*p-a*d)),e[10]=n*(s*A-c*g)-i*(r*A-a*g)+m*(r*c-a*s),e[11]=-(n*(s*p-c*d)-i*(r*p-a*d)+u*(r*c-a*s)),e[12]=-(i*(d*h-f*g)-u*(s*h-l*g)+m*(s*f-l*d)),e[13]=n*(d*h-f*g)-u*(r*h-o*g)+m*(r*f-o*d),e[14]=-(n*(s*h-l*g)-i*(r*h-o*g)+m*(r*l-o*s)),e[15]=n*(s*f-l*d)-i*(r*f-o*d)+u*(r*l-o*s),e}function ve(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=e[4],i=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],h=e[15];return(t*i-n*a)*(d*h-f*g)-(t*s-r*a)*(u*h-f*m)+(t*l-o*a)*(u*g-d*m)+(n*s-r*i)*(c*h-f*p)-(n*l-o*i)*(c*g-d*p)+(r*l-o*s)*(c*m-u*p)}function ye(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=t[9],p=t[10],m=t[11],g=t[12],h=t[13],A=t[14],v=t[15],y=n[0],b=n[1],T=n[2],x=n[3];return e[0]=y*r+b*s+T*d+x*g,e[1]=y*o+b*l+T*f+x*h,e[2]=y*a+b*c+T*p+x*A,e[3]=y*i+b*u+T*m+x*v,y=n[4],b=n[5],T=n[6],x=n[7],e[4]=y*r+b*s+T*d+x*g,e[5]=y*o+b*l+T*f+x*h,e[6]=y*a+b*c+T*p+x*A,e[7]=y*i+b*u+T*m+x*v,y=n[8],b=n[9],T=n[10],x=n[11],e[8]=y*r+b*s+T*d+x*g,e[9]=y*o+b*l+T*f+x*h,e[10]=y*a+b*c+T*p+x*A,e[11]=y*i+b*u+T*m+x*v,y=n[12],b=n[13],T=n[14],x=n[15],e[12]=y*r+b*s+T*d+x*g,e[13]=y*o+b*l+T*f+x*h,e[14]=y*a+b*c+T*p+x*A,e[15]=y*i+b*u+T*m+x*v,e}function be(e,t,n){var r,o,a,i,s,l,c,u,d,f,p,m,g=n[0],h=n[1],A=n[2];return t===e?(e[12]=t[0]*g+t[4]*h+t[8]*A+t[12],e[13]=t[1]*g+t[5]*h+t[9]*A+t[13],e[14]=t[2]*g+t[6]*h+t[10]*A+t[14],e[15]=t[3]*g+t[7]*h+t[11]*A+t[15]):(r=t[0],o=t[1],a=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=t[9],p=t[10],m=t[11],e[0]=r,e[1]=o,e[2]=a,e[3]=i,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=f,e[10]=p,e[11]=m,e[12]=r*g+s*h+d*A+t[12],e[13]=o*g+l*h+f*A+t[13],e[14]=a*g+c*h+p*A+t[14],e[15]=i*g+u*h+m*A+t[15]),e}function Te(e,t,n){var r=n[0],o=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function xe(e,t,n,r){var o,a,i,s,l,c,u,d,f,p,m,g,h,A,v,y,b,T,x,C,M,S,w,R,P=r[0],O=r[1],I=r[2],D=Math.hypot(P,O,I);return D<E?null:(P*=D=1/D,O*=D,I*=D,o=Math.sin(n),i=1-(a=Math.cos(n)),s=t[0],l=t[1],c=t[2],u=t[3],d=t[4],f=t[5],p=t[6],m=t[7],g=t[8],h=t[9],A=t[10],v=t[11],y=P*P*i+a,b=O*P*i+I*o,T=I*P*i-O*o,x=P*O*i-I*o,C=O*O*i+a,M=I*O*i+P*o,S=P*I*i+O*o,w=O*I*i-P*o,R=I*I*i+a,e[0]=s*y+d*b+g*T,e[1]=l*y+f*b+h*T,e[2]=c*y+p*b+A*T,e[3]=u*y+m*b+v*T,e[4]=s*x+d*C+g*M,e[5]=l*x+f*C+h*M,e[6]=c*x+p*C+A*M,e[7]=u*x+m*C+v*M,e[8]=s*S+d*w+g*R,e[9]=l*S+f*w+h*R,e[10]=c*S+p*w+A*R,e[11]=u*S+m*w+v*R,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Ce(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[4],i=t[5],s=t[6],l=t[7],c=t[8],u=t[9],d=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*o+c*r,e[5]=i*o+u*r,e[6]=s*o+d*r,e[7]=l*o+f*r,e[8]=c*o-a*r,e[9]=u*o-i*r,e[10]=d*o-s*r,e[11]=f*o-l*r,e}function Ee(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[0],i=t[1],s=t[2],l=t[3],c=t[8],u=t[9],d=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*o-c*r,e[1]=i*o-u*r,e[2]=s*o-d*r,e[3]=l*o-f*r,e[8]=a*r+c*o,e[9]=i*r+u*o,e[10]=s*r+d*o,e[11]=l*r+f*o,e}function Me(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[0],i=t[1],s=t[2],l=t[3],c=t[4],u=t[5],d=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*o+c*r,e[1]=i*o+u*r,e[2]=s*o+d*r,e[3]=l*o+f*r,e[4]=c*o-a*r,e[5]=u*o-i*r,e[6]=d*o-s*r,e[7]=f*o-l*r,e}function Se(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function we(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Re(e,t,n){var r,o,a,i=n[0],s=n[1],l=n[2],c=Math.hypot(i,s,l);return c<E?null:(i*=c=1/c,s*=c,l*=c,r=Math.sin(t),a=1-(o=Math.cos(t)),e[0]=i*i*a+o,e[1]=s*i*a+l*r,e[2]=l*i*a-s*r,e[3]=0,e[4]=i*s*a-l*r,e[5]=s*s*a+o,e[6]=l*s*a+i*r,e[7]=0,e[8]=i*l*a+s*r,e[9]=s*l*a-i*r,e[10]=l*l*a+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Pe(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Oe(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ie(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function De(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],s=r+r,l=o+o,c=a+a,u=r*s,d=r*l,f=r*c,p=o*l,m=o*c,g=a*c,h=i*s,A=i*l,v=i*c;return e[0]=1-(p+g),e[1]=d+v,e[2]=f-A,e[3]=0,e[4]=d-v,e[5]=1-(u+g),e[6]=m+h,e[7]=0,e[8]=f+A,e[9]=m-h,e[10]=1-(u+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Ve(e,t){var n=new M(3),r=-t[0],o=-t[1],a=-t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=r*r+o*o+a*a+i*i;return d>0?(n[0]=2*(s*i+u*r+l*a-c*o)/d,n[1]=2*(l*i+u*o+c*r-s*a)/d,n[2]=2*(c*i+u*a+s*o-l*r)/d):(n[0]=2*(s*i+u*r+l*a-c*o),n[1]=2*(l*i+u*o+c*r-s*a),n[2]=2*(c*i+u*a+s*o-l*r)),De(e,t,n),e}function Le(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function _e(e,t){var n=t[0],r=t[1],o=t[2],a=t[4],i=t[5],s=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(n,r,o),e[1]=Math.hypot(a,i,s),e[2]=Math.hypot(l,c,u),e}function Fe(e,t){var n=new M(3);_e(n,t);var r=1/n[0],o=1/n[1],a=1/n[2],i=t[0]*r,s=t[1]*o,l=t[2]*a,c=t[4]*r,u=t[5]*o,d=t[6]*a,f=t[8]*r,p=t[9]*o,m=t[10]*a,g=i+u+m,h=0;return g>0?(h=2*Math.sqrt(g+1),e[3]=.25*h,e[0]=(d-p)/h,e[1]=(f-l)/h,e[2]=(s-c)/h):i>u&&i>m?(h=2*Math.sqrt(1+i-u-m),e[3]=(d-p)/h,e[0]=.25*h,e[1]=(s+c)/h,e[2]=(f+l)/h):u>m?(h=2*Math.sqrt(1+u-i-m),e[3]=(f-l)/h,e[0]=(s+c)/h,e[1]=.25*h,e[2]=(d+p)/h):(h=2*Math.sqrt(1+m-i-u),e[3]=(s-c)/h,e[0]=(f+l)/h,e[1]=(d+p)/h,e[2]=.25*h),e}function Ne(e,t,n,r){var o=t[0],a=t[1],i=t[2],s=t[3],l=o+o,c=a+a,u=i+i,d=o*l,f=o*c,p=o*u,m=a*c,g=a*u,h=i*u,A=s*l,v=s*c,y=s*u,b=r[0],T=r[1],x=r[2];return e[0]=(1-(m+h))*b,e[1]=(f+y)*b,e[2]=(p-v)*b,e[3]=0,e[4]=(f-y)*T,e[5]=(1-(d+h))*T,e[6]=(g+A)*T,e[7]=0,e[8]=(p+v)*x,e[9]=(g-A)*x,e[10]=(1-(d+m))*x,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Be(e,t,n,r,o){var a=t[0],i=t[1],s=t[2],l=t[3],c=a+a,u=i+i,d=s+s,f=a*c,p=a*u,m=a*d,g=i*u,h=i*d,A=s*d,v=l*c,y=l*u,b=l*d,T=r[0],x=r[1],C=r[2],E=o[0],M=o[1],S=o[2],w=(1-(g+A))*T,R=(p+b)*T,P=(m-y)*T,O=(p-b)*x,I=(1-(f+A))*x,D=(h+v)*x,V=(m+y)*C,L=(h-v)*C,_=(1-(f+g))*C;return e[0]=w,e[1]=R,e[2]=P,e[3]=0,e[4]=O,e[5]=I,e[6]=D,e[7]=0,e[8]=V,e[9]=L,e[10]=_,e[11]=0,e[12]=n[0]+E-(w*E+O*M+V*S),e[13]=n[1]+M-(R*E+I*M+L*S),e[14]=n[2]+S-(P*E+D*M+_*S),e[15]=1,e}function ke(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=n+n,s=r+r,l=o+o,c=n*i,u=r*i,d=r*s,f=o*i,p=o*s,m=o*l,g=a*i,h=a*s,A=a*l;return e[0]=1-d-m,e[1]=u+A,e[2]=f-h,e[3]=0,e[4]=u-A,e[5]=1-c-m,e[6]=p+g,e[7]=0,e[8]=f+h,e[9]=p-g,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ge(e,t,n,r,o,a,i){var s=1/(n-t),l=1/(o-r),c=1/(a-i);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*l,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(o+r)*l,e[10]=(i+a)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*a*2*c,e[15]=0,e}function Ue(e,t,n,r,o){var a,i=1/Math.tan(t/2);return e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(a=1/(r-o),e[10]=(o+r)*a,e[14]=2*o*r*a):(e[10]=-1,e[14]=-2*r),e}function We(e,t,n,r){var o=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),i=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(i+s),c=2/(o+a);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(i-s)*l*.5,e[9]=(o-a)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function ze(e,t,n,r,o,a,i){var s=1/(t-n),l=1/(r-o),c=1/(a-i);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(o+r)*l,e[14]=(i+a)*c,e[15]=1,e}function He(e,t,n,r){var o,a,i,s,l,c,u,d,f,p,m=t[0],g=t[1],h=t[2],A=r[0],v=r[1],y=r[2],b=n[0],T=n[1],x=n[2];return Math.abs(m-b)<E&&Math.abs(g-T)<E&&Math.abs(h-x)<E?me(e):(u=m-b,d=g-T,f=h-x,o=v*(f*=p=1/Math.hypot(u,d,f))-y*(d*=p),a=y*(u*=p)-A*f,i=A*d-v*u,(p=Math.hypot(o,a,i))?(o*=p=1/p,a*=p,i*=p):(o=0,a=0,i=0),s=d*i-f*a,l=f*o-u*i,c=u*a-d*o,(p=Math.hypot(s,l,c))?(s*=p=1/p,l*=p,c*=p):(s=0,l=0,c=0),e[0]=o,e[1]=s,e[2]=u,e[3]=0,e[4]=a,e[5]=l,e[6]=d,e[7]=0,e[8]=i,e[9]=c,e[10]=f,e[11]=0,e[12]=-(o*m+a*g+i*h),e[13]=-(s*m+l*g+c*h),e[14]=-(u*m+d*g+f*h),e[15]=1,e)}function je(e,t,n,r){var o=t[0],a=t[1],i=t[2],s=r[0],l=r[1],c=r[2],u=o-n[0],d=a-n[1],f=i-n[2],p=u*u+d*d+f*f;p>0&&(u*=p=1/Math.sqrt(p),d*=p,f*=p);var m=l*f-c*d,g=c*u-s*f,h=s*d-l*u;return(p=m*m+g*g+h*h)>0&&(m*=p=1/Math.sqrt(p),g*=p,h*=p),e[0]=m,e[1]=g,e[2]=h,e[3]=0,e[4]=d*h-f*g,e[5]=f*m-u*h,e[6]=u*g-d*m,e[7]=0,e[8]=u,e[9]=d,e[10]=f,e[11]=0,e[12]=o,e[13]=a,e[14]=i,e[15]=1,e}function Ke(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Xe(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Qe(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Ye(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function qe(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function Ze(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function $e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Je(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],h=e[14],A=e[15],v=t[0],y=t[1],b=t[2],T=t[3],x=t[4],C=t[5],M=t[6],S=t[7],w=t[8],R=t[9],P=t[10],O=t[11],I=t[12],D=t[13],V=t[14],L=t[15];return Math.abs(n-v)<=E*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-y)<=E*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(o-b)<=E*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-T)<=E*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(i-x)<=E*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(s-C)<=E*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(l-M)<=E*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-S)<=E*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-w)<=E*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(d-R)<=E*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(f-P)<=E*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(p-O)<=E*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(m-I)<=E*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(g-D)<=E*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(h-V)<=E*Math.max(1,Math.abs(h),Math.abs(V))&&Math.abs(A-L)<=E*Math.max(1,Math.abs(A),Math.abs(L))}var et=ye,tt=Ye;function nt(){var e=new M(3);return M!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function rt(e){var t=new M(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ot(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function at(e,t,n){var r=new M(3);return r[0]=e,r[1]=t,r[2]=n,r}function it(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function st(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function lt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function ct(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function ut(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function dt(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function ft(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function pt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function mt(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function gt(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function ht(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function At(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function vt(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function yt(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.hypot(n,r,o)}function bt(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return n*n+r*r+o*o}function Tt(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function xt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Ct(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Et(e,t){var n=t[0],r=t[1],o=t[2],a=n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function Mt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function St(e,t,n){var r=t[0],o=t[1],a=t[2],i=n[0],s=n[1],l=n[2];return e[0]=o*l-a*s,e[1]=a*i-r*l,e[2]=r*s-o*i,e}function wt(e,t,n,r){var o=t[0],a=t[1],i=t[2];return e[0]=o+r*(n[0]-o),e[1]=a+r*(n[1]-a),e[2]=i+r*(n[2]-i),e}function Rt(e,t,n,r,o,a){var i=a*a,s=i*(2*a-3)+1,l=i*(a-2)+a,c=i*(a-1),u=i*(3-2*a);return e[0]=t[0]*s+n[0]*l+r[0]*c+o[0]*u,e[1]=t[1]*s+n[1]*l+r[1]*c+o[1]*u,e[2]=t[2]*s+n[2]*l+r[2]*c+o[2]*u,e}function Pt(e,t,n,r,o,a){var i=1-a,s=i*i,l=a*a,c=s*i,u=3*a*s,d=3*l*i,f=l*a;return e[0]=t[0]*c+n[0]*u+r[0]*d+o[0]*f,e[1]=t[1]*c+n[1]*u+r[1]*d+o[1]*f,e[2]=t[2]*c+n[2]*u+r[2]*d+o[2]*f,e}function Ot(e,t){t=t||1;var n=2*S()*Math.PI,r=2*S()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e}function It(e,t,n){var r=t[0],o=t[1],a=t[2],i=n[3]*r+n[7]*o+n[11]*a+n[15];return i=i||1,e[0]=(n[0]*r+n[4]*o+n[8]*a+n[12])/i,e[1]=(n[1]*r+n[5]*o+n[9]*a+n[13])/i,e[2]=(n[2]*r+n[6]*o+n[10]*a+n[14])/i,e}function Dt(e,t,n){var r=t[0],o=t[1],a=t[2];return e[0]=r*n[0]+o*n[3]+a*n[6],e[1]=r*n[1]+o*n[4]+a*n[7],e[2]=r*n[2]+o*n[5]+a*n[8],e}function Vt(e,t,n){var r=n[0],o=n[1],a=n[2],i=n[3],s=t[0],l=t[1],c=t[2],u=o*c-a*l,d=a*s-r*c,f=r*l-o*s,p=o*f-a*d,m=a*u-r*f,g=r*d-o*u,h=2*i;return u*=h,d*=h,f*=h,p*=2,m*=2,g*=2,e[0]=s+u+p,e[1]=l+d+m,e[2]=c+f+g,e}function Lt(e,t,n,r){var o=[],a=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],a[0]=o[0],a[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),a[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function _t(e,t,n,r){var o=[],a=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],a[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),a[1]=o[1],a[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Ft(e,t,n,r){var o=[],a=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],a[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),a[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),a[2]=o[2],e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Nt(e,t){var n=e[0],r=e[1],o=e[2],a=t[0],i=t[1],s=t[2],l=Math.sqrt(n*n+r*r+o*o)*Math.sqrt(a*a+i*i+s*s),c=l&&Mt(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}function Bt(e){return e[0]=0,e[1]=0,e[2]=0,e}function kt(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Gt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ut(e,t){var n=e[0],r=e[1],o=e[2],a=t[0],i=t[1],s=t[2];return Math.abs(n-a)<=E*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-i)<=E*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(o-s)<=E*Math.max(1,Math.abs(o),Math.abs(s))}var Wt,zt=ct,Ht=ut,jt=dt,Kt=yt,Xt=bt,Qt=ot,Yt=Tt,qt=(Wt=nt(),function(e,t,n,r,o,a){var i,s;for(t||(t=3),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,i=n;i<s;i+=t)Wt[0]=e[i],Wt[1]=e[i+1],Wt[2]=e[i+2],o(Wt,Wt,a),e[i]=Wt[0],e[i+1]=Wt[1],e[i+2]=Wt[2];return e});function Zt(){var e=new M(4);return M!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function $t(e){var t=new M(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Jt(e,t,n,r){var o=new M(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o}function en(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function tn(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e}function nn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function rn(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function on(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function an(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function sn(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function ln(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function cn(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function un(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function dn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function fn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function pn(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function mn(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],a=t[3]-e[3];return Math.hypot(n,r,o,a)}function gn(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],a=t[3]-e[3];return n*n+r*r+o*o+a*a}function hn(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.hypot(t,n,r,o)}function An(e){var t=e[0],n=e[1],r=e[2],o=e[3];return t*t+n*n+r*r+o*o}function vn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function yn(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function bn(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=n*n+r*r+o*o+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=n*i,e[1]=r*i,e[2]=o*i,e[3]=a*i,e}function Tn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function xn(e,t,n,r){var o=n[0]*r[1]-n[1]*r[0],a=n[0]*r[2]-n[2]*r[0],i=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],u=t[0],d=t[1],f=t[2],p=t[3];return e[0]=d*c-f*l+p*s,e[1]=-u*c+f*i-p*a,e[2]=u*l-d*i+p*o,e[3]=-u*s+d*a-f*o,e}function Cn(e,t,n,r){var o=t[0],a=t[1],i=t[2],s=t[3];return e[0]=o+r*(n[0]-o),e[1]=a+r*(n[1]-a),e[2]=i+r*(n[2]-i),e[3]=s+r*(n[3]-s),e}function En(e,t){var n,r,o,a,i,s;t=t||1;do{i=(n=2*S()-1)*n+(r=2*S()-1)*r}while(i>=1);do{s=(o=2*S()-1)*o+(a=2*S()-1)*a}while(s>=1);var l=Math.sqrt((1-i)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*o*l,e[3]=t*a*l,e}function Mn(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3];return e[0]=n[0]*r+n[4]*o+n[8]*a+n[12]*i,e[1]=n[1]*r+n[5]*o+n[9]*a+n[13]*i,e[2]=n[2]*r+n[6]*o+n[10]*a+n[14]*i,e[3]=n[3]*r+n[7]*o+n[11]*a+n[15]*i,e}function Sn(e,t,n){var r=t[0],o=t[1],a=t[2],i=n[0],s=n[1],l=n[2],c=n[3],u=c*r+s*a-l*o,d=c*o+l*r-i*a,f=c*a+i*o-s*r,p=-i*r-s*o-l*a;return e[0]=u*c+p*-i+d*-l-f*-s,e[1]=d*c+p*-s+f*-i-u*-l,e[2]=f*c+p*-l+u*-s-d*-i,e[3]=t[3],e}function wn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Rn(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Pn(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function On(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],i=t[0],s=t[1],l=t[2],c=t[3];return Math.abs(n-i)<=E*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=E*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-l)<=E*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-c)<=E*Math.max(1,Math.abs(a),Math.abs(c))}var In=rn,Dn=on,Vn=an,Ln=mn,_n=gn,Fn=hn,Nn=An,Bn=function(){var e=Zt();return function(t,n,r,o,a,i){var s,l;for(n||(n=4),r||(r=0),l=o?Math.min(o*n+r,t.length):t.length,s=r;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,i),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();function kn(){var e=new M(4);return M!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Gn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Un(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Wn(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>E?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function zn(e,t){var n=vr(e,t);return Math.acos(2*n*n-1)}function Hn(e,t,n){var r=t[0],o=t[1],a=t[2],i=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+i*s+o*c-a*l,e[1]=o*u+i*l+a*s-r*c,e[2]=a*u+i*c+r*l-o*s,e[3]=i*u-r*s-o*l-a*c,e}function jn(e,t,n){n*=.5;var r=t[0],o=t[1],a=t[2],i=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*s,e[1]=o*l+a*s,e[2]=a*l-o*s,e[3]=i*l-r*s,e}function Kn(e,t,n){n*=.5;var r=t[0],o=t[1],a=t[2],i=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l-a*s,e[1]=o*l+i*s,e[2]=a*l+r*s,e[3]=i*l-o*s,e}function Xn(e,t,n){n*=.5;var r=t[0],o=t[1],a=t[2],i=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*s,e[1]=o*l-r*s,e[2]=a*l+i*s,e[3]=i*l-a*s,e}function Qn(e,t){var n=t[0],r=t[1],o=t[2];return e[0]=n,e[1]=r,e[2]=o,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),e}function Yn(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=Math.sqrt(n*n+r*r+o*o),s=Math.exp(a),l=i>0?s*Math.sin(i)/i:0;return e[0]=n*l,e[1]=r*l,e[2]=o*l,e[3]=s*Math.cos(i),e}function qn(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=Math.sqrt(n*n+r*r+o*o),s=i>0?Math.atan2(i,a)/i:0;return e[0]=n*s,e[1]=r*s,e[2]=o*s,e[3]=.5*Math.log(n*n+r*r+o*o+a*a),e}function Zn(e,t,n){return qn(e,t),Ar(e,e,n),Yn(e,e),e}function $n(e,t,n,r){var o,a,i,s,l,c=t[0],u=t[1],d=t[2],f=t[3],p=n[0],m=n[1],g=n[2],h=n[3];return(a=c*p+u*m+d*g+f*h)<0&&(a=-a,p=-p,m=-m,g=-g,h=-h),1-a>E?(o=Math.acos(a),i=Math.sin(o),s=Math.sin((1-r)*o)/i,l=Math.sin(r*o)/i):(s=1-r,l=r),e[0]=s*c+l*p,e[1]=s*u+l*m,e[2]=s*d+l*g,e[3]=s*f+l*h,e}function Jn(e){var t=S(),n=S(),r=S(),o=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=o*Math.sin(2*Math.PI*n),e[1]=o*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e}function er(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],i=n*n+r*r+o*o+a*a,s=i?1/i:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-o*s,e[3]=a*s,e}function tr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function nr(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var a=(o+1)%3,i=(o+2)%3;n=Math.sqrt(t[3*o+o]-t[3*a+a]-t[3*i+i]+1),e[o]=.5*n,n=.5/n,e[3]=(t[3*a+i]-t[3*i+a])*n,e[a]=(t[3*a+o]+t[3*o+a])*n,e[i]=(t[3*i+o]+t[3*o+i])*n}return e}function rr(e,t,n,r){var o=.5*Math.PI/180;t*=o,n*=o,r*=o;var a=Math.sin(t),i=Math.cos(t),s=Math.sin(n),l=Math.cos(n),c=Math.sin(r),u=Math.cos(r);return e[0]=a*l*u-i*s*c,e[1]=i*s*u+a*l*c,e[2]=i*l*c-a*s*u,e[3]=i*l*u+a*s*c,e}function or(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var ar,ir,sr,lr,cr,ur,dr=$t,fr=Jt,pr=en,mr=tn,gr=nn,hr=Hn,Ar=fn,vr=Tn,yr=Cn,br=hn,Tr=br,xr=An,Cr=xr,Er=bn,Mr=Pn,Sr=On,wr=(ar=nt(),ir=at(1,0,0),sr=at(0,1,0),function(e,t,n){var r=Mt(t,n);return r<-.999999?(St(ar,ir,t),Qt(ar)<1e-6&&St(ar,sr,t),Et(ar,ar),Un(e,ar,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(St(ar,t,n),e[0]=ar[0],e[1]=ar[1],e[2]=ar[2],e[3]=1+r,Er(e,e))}),Rr=(lr=kn(),cr=kn(),function(e,t,n,r,o,a){return $n(lr,t,o,a),$n(cr,n,r,a),$n(e,lr,cr,2*a*(1-a)),e}),Pr=(ur=I(),function(e,t,n,r){return ur[0]=n[0],ur[3]=n[1],ur[6]=n[2],ur[1]=r[0],ur[4]=r[1],ur[7]=r[2],ur[2]=-t[0],ur[5]=-t[1],ur[8]=-t[2],Er(e,nr(e,ur))});const Or=new Float64Array(16);a.identity(Or);const{vtkErrorMacro:Ir,vtkWarningMacro:Dr}=C.default;function Vr(e){return()=>Ir(`vtkMath::${e} - NOT IMPLEMENTED`)}function Lr(e=3){const t=[];for(;t.length<e;)t.push(0);return t}function _r(e){return e/180*Math.PI}function Fr(e){return 180*e/Math.PI}const{round:Nr,floor:Br,ceil:kr,min:Gr,max:Ur}=Math;Vr("ceilLog2"),Vr("factorial");function Wr(e){let t=1;for(;t<e;)t*=2;return t}function zr(e){return e===Wr(e)}Vr("gaussian");function Hr(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function jr(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Kr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Xr(e,t,n){const r=e[1]*t[2]-e[2]*t[1],o=e[2]*t[0]-e[0]*t[2],a=e[0]*t[1]-e[1]*t[0];return n[0]=r,n[1]=o,n[2]=a,n}function Qr(e,t=3){switch(t){case 1:return Math.abs(e);case 2:return Math.sqrt(e[0]*e[0]+e[1]*e[1]);case 3:return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);default:{let n=0;for(let r=0;r<t;r++)n+=e[r]*e[r];return Math.sqrt(n)}}}function Yr(e){const t=Qr(e);return 0!==t&&(e[0]/=t,e[1]/=t,e[2]/=t),t}function qr(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])+(e[2]-t[2])*(e[2]-t[2])}function Zr(...e){return 2===e.length?e[0][0]*e[1][1]-e[1][0]*e[0][1]:4===e.length?e[0]*e[3]-e[1]*e[2]:Number.NaN}function $r(e,t,n){let r,o,a,i,s,l,c,u=0;const d=Lr(n);for(r=0;r<n;r++){for(i=0,o=0;o<n;o++)(c=Math.abs(e[r][o]))>i&&(i=c);if(0===i)return Dr("Unable to factor linear system"),0;d[r]=1/i}for(o=0;o<n;o++){for(r=0;r<o;r++){for(s=e[r][o],a=0;a<r;a++)s-=e[r][a]*e[a][o];e[r][o]=s}for(i=0,r=o;r<n;r++){for(s=e[r][o],a=0;a<o;a++)s-=e[r][a]*e[a][o];e[r][o]=s,(l=d[r]*Math.abs(s))>=i&&(i=l,u=r)}if(o!==u){for(a=0;a<n;a++)l=e[u][a],e[u][a]=e[o][a],e[o][a]=l;d[u]=d[o]}if(t[o]=u,Math.abs(e[o][o])<=1e-12)return Dr("Unable to factor linear system"),0;if(o!==n-1)for(l=1/e[o][o],r=o+1;r<n;r++)e[r][o]*=l}return 1}function Jr(e,t,n,r){let o,a,i,s,l;for(i=-1,o=0;o<r;o++){if(s=t[o],l=n[s],n[s]=n[o],i>=0)for(a=i;a<=o-1;a++)l-=e[o][a]*n[a];else 0!==l&&(i=o);n[o]=l}for(o=r-1;o>=0;o--){for(l=n[o],a=o+1;a<r;a++)l-=e[o][a]*n[a];n[o]=l/e[o][o]}}function eo(e,t,n){if(2===n){const n=Lr(2),r=Zr(e[0][0],e[0][1],e[1][0],e[1][1]);return 0===r?0:(n[0]=(e[1][1]*t[0]-e[0][1]*t[1])/r,n[1]=(-e[1][0]*t[0]+e[0][0]*t[1])/r,t[0]=n[0],t[1]=n[1],1)}if(1===n)return 0===e[0][0]?0:(t[0]/=e[0][0],1);const r=Lr(n);return 0===$r(e,r,n)?0:(Jr(e,r,t,n),1)}function to(e,t){const[n,r,o]=e;let a,i,s;n>1/6&&n<=1/3?(i=1,a=(1/3-n)/(1/6),s=0):n>1/3&&n<=.5?(i=1,s=(n-1/3)/(1/6),a=0):n>.5&&n<=2/3?(s=1,i=(2/3-n)/(1/6),a=0):n>2/3&&n<=5/6?(s=1,a=(n-2/3)/(1/6),i=0):n>5/6&&n<=1?(a=1,s=(1-n)/(1/6),i=0):(a=1,i=n/(1/6),s=0),a=r*a+(1-r),i=r*i+(1-r),s=r*s+(1-r),a*=o,i*=o,s*=o,t[0]=a,t[1]=i,t[2]=s}function no(e){e[0]=1,e[1]=-1,e[2]=1,e[3]=-1,e[4]=1,e[5]=-1}function ro(e){return!(e[1]-e[0]<0)}function oo(e,t,n){n[0]=Math.min(e[0],t[0]),n[1]=Math.max(e[0],t[0]),n[2]=Math.min(e[1],t[1]),n[3]=Math.max(e[1],t[1]),n[4]=Math.min(e[2],t[2]),n[5]=Math.max(e[2],t[2])}function ao(e,t,n){return e<t?t:e>n?n:e}function io(e,t,n,r=[]){return r[0]=ao(e[0],t[0],n[0]),r[1]=ao(e[1],t[1],n[1]),r[2]=ao(e[2],t[2],n[2]),r}function so(e,t=[]){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}Vr("GetScalarTypeFittingRange"),Vr("GetAdjustedScalarRange");const{isFinite:lo,isNaN:co}=Number,uo=co;function fo(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}const{DefaultDataType:po}=x,mo=[];function go(){let e=Number.MAX_VALUE,t=-Number.MAX_VALUE,n=0,r=0;return{add(o){e>o&&(e=o),t<o&&(t=o),n++,r+=o},get:()=>({min:e,max:t,count:n,sum:r,mean:r/n}),getRange:()=>({min:e,max:t})}}function ho(e,t=0,n=1){const r=go(),o=e.length;let a=0;if(t<0&&n>1){for(let t=0;t<o;t+=n){a=0;for(let r=0;r<n;r++)a+=e[t+r]*e[t+r];a**=.5,r.add(a)}return r.getRange()}for(let a=t<0?0:t;a<o;a+=n)r.add(e[a]);return r.getRange()}function Ao(e,t=0){const n=e||[];for(;n.length<=t;)n.push(null);return n}function vo(e){return Object.prototype.toString.call(e).slice(8,-1)}const yo={computeRange:ho,createRangeHelper:go,getDataType:vo,getMaxNorm:function(e){const t=e.getNumberOfComponents();let n=0;for(let r=0;r<e.getNumberOfTuples();++r){const o=Qr(e.getTuple(r),t);o>n&&(n=o)}return n}};const bo={name:"",numberOfComponents:1,size:0,dataType:po,rangeTuple:[0,0]};function To(e,t,n={}){if(Object.assign(t,bo,n),!t.empty&&!t.values&&!t.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");t.values?Array.isArray(t.values)&&(t.values=window[t.dataType].from(t.values)):t.values=new window[t.dataType](t.size),t.values&&(t.size=t.values.length,t.dataType=vo(t.values)),C.obj(e,t),C.set(e,t,["name","numberOfComponents"]),function(e,t){function n(){t.ranges=null,e.modified()}t.classHierarchy.push("vtkDataArray"),e.getElementComponentSize=()=>t.values.BYTES_PER_ELEMENT,e.getComponent=(e,n=0)=>t.values[e*t.numberOfComponents+n],e.setComponent=(e,r,o)=>{o!==t.values[e*t.numberOfComponents+r]&&(t.values[e*t.numberOfComponents+r]=o,n())},e.getData=()=>t.values,e.getRange=(e=-1)=>{const n=e<0?t.numberOfComponents:e;let r=null;return t.ranges||(t.ranges=Ao(t.ranges,t.numberOfComponents)),r=t.ranges[n],r?(t.rangeTuple[0]=r.min,t.rangeTuple[1]=r.max,t.rangeTuple):(r=ho(t.values,e,t.numberOfComponents),t.ranges[n]=r,t.rangeTuple[0]=r.min,t.rangeTuple[1]=r.max,t.rangeTuple)},e.setRange=(e,n)=>{t.ranges||(t.ranges=Ao(t.ranges,t.numberOfComponents));const r={min:e.min,max:e.max};return t.ranges[n]=r,t.rangeTuple[0]=r.min,t.rangeTuple[1]=r.max,t.rangeTuple},e.setTuple=(e,n)=>{const r=e*t.numberOfComponents;for(let e=0;e<t.numberOfComponents;e++)t.values[r+e]=n[e]},e.getTuple=(e,n=mo)=>{const r=t.numberOfComponents||1;n.length!==r&&(n.length=r);const o=e*r;if(1===r)n[0]=t.values[o];else if(2===r)n[0]=t.values[o],n[1]=t.values[o+1];else if(3===r)n[0]=t.values[o],n[1]=t.values[o+1],n[2]=t.values[o+2];else if(4===r)n[0]=t.values[o],n[1]=t.values[o+1],n[2]=t.values[o+2],n[3]=t.values[o+3];else for(let e=0;e<r;e++)n[e]=t.values[o+e];return n},e.getTupleLocation=(e=1)=>e*t.numberOfComponents,e.getNumberOfComponents=()=>t.numberOfComponents,e.getNumberOfValues=()=>t.values.length,e.getNumberOfTuples=()=>t.values.length/t.numberOfComponents,e.getDataType=()=>t.dataType,e.newClone=()=>xo({empty:!0,name:t.name,dataType:t.dataType,numberOfComponents:t.numberOfComponents}),e.getName=()=>(t.name||(e.modified(),t.name="vtkDataArray"+e.getMTime()),t.name),e.setData=(e,r)=>{t.values=e,t.size=e.length,t.dataType=vo(e),r&&(t.numberOfComponents=r),t.size%t.numberOfComponents!=0&&(t.numberOfComponents=1),n()},e.getState=()=>{const n={...t,vtkClass:e.getClassName()};n.values=Array.from(n.values),delete n.buffer,Object.keys(n).forEach(e=>{n[e]||delete n[e]});const r={};return Object.keys(n).sort().forEach(e=>{r[e]=n[e]}),r.mtime&&delete r.mtime,r}}(e,t)}const xo=C.newInstance(To,"vtkDataArray");var Co={newInstance:xo,extend:To,...yo,...x};function Eo(e){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function So(e,t){return(So=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Po(e);if(t){var o=Po(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ro(this,n)}}function Ro(e,t){return!t||"object"!==Eo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Po(e){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&So(e,t)}(a,e);var t,n,r,o=wo(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).array=Co.newInstance({empty:!0}),t}return t=a,(n=[{key:"render",value:function(){return console.log("VtkDataArray",this.props),null}},{key:"componentDidMount",value:function(){var e=this.props,t=e.fields,n=e.registration;this.update(this.props),t[n](this.array)}},{key:"componentDidUpdate",value:function(e,t,n){this.update(this.props,e)}},{key:"componentWillUnmount",value:function(){this.props.fields.removeArray(this.array),this.array.delete(),this.array=null}},{key:"update",value:function(e,t){var n=e.name,r=e.type,o=e.values,a=e.numberOfComponents,i=C.TYPED_ARRAYS[r];this.array.setName(n);var s=!1;!r||t&&r===t.type||(s=!0),!a||t&&a===t.numberOfComponents||(s=!0),!o||!s&&t&&o===t.values||this.array.setData(i.from(o),a)}}])&&Mo(t.prototype,n),r&&Mo(t,r),a}(c.Component);function Io(e){return(Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Do(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lo(e,t){return(Lo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=No(e);if(t){var o=No(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fo(this,n)}}function Fo(e,t){return!t||"object"!==Io(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function No(e){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Oo.defaultProps={name:"scalars",type:"Float32Array",values:[],numberOfComponents:1,registration:"addArray"},Oo.propTypes={id:f.a.string,setProps:f.a.func,type:f.a.string,name:f.a.string,values:f.a.arrayOf(f.a.number),numberOfComponents:f.a.number,registration:f.a.string,children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])};var Bo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lo(e,t)}(a,e);var t,n,r,o=_o(a);function a(){return Do(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){var e=this.props,t=e.id,n=e.setProps,r=e.children,o=e.view,a=e.representation,i=e.dataset,s={fields:i.getFieldData(),dataset:i,representation:a,view:o,setProps:n},l=u.a.Children.map(r,(function(e){return u.a.cloneElement(e,s)}));return u.a.createElement("div",{id:t},l)}}])&&Vo(t.prototype,n),r&&Vo(t,r),a}(c.Component);Bo.defaultProps={},Bo.propTypes={id:f.a.string,setProps:f.a.func,children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])};function ko(e,t,n){const r=n[0]*(e[0]-t[0])+n[1]*(e[1]-t[1])+n[2]*(e[2]-t[2]);return Math.abs(r)}function Go(e,t,n,r){const o=[];jr(e,t,o);const a=Kr(n,o);r[0]=e[0]-a*n[0],r[1]=e[1]-a*n[1],r[2]=e[2]-a*n[2]}function Uo(e,t,n){const r=Kr(e,t);let o=Kr(t,t);0===o&&(o=1),n[0]=e[0]-r*t[0]/o,n[1]=e[1]-r*t[1]/o,n[2]=e[2]-r*t[2]/o}function Wo(e,t,n,r){const o=[];jr(e,t,o);const a=Kr(n,o),i=Kr(n,n);0!==i?(r[0]=e[0]-a*n[0]/i,r[1]=e[1]-a*n[1]/i,r[2]=e[2]-a*n[2]/i):(r[0]=e[0],r[1]=e[1],r[2]=e[2])}function zo(e,t,n,r){const o={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},a=[],i=[];jr(t,e,a),jr(n,e,i);const s=Kr(r,i),l=Kr(r,a);let c,u;return c=l<0?-l:l,u=s<0?1e-6*-s:1e-6*s,c<=u||(o.t=s/l,o.x[0]=e[0]+o.t*a[0],o.x[1]=e[1]+o.t*a[1],o.x[2]=e[2]+o.t*a[2],o.intersection=!0,o.betweenPoints=o.t>=0&&o.t<=1),o}function Ho(e,t,n,r){const o={intersection:!1,l0:[],l1:[],error:null},a=[];Xr(t,r,a);const i=a.map(e=>Math.abs(e));if(i[0]+i[1]+i[2]<1e-6){const r=[];return jr(e,n,r),0===Kr(t,r)?o.error="coincide":o.error="disjoint",o}let s;s=i[0]>i[1]&&i[0]>i[2]?"x":i[1]>i[2]?"y":"z";const l=[],c=-Kr(t,e),u=-Kr(r,n);switch(s){case"x":l[0]=0,l[1]=(u*t[2]-c*r[2])/a[0],l[2]=(c*r[1]-u*t[1])/a[0];break;case"y":l[0]=(c*r[2]-u*t[2])/a[1],l[1]=0,l[2]=(u*t[0]-c*r[0])/a[1];break;case"z":l[0]=(u*t[1]-c*r[1])/a[2],l[1]=(c*r[0]-u*t[0])/a[2],l[2]=0}return o.l0=l,Hr(l,a,o.l1),o.intersection=!0,o}const jo={evaluate:function(e,t,n){return e[0]*(n[0]-t[0])+e[1]*(n[1]-t[1])+e[2]*(n[2]-t[2])},distanceToPlane:ko,projectPoint:Go,projectVector:Uo,generalizedProjectPoint:Wo,intersectWithLine:zo,intersectWithPlane:Ho,DISJOINT:"disjoint",COINCIDE:"coincide"};const Ko={normal:[0,0,1],origin:[0,0,0]};function Xo(e,t,n={}){Object.assign(t,Ko,n),C.default.obj(e,t),C.default.setGetArray(e,t,["normal","origin"],3),function(e,t){t.classHierarchy.push("vtkPlane"),e.distanceToPlane=e=>ko(e,t.origin,t.normal),e.projectPoint=(e,n)=>{Go(e,t.origin,t.normal,n)},e.projectVector=(e,n)=>{Uo(e,t.normal,n)},e.push=e=>{if(0!==e)for(let n=0;n<3;n++)t.origin[n]+=e*t.normal[n]},e.generalizedProjectPoint=(e,n)=>{Wo(e,t.origin,t.normal,n)},e.evaluateFunction=(e,n,r)=>Array.isArray(e)?t.normal[0]*(e[0]-t.origin[0])+t.normal[1]*(e[1]-t.origin[1])+t.normal[2]*(e[2]-t.origin[2]):t.normal[0]*(e-t.origin[0])+t.normal[1]*(n-t.origin[1])+t.normal[2]*(r-t.origin[2]),e.evaluateGradient=e=>[t.normal[0],t.normal[1],t.normal[2]],e.intersectWithLine=(e,n)=>zo(e,n,t.origin,t.normal),e.intersectWithPlane=(e,n)=>Ho(e,n,t.origin,t.normal)}(e,t)}var Qo={newInstance:C.default.newInstance(Xo,"vtkPlane"),extend:Xo,...jo};const Yo=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function qo(e){return e[0]<=e[1]&&e[2]<=e[3]&&e[4]<=e[5]}function Zo(e){return[.5*(e[0]+e[1]),.5*(e[2]+e[3]),.5*(e[4]+e[5])]}function $o(e,t){return e[2*t+1]-e[2*t]}function Jo(e){return[$o(e,0),$o(e,1),$o(e,2)]}function ea(e){const t=Jo(e);return t[0]>t[1]?t[0]>t[2]?t[0]:t[2]:t[1]>t[2]?t[1]:t[2]}function ta(e){if(qo(e)){const t=Jo(e);return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}return null}function na(e,t){return e<=0&&t>=0||e>=0&&t<=0}function ra(e,t){let n=0;for(let r=0;r<2;r++)for(let o=2;o<4;o++)for(let a=4;a<6;a++)t[n]=[e[r],e[o],e[a]],n++}const oa={isValid:qo,getCenter:Zo,getLength:$o,getLengths:Jo,getMaxLength:ea,getDiagonalLength:ta,getXRange:function(e){return e.slice(0,2)},getYRange:function(e){return e.slice(2,4)},getZRange:function(e){return e.slice(4,6)},getCorners:ra,computeCornerPoints:function(e,t,n){e[0]=n[0],e[1]=n[2],e[2]=n[4],t[0]=n[1],t[1]=n[3],t[2]=n[5]},computeLocalBounds:function(e,t,n,r){const o=[].concat(Yo),a=e.getData();for(let e=0;e<a.length;e+=3){const i=[a[e],a[e+1],a[e+2]],s=Kr(i,t);o[0]=Math.min(s,o[0]),o[1]=Math.max(s,o[1]);const l=Kr(i,n);o[2]=Math.min(l,o[2]),o[3]=Math.max(l,o[3]);const c=Kr(i,r);o[4]=Math.min(c,o[4]),o[5]=Math.max(c,o[5])}return o},computeScale3:function(e,t=[]){const n=Zo(e);return t[0]=e[1]-n[0],t[1]=e[3]-n[1],t[2]=e[5]-n[2],t},INIT_BOUNDS:Yo};const aa={type:"vtkBoundingBox",bounds:[].concat(Yo),corners:[]};function ia(e,t,n={}){Object.assign(t,aa,n),C.default.obj(e,t),C.default.setGet(e,t,["bounds"]),function(e,t){t.classHierarchy.push("vtkBoundingBox"),e.clone=()=>{const e=[].concat(t.bounds);return sa({bounds:e})},e.equals=e=>{const n=t.bounds,r=e.getBounds();return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]&&n[4]===r[4]&&n[5]===r[5]},e.setMinPoint=(e,n,r)=>{const[o,a,i,s,l,c]=t.bounds;return t.bounds=[e,e>a?e:a,n,n>s?n:s,r,r>c?r:c],o!==e||i!==n||l!==r},e.setMaxPoint=(e,n,r)=>{const[o,a,i,s,l,c]=t.bounds;return t.bounds=[e<o?e:o,e,n<i?n:i,n,r<l?r:l,r],a!==e||s!==n||c!==r},e.addPoint=(...e)=>{t.bounds=t.bounds.map((t,n)=>{if(n%2==0){const r=n/2;return t<e[r]?t:e[r]}const r=(n-1)/2;return t>e[r]?t:e[r]})},e.addBounds=(e,n,r,o,a,i)=>{const[s,l,c,u,d,f]=t.bounds;t.bounds=void 0===i?[Math.min(e[0],s),Math.max(e[1],l),Math.min(e[2],c),Math.max(e[3],u),Math.min(e[4],d),Math.max(e[5],f)]:[Math.min(e,s),Math.max(n,l),Math.min(r,c),Math.max(o,u),Math.min(a,d),Math.max(i,f)]},e.addBox=t=>{e.addBounds(t.getBounds())},e.isValid=()=>qo(t.bounds),e.intersect=n=>{if(!e.isValid()||!n.isValid())return!1;const r=[0,0,0,0,0,0],o=n.getBounds();let a;for(let e=0;e<3;e++)if(a=!1,o[2*e]>=t.bounds[2*e]&&o[2*e]<=t.bounds[2*e+1]?(a=!0,r[2*e]=o[2*e]):t.bounds[2*e]>=o[2*e]&&t.bounds[2*e]<=o[2*e+1]&&(a=!0,r[2*e]=t.bounds[2*e]),o[2*e+1]>=t.bounds[2*e]&&o[2*e+1]<=t.bounds[2*e+1]?(a=!0,r[2*e+1]=n.MaxPnt[e]):t.bounds[2*e+1]>=n.MinPnt[2*e]&&t.bounds[2*e+1]<=n.MaxPnt[2*e+1]&&(a=!0,r[2*e+1]=t.bounds[2*e+1]),!a)return!1;return t.bounds=r,!0},e.intersects=n=>{if(!e.isValid()||!n.isValid())return!1;const r=n.getBounds();for(let e=0;e<3;e++)if(!(r[2*e]>=t.bounds[2*e]&&r[2*e]<=t.bounds[2*e+1]||t.bounds[2*e]>=r[2*e]&&t.bounds[2*e]<=r[2*e+1]||r[2*e+1]>=t.bounds[2*e]&&r[2*e+1]<=t.bounds[2*e+1]||t.bounds[2*e+1]>=n.MinPnt[2*e]&&t.bounds[2*e+1]<=n.MaxPnt[2*e+1]))return!1;return!0},e.intersectPlane=(e,n)=>{const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],o=[0,0,0,0,0,0,0,0];let a=0;for(let r=0;r<2;r++)for(let i=2;i<4;i++)for(let s=4;s<6;s++){const l=[t.bounds[r],t.bounds[i],t.bounds[s]];o[a++]=Qo.evaluate(n,e,l)}let i=2;for(;i--&&!(na(o[r[i][0]],o[r[i][4]])&&na(o[r[i][1]],o[r[i][5]])&&na(o[r[i][2]],o[r[i][6]])&&na(o[r[i][3]],o[r[i][7]])););if(i<0)return!1;const s=Math.sign(n[i]),l=Math.abs((t.bounds[2*i+1]-t.bounds[2*i])*n[i]);let c=s>0?1:0;for(let e=0;e<4;e++){if(0===l)continue;const t=Math.abs(o[r[i][e]])/l;s>0&&t<c&&(c=t),s<0&&t>c&&(c=t)}const u=(1-c)*t.bounds[2*i]+c*t.bounds[2*i+1];return s>0?t.bounds[2*i]=u:t.bounds[2*i+1]=u,!0},e.containsPoint=(e,n,r)=>!(e<t.bounds[0]||e>t.bounds[1])&&(!(n<t.bounds[2]||n>t.bounds[3])&&!(r<t.bounds[4]||r>t.bounds[5])),e.getMinPoint=()=>[t.bounds[0],t.bounds[2],t.bounds[4]],e.getMaxPoint=()=>[t.bounds[1],t.bounds[3],t.bounds[5]],e.getBound=e=>t.bound[e],e.contains=t=>!!e.intersects(t)&&(!!e.containsPoint(...t.getMinPoint())&&(!!e.containsPoint(...t.getMaxPoint())||0)),e.getCenter=()=>Zo(t.bounds),e.getLength=e=>$o(t.bounds,e),e.getLengths=()=>Jo(t.bounds),e.getMaxLength=()=>ea(t.bounds),e.getDiagonalLength=()=>ta(t.bounds),e.reset=()=>e.setBounds([].concat(Yo)),e.inflate=e=>{t.bounds=t.bounds.map((t,n)=>n%2==0?t-e:t+e)},e.getCorners=()=>(ra(t.bounds,t.corners),t.corners),e.scale=(n,r,o)=>{if(e.isValid()){const e=[].concat(t.bounds);return n>=0?(e[0]*=n,e[1]*=n):(e[0]=n*t.bounds[1],e[1]=n*t.bounds[0]),r>=0?(e[2]*=r,e[3]*=r):(e[2]=r*t.bounds[3],e[3]=r*t.bounds[2]),o>=0?(e[4]*=o,e[5]*=o):(e[4]=o*t.bounds[5],e[5]=o*t.bounds[4]),t.bounds=e,!0}return!1}}(e,t)}const sa=C.default.newInstance(ia,"vtkBoundingBox");var la={newInstance:sa,extend:ia,...oa};function ca(e){return()=>C.default.vtkErrorMacro(`vtkProp::${e} - NOT IMPLEMENTED`)}const ua={visibility:!0,pickable:!0,dragable:!0,useBounds:!0,allocatedRenderTime:10,estimatedRenderTime:0,savedEstimatedRenderTime:0,renderTimeMultiplier:1,paths:null,textures:[]};function da(e,t,n={}){Object.assign(t,ua,n),C.default.obj(e,t),C.default.get(e,t,["estimatedRenderTime","allocatedRenderTime"]),C.default.setGet(e,t,["visibility","pickable","dragable","useBounds","renderTimeMultiplier"]),function(e,t){t.classHierarchy.push("vtkProp"),e.getMTime=()=>{let e=t.mtime;for(let n=0;n<t.textures.length;++n){const r=t.textures[n].getMTime();r>e&&(e=r)}return e},e.getNestedProps=()=>null,e.getActors=()=>[],e.getActors2D=()=>[],e.getVolumes=()=>[],e.pick=ca("pick"),e.hasKey=ca("hasKey"),e.getRedrawMTime=()=>t.mtime,e.setEstimatedRenderTime=e=>{t.estimatedRenderTime=e,t.savedEstimatedRenderTime=e},e.restoreEstimatedRenderTime=()=>{t.estimatedRenderTime=t.savedEstimatedRenderTime},e.addEstimatedRenderTime=e=>{t.estimatedRenderTime+=e},e.setAllocatedRenderTime=e=>{t.allocatedRenderTime=e,t.savedEstimatedRenderTime=t.estimatedRenderTime,t.estimatedRenderTime=0},e.getSupportsSelection=()=>!1,e.getTextures=()=>t.textures,e.hasTexture=e=>-1!==t.textures.indexOf(e),e.addTexture=n=>{n&&!e.hasTexture(n)&&(t.textures=t.textures.concat(n),e.modified())},e.removeTexture=n=>{const r=t.textures.filter(e=>e!==n);t.textures.length!==r.length&&(t.textures=r,e.modified())},e.removeAllTextures=()=>{t.textures=[],e.modified()}}(e,t)}var fa={newInstance:C.default.newInstance(da,"vtkProp"),extend:da};const pa={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function ma(e,t,n={}){Object.assign(t,pa,n),fa.extend(e,t,n),t.matrixMTime={},C.default.obj(t.matrixMTime),C.default.get(e,t,["bounds","isIdentity"]),C.default.getArray(e,t,["orientation"]),C.default.setGetArray(e,t,["origin","position","scale"],3),t.matrix=a.create(),t.rotation=a.create(),t.userMatrix=a.create(),t.transform=null,function(e,t){t.classHierarchy.push("vtkProp3D"),e.addPosition=n=>{t.position=t.position.map((e,t)=>e+n[t]),e.modified()},e.getOrientationWXYZ=()=>{const e=l.create();a.getRotation(e,t.rotation);const n=i.create();return[Fr(l.getAxisAngle(n,e)),n[0],n[1],n[2]]},e.rotateX=n=>{0!==n&&(a.rotateX(t.rotation,t.rotation,_r(n)),e.modified())},e.rotateY=n=>{0!==n&&(a.rotateY(t.rotation,t.rotation,_r(n)),e.modified())},e.rotateZ=n=>{0!==n&&(a.rotateZ(t.rotation,t.rotation,_r(n)),e.modified())},e.rotateWXYZ=(n,r,o,i)=>{if(0===n||0===r&&0===o&&0===i)return;const s=_r(n),c=l.create();l.setAxisAngle(c,[r,o,i],s);const u=a.create();a.fromQuat(u,c),a.multiply(t.rotation,t.rotation,u),e.modified()},e.setOrientation=(n,r,o)=>(n!==t.orientation[0]||r!==t.orientation[1]||o!==t.orientation[2])&&(t.orientation=[n,r,o],a.identity(t.rotation),e.rotateZ(o),e.rotateX(n),e.rotateY(r),e.modified(),!0),e.setUserMatrix=n=>{a.copy(t.userMatrix,n),e.modified()},e.getMatrix=()=>(e.computeMatrix(),t.matrix),e.computeMatrix=()=>{if(e.getMTime()>t.matrixMTime.getMTime()){a.identity(t.matrix),t.userMatrix&&a.multiply(t.matrix,t.matrix,t.userMatrix),a.translate(t.matrix,t.matrix,t.origin),a.translate(t.matrix,t.matrix,t.position),a.multiply(t.matrix,t.matrix,t.rotation),a.scale(t.matrix,t.matrix,t.scale),a.translate(t.matrix,t.matrix,[-t.origin[0],-t.origin[1],-t.origin[2]]),a.transpose(t.matrix,t.matrix),t.isIdentity=!0;for(let e=0;e<4;++e)for(let n=0;n<4;++n)(e===n?1:0)!==t.matrix[e+4*n]&&(t.isIdentity=!1);t.matrixMTime.modified()}},e.getCenter=()=>la.getCenter(t.bounds),e.getLength=()=>la.getLength(t.bounds),e.getXRange=()=>la.getXRange(t.bounds),e.getYRange=()=>la.getYRange(t.bounds),e.getZRange=()=>la.getZRange(t.bounds),e.getUserMatrix=()=>t.userMatrix,e.onModified((function(){e.computeMatrix()}))}(e,t)}var ga={newInstance:C.default.newInstance(ma,"vtkProp3D"),extend:ma};const ha={FLAT:0,GOURAUD:1,PHONG:2},Aa={POINTS:0,WIREFRAME:1,SURFACE:2};var va={Shading:ha,Representation:Aa,Interpolation:ha};const{Representation:ya,Interpolation:ba}=va;function Ta(e){return()=>C.default.vtkErrorMacro(`vtkProperty::${e} - NOT IMPLEMENTED`)}const xa={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,specular:0,specularPower:1,opacity:1,interpolation:ba.GOURAUD,representation:ya.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function Ca(e,t,n={}){Object.assign(t,xa,n),C.default.obj(e,t),C.default.setGet(e,t,["lighting","interpolation","ambient","diffuse","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation"]),C.default.setGetArray(e,t,["ambientColor","specularColor","diffuseColor","edgeColor"],3),function(e,t){t.classHierarchy.push("vtkProperty"),e.setColor=(n,r,o)=>{Array.isArray(n)?t.color[0]===n[0]&&t.color[1]===n[1]&&t.color[2]===n[2]||(t.color[0]=n[0],t.color[1]=n[1],t.color[2]=n[2],e.modified()):t.color[0]===n&&t.color[1]===r&&t.color[2]===o||(t.color[0]=n,t.color[1]=r,t.color[2]=o,e.modified()),e.setDiffuseColor(t.color),e.setAmbientColor(t.color),e.setSpecularColor(t.color)},e.computeCompositeColor=Ta("ComputeCompositeColor"),e.getColor=()=>{let e=0;t.ambient+t.diffuse+t.specular>0&&(e=1/(t.ambient+t.diffuse+t.specular));for(let n=0;n<3;n++)t.color[n]=e*(t.ambient*t.ambientColor[n]+t.diffuse*t.diffuseColor[n]+t.specular*t.specularColor[n]);return[].concat(t.color)},e.addShaderVariable=Ta("AddShaderVariable"),e.setInterpolationToFlat=()=>e.setInterpolation(ba.FLAT),e.setInterpolationToGouraud=()=>e.setInterpolation(ba.GOURAUD),e.setInterpolationToPhong=()=>e.setInterpolation(ba.PHONG),e.getInterpolationAsString=()=>C.default.enumToString(ba,t.interpolation),e.setRepresentationToWireframe=()=>e.setRepresentation(ya.WIREFRAME),e.setRepresentationToSurface=()=>e.setRepresentation(ya.SURFACE),e.setRepresentationToPoints=()=>e.setRepresentation(ya.POINTS),e.getRepresentationAsString=()=>C.default.enumToString(ya,t.representation)}(e,t)}var Ea={newInstance:C.default.newInstance(Ca,"vtkProperty"),extend:Ca,...va};const{vtkDebugMacro:Ma}=C.default;const Sa={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function wa(e,t,n={}){Object.assign(t,Sa,n),ga.extend(e,t,n),t.boundsMTime={},C.default.obj(t.boundsMTime),C.default.set(e,t,["property"]),C.default.setGet(e,t,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),function(e,t){t.classHierarchy.push("vtkActor");const n={...e};e.getActors=()=>e,e.getIsOpaque=()=>{if(t.forceOpaque)return!0;if(t.forceTranslucent)return!1;t.property||e.getProperty();let n=t.property.getOpacity()>=1;return n=n&&(!t.texture||!t.texture.isTranslucent()),n=n&&(!t.mapper||t.mapper.getIsOpaque()),n},e.hasTranslucentPolygonalGeometry=()=>null!==t.mapper&&(null===t.property&&e.setProperty(e.makeProperty()),!e.getIsOpaque()),e.makeProperty=Ea.newInstance,e.getProperty=()=>(null===t.property&&(t.property=e.makeProperty()),t.property),e.getBounds=()=>{if(null===t.mapper)return t.bounds;const n=t.mapper.getBounds();if(!n||6!==n.length)return n;if(n[0]>n[1])return t.mapperBounds=n.concat(),t.bounds=[1,-1,1,-1,1,-1],t.boundsMTime.modified(),n;if(!t.mapperBounds||n[0]!==t.mapperBounds[0]||n[1]!==t.mapperBounds[1]||n[2]!==t.mapperBounds[2]||n[3]!==t.mapperBounds[3]||n[4]!==t.mapperBounds[4]||n[5]!==t.mapperBounds[5]||e.getMTime()>t.boundsMTime.getMTime()){Ma("Recomputing bounds..."),t.mapperBounds=n.concat();const r=[i.fromValues(n[1],n[3],n[5]),i.fromValues(n[1],n[2],n[5]),i.fromValues(n[0],n[2],n[5]),i.fromValues(n[0],n[3],n[5]),i.fromValues(n[1],n[3],n[4]),i.fromValues(n[1],n[2],n[4]),i.fromValues(n[0],n[2],n[4]),i.fromValues(n[0],n[3],n[4])];e.computeMatrix();const o=a.create();a.transpose(o,t.matrix),r.forEach(e=>i.transformMat4(e,e,o)),t.bounds[0]=t.bounds[2]=t.bounds[4]=Number.MAX_VALUE,t.bounds[1]=t.bounds[3]=t.bounds[5]=-Number.MAX_VALUE,t.bounds=t.bounds.map((e,t)=>t%2==0?r.reduce((e,n)=>e>n[t/2]?n[t/2]:e,e):r.reduce((e,n)=>e<n[(t-1)/2]?n[(t-1)/2]:e,e)),t.boundsMTime.modified()}return t.bounds},e.getMTime=()=>{let e=n.getMTime();if(null!==t.property){const n=t.property.getMTime();e=n>e?n:e}if(null!==t.backfaceProperty){const n=t.backfaceProperty.getMTime();e=n>e?n:e}return e},e.getRedrawMTime=()=>{let e=t.mtime;if(null!==t.mapper){let n=t.mapper.getMTime();e=n>e?n:e,null!==t.mapper.getInput()&&(t.mapper.getInputAlgorithm().update(),n=t.mapper.getInput().getMTime(),e=n>e?n:e)}return e},e.getSupportsSelection=()=>!!t.mapper&&t.mapper.getSupportsSelection()}(e,t)}var Ra={newInstance:C.default.newInstance(wa,"vtkActor"),extend:wa};const Pa={clippingPlanes:[]};var Oa={extend:function(e,t,n={}){Object.assign(t,Pa,n),C.default.obj(e,t),C.default.algo(e,t,1,0),t.clippingPlanes||(t.clippingPlanes=[]),function(e,t){e.update=()=>{e.getInputData()},e.addClippingPlane=e=>{"vtkPlane"===e.getClassName()&&t.clippingPlanes.push(e)},e.getNumberOfClippingPlanes=()=>t.clippingPlanes.length,e.removeAllClippingPlanes=()=>{t.clippingPlanes.length=0},e.removeClippingPlane=e=>{e<0||e>=6||t.clippingPlanes.splice(e,1)},e.getClippingPlanes=()=>t.clippingPlanes,e.setClippingPlanes=t=>{if(t)if(Array.isArray(t)){const n=t.length;for(let r=0;r<n&&r<6;r++)e.addClippingPlane(t[r])}else e.addClippingPlane(t)}}(e,t)}};const Ia={bounds:[1,-1,1,-1,1,-1],center:[0,0,0]};var Da={extend:function(e,t,n={}){Object.assign(t,Ia,n),Oa.extend(e,t,n),t.bounds||no(t.bounds),t.center||(t.center=[0,0,0]),function(e,t){e.getBounds=()=>0,e.getBounds=n=>{e.getBounds();for(let e=0;e<6;e++)n[e]=t.bounds[e]},e.getCenter=()=>{e.getBounds();for(let e=0;e<3;e++)t.center[e]=(t.bounds[2*e+1]+t.bounds[2*e])/2;return t.center.slice()},e.getLength=()=>{let n=0,r=0;e.getBounds();for(let e=0;e<3;e++)n=t.bounds[2*e+1]-t.bounds[2*e],r+=n*n;return Math.sqrt(r)},e.getClippingPlaneInDataCoords=(e,n,r)=>{const o=t.clippingPlanes,a=e;if(o){const e=o.length;if(n>=0&&n<e){const e=o[n],t=e.getNormal(),i=e.getOrigin(),s=t[0],l=t[1],c=t[2],u=-(s*i[0]+l*i[1]+c*i[2]);return r[0]=s*a[0]+l*a[4]+c*a[8]+u*a[12],r[1]=s*a[1]+l*a[5]+c*a[9]+u*a[13],r[2]=s*a[2]+l*a[6]+c*a[10]+u*a[14],void(r[3]=s*a[3]+l*a[7]+c*a[11]+u*a[15])}}C.default.vtkErrorMacro(`Clipping plane index ${n} is out of range.`)}}(e,t)}},Va=n(3);const La={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function _a(e,t,n={}){Object.assign(t,La,n),C.default.obj(e,t),function(e,t){t.classHierarchy.push("vtkFieldData");const n=e.getState;t.arrays&&(t.arrays=t.arrays.map(e=>({data:Object(Va.a)(e.data)}))),e.initialize=()=>{e.initializeFields(),e.copyAllOn(),e.clearFieldFlags()},e.initializeFields=()=>{t.arrays=[],t.copyFieldFlags={},e.modified()},e.copyStructure=n=>{e.initializeFields(),t.copyFieldFlags=n.getCopyFieldFlags().map(e=>e),t.arrays=n.arrays().map(e=>({array:e}))},e.getNumberOfArrays=()=>t.arrays.length,e.getNumberOfActiveArrays=()=>t.arrays.length,e.addArray=e=>(t.arrays=[].concat(t.arrays,{data:e}),t.arrays.length-1),e.removeAllArrays=()=>{t.arrays=[]},e.removeArray=e=>{t.arrays=t.arrays.filter(t=>e!==t.data.getName())},e.removeArrayByIndex=e=>{t.arrays=t.arrays.filter((t,n)=>n!==e)},e.getArrays=()=>t.arrays.map(e=>e.data),e.getArray=t=>"number"==typeof t?e.getArrayByIndex(t):e.getArrayByName(t),e.getArrayByName=e=>t.arrays.reduce((t,n,r)=>n.data.getName()===e?n.data:t,null),e.getArrayWithIndex=e=>t.arrays.reduce((t,n,r)=>n.data&&n.data.getName()===e?{array:n.data,index:r}:t,{array:null,index:-1}),e.getArrayByIndex=e=>e>=0&&e<t.arrays.length?t.arrays[e].data:null,e.hasArray=t=>e.getArrayWithIndex(t).index>=0,e.getArrayName=e=>{const n=t.arrays[e];return n?n.data.getName():""},e.getCopyFieldFlags=()=>t.copyFieldFlags,e.getFlag=e=>t.copyFieldFlags[e],e.passData=(n,r=-1,o=-1)=>{n.getArrays().forEach(n=>{const a=e.getFlag(n.getName());if(!1!==a&&(!t.doCopyAllOff||!0===a)&&n){let t=e.getArrayByName(n.getName());if(t){if(n.getNumberOfComponents()===t.getNumberOfComponents())if(r>-1&&r<n.getNumberOfTuples()){const e=o>-1?o:r;t.setTuple(e,n.getTuple(r))}else for(let e=0;e<n.getNumberOfTuples();++e)t.setTuple(e,n.getTuple(e))}else if(r<0||r>n.getNumberOfTuples())e.addArray(n);else{const a=n.getNumberOfComponents();let i=n.getNumberOfValues();const s=o>-1?o:r;i<s*a&&(i=(s+1)*a),t=Co.newInstance({name:n.getName(),dataType:n.getDataType(),numberOfComponents:n.getNumberOfComponents(),size:i}),t.setTuple(s,n.getTuple(r)),e.addArray(t)}}})},e.copyFieldOn=e=>{t.copyFieldFlags[e]=!0},e.copyFieldOff=e=>{t.copyFieldFlags[e]=!1},e.copyAllOn=()=>{t.doCopyAllOn&&!t.doCopyAllOff||(t.doCopyAllOn=!0,t.doCopyAllOff=!1,e.modified())},e.copyAllOff=()=>{!t.doCopyAllOn&&t.doCopyAllOff||(t.doCopyAllOn=!1,t.doCopyAllOff=!0,e.modified())},e.clearFieldFlags=()=>{t.copyFieldFlags={}},e.deepCopy=e=>{t.arrays=e.getArrays().map(e=>{const t=e.newClone();return t.deepCopy(e),{data:t}})},e.copyFlags=e=>e.getCopyFieldFlags().map(e=>e),e.reset=()=>t.arrays.forEach(e=>e.data.reset()),e.getMTime=()=>t.arrays.reduce((e,t)=>t.data.getMTime()>e?t.data.getMTime():e,t.mtime),e.getNumberOfComponents=()=>t.arrays.reduce((e,t)=>e+t.data.getNumberOfComponents(),0),e.getNumberOfTuples=()=>t.arrays.length>0?t.arrays[0].getNumberOfTuples():0,e.getState=()=>{const e=n();return e.arrays=t.arrays.map(e=>({data:e.data.getState()})),e}}(e,t)}var Fa={newInstance:C.default.newInstance(_a,"vtkFieldData"),extend:_a};var Na={AttributeCopyOperations:{COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},AttributeLimitTypes:{MAX:0,EXACT:1,NOLIMIT:2},AttributeTypes:{SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},CellGhostTypes:{DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},DesiredOutputPrecision:{DEFAULT:0,SINGLE:1,DOUBLE:2},PointGhostTypes:{DUPLICATEPOINT:1,HIDDENPOINT:2},ghostArrayName:"vtkGhostType"};const{AttributeTypes:Ba,AttributeCopyOperations:ka}=Na,{vtkWarningMacro:Ga}=C.default;const Ua={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Wa(e,t,n={}){Object.assign(t,Ua,n),Fa.extend(e,t,n),C.default.setGet(e,t,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),t.arrays||(t.arrays={}),function(e,t){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(e){let t=n.find(t=>Ba[t.toUpperCase()]===e||"number"!=typeof e&&t.toLowerCase()===e.toLowerCase());return void 0===t&&(t=null),t}t.classHierarchy.push("vtkDataSetAttributes"),e.checkNumberOfComponents=e=>!0,e.setAttribute=(n,o)=>{const a=r(o);if(n&&"PEDIGREEIDS"===a.toUpperCase()&&!n.isA("vtkDataArray"))return Ga(`Cannot set attribute ${a}. The attribute must be a vtkDataArray.`),-1;if(n&&!e.checkNumberOfComponents(n,a))return Ga(`Cannot set attribute ${a}. Incorrect number of components.`),-1;let i=t["active"+a];if(i>=0&&i<t.arrays.length){if(t.arrays[i]===n)return i;e.removeArrayByIndex(i)}return n?(i=e.addArray(n),t["active"+a]=i):t["active"+a]=-1,e.modified(),t["active"+a]},e.setActiveAttributeByName=(t,n)=>e.setActiveAttributeByIndex(e.getArrayWithIndex(t).index,n),e.setActiveAttributeByIndex=(n,o)=>{const a=r(o);if(n>=0&&n<t.arrays.length){if("PEDIGREEIDS"!==a.toUpperCase()){const t=e.getArrayByIndex(n);if(!t.isA("vtkDataArray"))return Ga(`Cannot set attribute ${a}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!e.checkNumberOfComponents(t,a))return Ga(`Cannot set attribute ${a}. Incorrect number of components.`),-1}return t["active"+a]=n,e.modified(),n}return-1===n&&(t["active"+a]=n,e.modified()),-1},e.getActiveAttribute=t=>{const n=r(t);return e["get"+n]()},e.removeAllArrays=()=>{t.arrays=[],n.forEach(e=>{t["active"+e]=-1})},e.removeArray=e=>{t.arrays=t.arrays.filter((r,o)=>e!==r.data.getName()||(n.forEach(e=>{o===t["active"+e]&&(t["active"+e]=-1)}),!1))},e.removeArrayByIndex=e=>{t.arrays=t.arrays.filter((t,n)=>n!==e),n.forEach(n=>{e===t["active"+n]&&(t["active"+n]=-1)})},n.forEach(n=>{const r="active"+n;e["get"+n]=()=>e.getArrayByIndex(t[r]),e["set"+n]=t=>e.setAttribute(t,n),e["setActive"+n]=t=>e.setActiveAttributeByIndex(e.getArrayWithIndex(t).index,n),e[`copy${n}Off`]=()=>{const e=n.toUpperCase();t.copyAttributeFlags[ka.PASSDATA][Ba[e]]=!1}}),e.initializeAttributeCopyFlags=()=>{t.copyAttributeFlags=[],Object.keys(ka).filter(e=>"ALLCOPY"!==e).forEach(e=>{t.copyAttributeFlags[ka[e]]=Object.keys(Ba).filter(e=>"NUM_ATTRIBUTES"!==e).reduce((e,t)=>(e[Ba[t]]=!0,e),[])}),t.copyAttributeFlags[ka.COPYTUPLE][Ba.GLOBALIDS]=!1,t.copyAttributeFlags[ka.INTERPOLATE][Ba.GLOBALIDS]=!1,t.copyAttributeFlags[ka.COPYTUPLE][Ba.PEDIGREEIDS]=!1},e.initialize=C.default.chain(e.initialize,e.initializeAttributeCopyFlags),t.dataArrays&&Object.keys(t.dataArrays).length&&Object.keys(t.dataArrays).forEach(n=>{t.dataArrays[n].ref||"vtkDataArray"!==t.dataArrays[n].type||e.addArray(Co.newInstance(t.dataArrays[n]))});const o=e.shallowCopy;e.shallowCopy=(e,n)=>{o(e,n),t.arrays=e.getArrays().map(e=>{const t=e.newClone();return t.shallowCopy(e,n),{data:t}})},e.initializeAttributeCopyFlags()}(e,t)}var za={newInstance:C.default.newInstance(Wa,"vtkDataSetAttributes"),extend:Wa,...Na};var Ha={FieldDataTypes:{UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},FieldAssociations:{FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7}};const ja=["pointData","cellData","fieldData"];const Ka={};function Xa(e,t,n={}){Object.assign(t,Ka,n),C.default.obj(e,t),C.default.setGet(e,t,ja),function(e,t){t.classHierarchy.push("vtkDataSet"),ja.forEach(e=>{t[e]?t[e]=Object(Va.a)(t[e]):t[e]=za.newInstance()});const n=e.shallowCopy;e.shallowCopy=(e,r=!1)=>{n(e,r),ja.forEach(n=>{t[n]=za.newInstance(),t[n].shallowCopy(e.getReferenceByName(n))})}}(e,t)}var Qa={newInstance:C.default.newInstance(Xa,"vtkDataSet"),extend:Xa,...Ha};const Ya={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var qa={StructuredType:Ya};const{StructuredType:Za}=qa;var $a={getDataDescriptionFromExtent:function(e){let t=0;for(let n=0;n<3;++n)e[2*n]<e[2*n+1]&&t++;return e[0]>e[1]||e[2]>e[3]||e[4]>e[5]?Za.EMPTY:3===t?Za.XYZ_GRID:2===t?e[0]===e[1]?Za.YZ_PLANE:e[2]===e[3]?Za.XZ_PLANE:Za.XY_PLANE:1===t?e[0]<e[1]?Za.X_LINE:e[2]<e[3]?Za.Y_LINE:Za.Z_LINE:Za.SINGLE_POINT},...qa};const{vtkErrorMacro:Ja}=C.default;const ei={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Ya.EMPTY};function ti(e,t,n={}){if(Object.assign(t,ei,n),Qa.extend(e,t,n),t.direction){if(Array.isArray(t.direction)){const e=t.direction.slice(0);t.direction=o.create();for(let n=0;n<9;++n)t.direction[n]=e[n]}}else t.direction=o.create();t.indexToWorld=new Float64Array(16),t.worldToIndex=new Float64Array(16),C.default.get(e,t,["direction","indexToWorld","worldToIndex"]),C.default.setGetArray(e,t,["origin","spacing"],3),C.default.getArray(e,t,["extent"],6),function(e,t){t.classHierarchy.push("vtkImageData"),e.setExtent=(...n)=>{if(t.deleted)return Ja("instance deleted - cannot call any method"),!1;const r=1===n.length?n[0]:n;if(6!==r.length)return!1;let o=!1;return t.extent.forEach((e,t)=>{if(e!==r[t]){if(o)return;o=!0}}),o&&(t.extent=r.slice(),t.dataDescription=$a.getDataDescriptionFromExtent(t.extent),e.modified()),o},e.setDimensions=(...n)=>{let r,o,a;if(t.deleted)Ja("instance deleted - cannot call any method");else{if(1===n.length){const e=n[0];r=e[0],o=e[1],a=e[2]}else{if(3!==n.length)return void Ja("Bad dimension specification");r=n[0],o=n[1],a=n[2]}e.setExtent(0,r-1,0,o-1,0,a-1)}},e.getDimensions=()=>[t.extent[1]-t.extent[0]+1,t.extent[3]-t.extent[2]+1,t.extent[5]-t.extent[4]+1],e.getNumberOfCells=()=>{const t=e.getDimensions();let n=1;for(let e=0;e<3;e++){if(0===t[e])return 0;t[e]>1&&(n*=t[e]-1)}return n},e.getNumberOfPoints=()=>{const t=e.getDimensions();return t[0]*t[1]*t[2]},e.getPoint=n=>{const r=e.getDimensions(),o=i.fromValues(0,0,0),a=[0,0,0];if(0===r[0]||0===r[1]||0===r[2])return Ja("Requesting a point from an empty image."),null;switch(t.dataDescription){case Ya.EMPTY:return null;case Ya.SINGLE_POINT:break;case Ya.X_LINE:o[0]=n;break;case Ya.Y_LINE:o[1]=n;break;case Ya.Z_LINE:o[2]=n;break;case Ya.XY_PLANE:o[0]=n%r[0],o[1]=n/r[0];break;case Ya.YZ_PLANE:o[1]=n%r[1],o[2]=n/r[1];break;case Ya.XZ_PLANE:o[0]=n%r[0],o[2]=n/r[0];break;case Ya.XYZ_GRID:o[0]=n%r[0],o[1]=n/r[0]%r[1],o[2]=n/(r[0]*r[1]);break;default:Ja("Invalid dataDescription")}const s=i.create();return e.indexToWorldVec3(o,s),i.copy(a,s),a},e.getBounds=()=>e.extentToBounds(t.extent),e.extentToBounds=t=>{const n=[t[0],t[2],t[4],t[1],t[2],t[4],t[0],t[3],t[4],t[1],t[3],t[4],t[0],t[2],t[5],t[1],t[2],t[5],t[0],t[3],t[5],t[1],t[3],t[5]],r=i.fromValues(n[0],n[1],n[2]),o=i.create();e.indexToWorldVec3(r,o);const a=[o[0],o[0],o[1],o[1],o[2],o[2]];for(let t=3;t<24;t+=3)i.set(r,n[t],n[t+1],n[t+2]),e.indexToWorldVec3(r,o),o[0]<a[0]&&(a[0]=o[0]),o[1]<a[2]&&(a[2]=o[1]),o[2]<a[4]&&(a[4]=o[2]),o[0]>a[1]&&(a[1]=o[0]),o[1]>a[3]&&(a[3]=o[1]),o[2]>a[5]&&(a[5]=o[2]);return a},e.computeTransforms=()=>{const e=i.fromValues(t.origin[0],t.origin[1],t.origin[2]);a.fromTranslation(t.indexToWorld,e),t.indexToWorld[0]=t.direction[0],t.indexToWorld[1]=t.direction[1],t.indexToWorld[2]=t.direction[2],t.indexToWorld[4]=t.direction[3],t.indexToWorld[5]=t.direction[4],t.indexToWorld[6]=t.direction[5],t.indexToWorld[8]=t.direction[6],t.indexToWorld[9]=t.direction[7],t.indexToWorld[10]=t.direction[8];const n=i.fromValues(t.spacing[0],t.spacing[1],t.spacing[2]);a.scale(t.indexToWorld,t.indexToWorld,n),a.invert(t.worldToIndex,t.indexToWorld)},e.setDirection=(...n)=>{if(t.deleted)return Ja("instance deleted - cannot call any method"),!1;let r=n;if(1!==r.length||!Array.isArray(r[0])&&r[0].constructor!==Float32Array&&r[0].constructor!==Float64Array||(r=r[0]),9!==r.length)throw new RangeError("Invalid number of values for array setter");let o=!1;if(t.direction.forEach((e,t)=>{if(e!==r[t]){if(o)return;o=!0}}),o){for(let e=0;e<9;++e)t.direction[e]=r[e];e.modified()}return!0},e.indexToWorldVec3=(e,n)=>(i.transformMat4(n,e,t.indexToWorld),n),e.indexToWorld=(e,n=[])=>{const r=i.fromValues(e[0],e[1],e[2]),o=i.create();return i.transformMat4(o,r,t.indexToWorld),i.copy(n,o),n},e.worldToIndexVec3=(e,n)=>(i.transformMat4(n,e,t.worldToIndex),n),e.worldToIndex=(e,n=[])=>{const r=i.fromValues(e[0],e[1],e[2]),o=i.create();return i.transformMat4(o,r,t.worldToIndex),i.copy(n,o),n},e.indexToWorldBounds=(e,n=[])=>{const r=[0,0,0],o=[0,0,0];la.computeCornerPoints(r,o,e);const a=[0,0,0],s=[0,0,0];return i.transformMat4(a,r,t.indexToWorld),i.transformMat4(s,o,t.indexToWorld),oo(a,s,n),n},e.worldToIndexBounds=(e,n=[])=>{const r=[0,0,0],o=[0,0,0];la.computeCornerPoints(r,o,e);const a=[0,0,0],s=[0,0,0];return i.transformMat4(a,r,t.worldToIndex),i.transformMat4(s,o,t.worldToIndex),oo(a,s,n),n},e.onModified(e.computeTransforms),e.computeTransforms(),e.getCenter=()=>{const t=e.getBounds(),n=[];for(let e=0;e<3;e++)n[e]=(t[2*e+1]+t[2*e])/2;return n},e.computeHistogram=(t,n=null)=>{const r=[0,0,0,0,0,0];e.worldToIndexBounds(t,r);const o=[0,0,0],a=[0,0,0];la.computeCornerPoints(o,a,r),so(o,o),so(a,a);const i=e.getDimensions();io(o,[0,0,0],[i[0]-1,i[1]-1,i[2]-1],o),io(a,[0,0,0],[i[0]-1,i[1]-1,i[2]-1],a);const s=i[0],l=i[0]*i[1],c=e.getPointData().getScalars().getData();let u=-1/0,d=1/0,f=0,p=0,m=0;for(let e=o[2];e<=a[2];e++)for(let t=o[1];t<=a[1];t++){let i=o[0]+t*s+e*l;for(let s=o[0];s<=a[0];s++){if(!n||n([s,t,e],r)){const e=c[i];e>u&&(u=e),e<d&&(d=e),f+=e*e,p+=e,m+=1}++i}}const g=m>0?p/m:0,h=f-g*g;return{minimum:d,maximum:u,average:g,variance:h,sigma:Math.sqrt(h)}},e.computeIncrements=(e,t=1)=>{const n=[];let r=t;for(let t=0;t<3;++t)n[t]=r,r*=e[2*t+1]-e[2*t]+1;return n},e.computeOffsetIndex=([t,n,r])=>{const o=e.getExtent(),a=e.getPointData().getScalars().getNumberOfComponents(),i=e.computeIncrements(o,a);return Math.floor((Math.round(t)-o[0])*i[0]+(Math.round(n)-o[2])*i[1]+(Math.round(r)-o[4])*i[2])},e.getOffsetIndexFromWorld=t=>{const n=e.getExtent(),r=e.worldToIndex(t);for(let e=0;e<3;++e)if(r[e]<n[2*e]||r[e]>n[2*e+1])return Ja(`GetScalarPointer: Pixel ${r} is not in memory. Current extent = ${n}`),NaN;return e.computeOffsetIndex(r)},e.getScalarValueFromWorld=(t,n=0)=>{const r=e.getPointData().getScalars().getNumberOfComponents();if(n<0||n>=r)return Ja(`GetScalarPointer: Scalar Component ${n} is not within bounds. Current Scalar numberOfComponents: ${r}`),NaN;const o=e.getOffsetIndexFromWorld(t);return Number.isNaN(o)?o:e.getPointData().getScalars().getComponent(o,n)}}(e,t)}var ni={newInstance:C.default.newInstance(ti,"vtkImageData"),extend:ti};const ri={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4};var oi={VectorMode:{MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},ScalarMappingTarget:ri};var ai={ColorMode:{DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},GetArray:{BY_ID:0,BY_NAME:1},ScalarMode:{DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5}};const{ScalarMappingTarget:ii,VectorMode:si}=oi,{VtkDataTypes:li}=Co,{ColorMode:ci}=ai,{vtkErrorMacro:ui}=C.default;function di(e){return e}function fi(e){return Math.floor(255*e+.5)}const pi={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:si.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function mi(e,t,n={}){Object.assign(t,pi,n),C.default.obj(e,t),t.mappingRange=[0,255],t.annotationArray=[],t.annotatedValueMap=[],C.default.setGet(e,t,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),C.default.setArray(e,t,["mappingRange"],2),C.default.getArray(e,t,["mappingRange"]),function(e,t){t.classHierarchy.push("vtkScalarsToColors"),e.setVectorModeToMagnitude=()=>e.setVectorMode(si.MAGNITUDE),e.setVectorModeToComponent=()=>e.setVectorMode(si.COMPONENT),e.setVectorModeToRGBColors=()=>e.setVectorMode(si.RGBCOLORS),e.build=()=>{},e.isOpaque=()=>!0,e.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r))if(n&&r&&n.length!==r.length)ui("Values and annotations do not have the same number of tuples so ignoring");else{if(t.annotationArray=[],r&&n){const e=r.length;for(let o=0;o<e;o++)t.annotationArray.push({value:n[o],annotation:String(r[o])})}e.updateAnnotatedValueMap(),e.modified()}},e.setAnnotation=(n,r)=>{let o=e.checkForAnnotatedValue(n),a=!1;return o>=0?t.annotationArray[o].annotation!==r&&(t.annotationArray[o].annotation=r,a=!0):(t.annotationArray.push({value:n,annotation:r}),o=t.annotationArray.length-1,a=!0),a&&(e.updateAnnotatedValueMap(),e.modified()),o},e.getNumberOfAnnotatedValues=()=>t.annotationArray.length,e.getAnnotatedValue=e=>e<0||e>=t.annotationArray.length?null:t.annotationArray[e].value,e.getAnnotation=e=>void 0===t.annotationArray[e]?null:t.annotationArray[e].annotation,e.getAnnotatedValueIndex=n=>t.annotationArray.length?e.checkForAnnotatedValue(n):-1,e.removeAnnotation=n=>{const r=e.checkForAnnotatedValue(n),o=r>=0;return o&&(t.annotationArray.splice(r,1),e.updateAnnotatedValueMap(),e.modified()),o},e.resetAnnotations=()=>{t.annotationArray=[],t.annotatedValueMap=[],e.modified()},e.getAnnotationColor=(n,r)=>{if(t.indexedLookup){const t=e.getAnnotatedValueIndex(n);e.getIndexedColor(t,r)}else e.getColor(parseFloat(n),r),r[3]=1},e.checkForAnnotatedValue=t=>e.getAnnotatedValueIndexInternal(t),e.getAnnotatedValueIndexInternal=e=>{if(void 0!==t.annotatedValueMap[e]){const n=t.annotationArray.length;return t.annotatedValueMap[e]%n}return-1},e.getIndexedColor=(e,t)=>{t[0]=0,t[1]=0,t[2]=0,t[3]=0},e.updateAnnotatedValueMap=()=>{t.annotatedValueMap=[];const e=t.annotationArray.length;for(let n=0;n<e;n++)t.annotatedValueMap[t.annotationArray[n].value]=n},e.mapScalars=(t,n,r)=>{const o=t.getNumberOfComponents();let a=null;if(n===ci.DEFAULT&&t.getDataType()===li.UNSIGNED_CHAR||n===ci.DIRECT_SCALARS&&t)a=e.convertToRGBA(t,o,t.getNumberOfTuples());else{const n={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:li.UNSIGNED_CHAR},i=new window[n.dataType](4*t.getNumberOfTuples());n.values=i,n.size=i.length,a=Co.newInstance(n);let s=r;s<0&&o>1?e.mapVectorsThroughTable(t,a,ii.RGBA,-1,-1):(s<0&&(s=0),s>=o&&(s=o-1),e.mapScalarsThroughTable(t,a,ii.RGBA,s))}return a},e.mapVectorsToMagnitude=(e,t,n)=>{const r=e.getNumberOfTuples(),o=e.getNumberOfComponents(),a=t.getData(),i=e.getData();for(let e=0;e<r;e++){let t=0;for(let r=0;r<n;r++)t+=i[e*o+r]*i[e*o+r];a[e]=Math.sqrt(t)}},e.mapVectorsThroughTable=(t,n,r,o,a)=>{let i=e.getVectorMode(),s=a,l=o;const c=t.getNumberOfComponents();i===si.COMPONENT?(-1===l&&(l=e.getVectorComponent()),l<0&&(l=0),l>=c&&(l=c-1)):(-1===s&&(s=e.getVectorSize()),s<=0?(l=0,s=c):(l<0&&(l=0),l>=c&&(l=c-1),l+s>c&&(s=c-l)),i!==si.MAGNITUDE||1!==c&&1!==s||(i=si.COMPONENT));let u=0;switch(l>0&&(u=l),i){case si.COMPONENT:e.mapScalarsThroughTable(t,n,r,u);break;default:case si.MAGNITUDE:{const o=Co.newInstance({numberOfComponents:1,values:new Float32Array(t.getNumberOfTuples())});e.mapVectorsToMagnitude(t,o,s),e.mapScalarsThroughTable(o,n,r,0);break}case si.RGBCOLORS:}},e.luminanceToRGBA=(e,t,n,r)=>{const o=r(n),a=t.getData(),i=e.getData(),s=a.length;let l=0;for(let e=0;e<s;e+=1){const t=r(a[e]);i[4*l]=t,i[4*l+1]=t,i[4*l+2]=t,i[4*l+3]=o,l++}},e.luminanceAlphaToRGBA=(e,t,n,r)=>{const o=t.getData(),a=e.getData(),i=o.length;let s=0;for(let e=0;e<i;e+=2){const t=r(o[e]);a[s]=t,a[s+1]=t,a[s+2]=t,a[s+3]=r(o[e+1])*n,s+=4}},e.rGBToRGBA=(e,t,n,r)=>{const o=fi(n),a=t.getData(),i=e.getData(),s=a.length;let l=0;for(let e=0;e<s;e+=3)i[4*l]=r(a[e]),i[4*l+1]=r(a[e+1]),i[4*l+2]=r(a[e+2]),i[4*l+3]=o,l++},e.rGBAToRGBA=(e,t,n,r)=>{const o=t.getData(),a=e.getData(),i=o.length;let s=0;for(let e=0;e<i;e+=4)a[4*s]=r(o[e]),a[4*s+1]=r(o[e+1]),a[4*s+2]=r(o[e+2]),a[4*s+3]=r(o[e+3])*n,s++},e.convertToRGBA=(n,r,o)=>{let{alpha:a}=t;if(4===r&&a>=1&&n.getDataType()===li.UNSIGNED_CHAR)return n;const i=Co.newInstance({numberOfComponents:4,empty:!0,size:4*o,dataType:li.UNSIGNED_CHAR});if(o<=0)return i;a=a>0?a:0,a=a<1?a:1;let s=di;switch(n.getDataType()!==li.FLOAT&&n.getDataType()!==li.DOUBLE||(s=fi),r){case 1:e.luminanceToRGBA(i,n,a,s);break;case 2:e.luminanceAlphaToRGBA(i,n,s);break;case 3:e.rGBToRGBA(i,n,a,s);break;case 4:e.rGBAToRGBA(i,n,a,s);break;default:return ui("Cannot convert colors"),null}return i},e.usingLogScale=()=>!1,e.getNumberOfAvailableColors=()=>16777216,e.setRange=(t,n)=>e.setMappingRange(t,n),e.getRange=(t,n)=>e.getMappingRange()}(e,t)}var gi={newInstance:C.default.newInstance(mi,"vtkScalarsToColors"),extend:mi,...oi};const{vtkErrorMacro:hi}=C.default;const Ai={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function vi(e,t,n={}){Object.assign(t,Ai,n),gi.extend(e,t,n),t.table||(t.table=[]),t.buildTime={},C.default.obj(t.buildTime),t.opaqueFlagBuildTime={},C.default.obj(t.opaqueFlagBuildTime,{mtime:0}),t.insertTime={},C.default.obj(t.insertTime,{mtime:0}),C.default.get(e,t,["buildTime"]),C.default.setGet(e,t,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),C.default.setArray(e,t,["alphaRange","hueRange","saturationRange","valueRange"],2),C.default.setArray(e,t,["nanColor","belowRangeColor","aboveRangeColor"],4),C.default.getArray(e,t,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),function(e,t){t.classHierarchy.push("vtkLookupTable"),e.isOpaque=()=>{if(t.opaqueFlagBuildTime.getMTime()<e.getMTime()){let e=!0;t.nanColor[3]<1&&(e=0),t.useBelowRangeColor&&t.belowRangeColor[3]<1&&(e=0),t.useAboveRangeColor&&t.aboveRangeColor[3]<1&&(e=0);for(let n=3;n<t.table.length&&e;n+=4)t.table[n]<255&&(e=!1);t.opaqueFlag=e,t.opaqueFlagBuildTime.modified()}return t.opaqueFlag},e.usingLogScale=()=>!1,e.getNumberOfAvailableColors=()=>t.table.length,e.linearIndexLookup=(e,t)=>{let n=0;return e<t.range[0]?n=t.maxIndex+0+1.5:e>t.range[1]?n=t.maxIndex+1+1.5:(n=(e+t.shift)*t.scale,n=n<t.maxIndex?n:t.maxIndex),Math.floor(n)},e.linearLookup=(t,n,r)=>{let o=0;o=uo(t)?Math.floor(r.maxIndex+1.5+2):e.linearIndexLookup(t,r);const a=4*o;return[n[a],n[a+1],n[a+2],n[a+3]]},e.indexedLookupFunction=(n,r,o)=>{let a=e.getAnnotatedValueIndexInternal(n);-1===a&&(a=t.numberOfColors+2);const i=4*a;return[r[i],r[i+1],r[i+2],r[i+3]]},e.lookupShiftAndScale=(e,t)=>{t.shift=-e[0],t.scale=Number.MAX_VALUE,e[1]>e[0]&&(t.scale=(t.maxIndex+1)/(e[1]-e[0]))},e.mapScalarsThroughTable=(n,r,o,a)=>{let i=e.linearLookup;t.indexedLookup&&(i=e.indexedLookupFunction);const s=e.getMappingRange(),l={maxIndex:e.getNumberOfColors()-1,range:s,shift:0,scale:0};e.lookupShiftAndScale(s,l);const c=e.getAlpha(),u=n.getNumberOfTuples(),d=n.getNumberOfComponents(),f=r.getData(),p=n.getData();if(c>=1){if(o===ri.RGBA)for(let e=0;e<u;e++){const n=i(p[e*d+a],t.table,l);f[4*e]=n[0],f[4*e+1]=n[1],f[4*e+2]=n[2],f[4*e+3]=n[3]}}else if(o===ri.RGBA)for(let e=0;e<u;e++){const n=i(p[e*d+a],t.table,l);f[4*e]=n[0],f[4*e+1]=n[1],f[4*e+2]=n[2],f[4*e+3]=Math.floor(n[3]*c+.5)}},e.forceBuild=()=>{let n=0,r=0,o=0,a=0;const i=t.numberOfColors-1;i&&(n=(t.hueRange[1]-t.hueRange[0])/i,r=(t.saturationRange[1]-t.saturationRange[0])/i,o=(t.valueRange[1]-t.valueRange[0])/i,a=(t.alphaRange[1]-t.alphaRange[0])/i);const s=[],l=[];for(let e=0;e<=i;e++)s[0]=t.hueRange[0]+e*n,s[1]=t.saturationRange[0]+e*r,s[2]=t.valueRange[0]+e*o,to(s,l),l[3]=t.alphaRange[0]+e*a,t.table[4*e]=255*l[0]+.5,t.table[4*e+1]=255*l[1]+.5,t.table[4*e+2]=255*l[2]+.5,t.table[4*e+3]=255*l[3]+.5;e.buildSpecialColors(),t.buildTime.modified()},e.setTable=n=>{if(4!==n.getNumberOfComponents())return void hi("Expected 4 components for RGBA colors");if(n.getDataType()!==T.UNSIGNED_CHAR)return void hi("Expected unsigned char values for RGBA colors");t.numberOfColors=n.getNumberOfTuples();const r=n.getData();for(let e=0;e<r.length;e++)t.table[e]=r[e];e.buildSpecialColors(),t.insertTime.modified(),e.modified()},e.buildSpecialColors=()=>{const{numberOfColors:e}=t,n=t.table;let r=4*(e+0);t.useBelowRangeColor||0===e?(n[r]=255*t.belowRangeColor[0]+.5,n[r+1]=255*t.belowRangeColor[1]+.5,n[r+2]=255*t.belowRangeColor[2]+.5,n[r+3]=255*t.belowRangeColor[3]+.5):(n[r]=n[0],n[r+1]=n[1],n[r+2]=n[2],n[r+3]=n[3]),r=4*(e+1),t.useAboveRangeColor||0===e?(n[r]=255*t.aboveRangeColor[0]+.5,n[r+1]=255*t.aboveRangeColor[1]+.5,n[r+2]=255*t.aboveRangeColor[2]+.5,n[r+3]=255*t.aboveRangeColor[3]+.5):(n[r]=n[4*(e-1)+0],n[r+1]=n[4*(e-1)+1],n[r+2]=n[4*(e-1)+2],n[r+3]=n[4*(e-1)+3]),r=4*(e+2),n[r]=255*t.nanColor[0]+.5,n[r+1]=255*t.nanColor[1]+.5,n[r+2]=255*t.nanColor[2]+.5,n[r+3]=255*t.nanColor[3]+.5},e.build=()=>{(t.table.length<1||e.getMTime()>t.buildTime.getMTime()&&t.insertTime.getMTime()<=t.buildTime.getMTime())&&e.forceBuild()},t.table.length>0&&t.insertTime.modified()}(e,t)}var yi={newInstance:C.default.newInstance(vi,"vtkLookupTable"),extend:vi};let bi=1,Ti=0;const xi=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function Ci(e=0){Ti=e}var Ei={getResolveCoincidentTopologyAsString:function(){return xi[Ti]},getResolveCoincidentTopologyPolygonOffsetFaces:function(){return bi},getResolveCoincidentTopology:function(){return Ti},setResolveCoincidentTopology:Ci,setResolveCoincidentTopologyPolygonOffsetFaces:function(e){bi=e},setResolveCoincidentTopologyToDefault:function(){Ci(0)},setResolveCoincidentTopologyToOff:function(){Ci(0)},setResolveCoincidentTopologyToPolygonOffset:function(){Ci(1)}};function Mi(e,t,n){n.forEach(n=>{e["get"+n.method]=()=>t[n.key],e["set"+n.method]=(e,r)=>{t[n.key]={factor:e,offset:r}}})}const Si=["Polygon","Line","Point"],wi={};Mi(wi,{Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},Si.map(e=>({key:e,method:`ResolveCoincidentTopology${e}OffsetParameters`})));var Ri={implementCoincidentTopologyMethods:function(e,t){void 0===t.resolveCoincidentTopology&&(t.resolveCoincidentTopology=!1),C.default.setGet(e,t,["resolveCoincidentTopology"]),t.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(Ei).forEach(t=>{e[t]=Ei[t]}),Object.keys(wi).forEach(t=>{e[t]=wi[t]}),Mi(e,t.topologyOffset,Si.map(e=>({key:e,method:`RelativeCoincidentTopology${e}OffsetParameters`}))),e.getCoincidentTopologyPolygonOffsetParameters=()=>{const t=wi.getResolveCoincidentTopologyPolygonOffsetParameters(),n=e.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:t.factor+n.factor,offset:t.offset+n.offset}},e.getCoincidentTopologyLineOffsetParameters=()=>{const t=wi.getResolveCoincidentTopologyLineOffsetParameters(),n=e.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:t.factor+n.factor,offset:t.offset+n.offset}},e.getCoincidentTopologyPointOffsetParameter=()=>{const t=wi.getResolveCoincidentTopologyPointOffsetParameters(),n=e.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:t.factor+n.factor,offset:t.offset+n.offset}}},staticOffsetAPI:wi,otherStaticMethods:Ei,CATEGORIES:Si};const{staticOffsetAPI:Pi,otherStaticMethods:Oi}=Ri,{ColorMode:Ii,ScalarMode:Di,GetArray:Vi}=ai,{VectorMode:Li}=oi,{VtkDataTypes:_i}=Co;function Fi(e){return()=>C.default.vtkErrorMacro(`vtkMapper::${e} - NOT IMPLEMENTED`)}const Ni={colorMapColors:null,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,viewSpecificProperties:null,customShaderAttributes:[]};function Bi(e,t,n={}){Object.assign(t,Ni,n),Da.extend(e,t,n),C.default.get(e,t,["colorCoordinates","colorMapColors","colorTextureMap"]),C.default.setGet(e,t,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),C.default.setGetArray(e,t,["scalarRange"],2),t.viewSpecificProperties||(t.viewSpecificProperties={}),Ri.implementCoincidentTopologyMethods(e,t),function(e,t){t.classHierarchy.push("vtkMapper"),e.getBounds=()=>{const n=e.getInputData();return n?(t.static||e.update(),t.bounds=n.getBounds()):t.bounds=fo(),t.bounds},e.setForceCompileOnly=e=>{t.forceCompileOnly=e},e.createDefaultLookupTable=()=>{t.lookupTable=yi.newInstance()},e.getColorModeAsString=()=>C.default.enumToString(Ii,t.colorMode),e.setColorModeToDefault=()=>e.setColorMode(0),e.setColorModeToMapScalars=()=>e.setColorMode(1),e.setColorModeToDirectScalars=()=>e.setColorMode(2),e.getScalarModeAsString=()=>C.default.enumToString(Di,t.scalarMode),e.setScalarModeToDefault=()=>e.setScalarMode(0),e.setScalarModeToUsePointData=()=>e.setScalarMode(1),e.setScalarModeToUseCellData=()=>e.setScalarMode(2),e.setScalarModeToUsePointFieldData=()=>e.setScalarMode(3),e.setScalarModeToUseCellFieldData=()=>e.setScalarMode(4),e.setScalarModeToUseFieldData=()=>e.setScalarMode(5),e.getAbstractScalars=(e,n,r,o,a)=>{if(!e||!t.scalarVisibility)return{scalars:null,cellFLag:!1};let i=null,s=!1;if(n===Di.DEFAULT)i=e.getPointData().getScalars(),i||(i=e.getCellData().getScalars(),s=!0);else if(n===Di.USE_POINT_DATA)i=e.getPointData().getScalars();else if(n===Di.USE_CELL_DATA)i=e.getCellData().getScalars(),s=!0;else if(n===Di.USE_POINT_FIELD_DATA){const t=e.getPointData();i=r===Vi.BY_ID?t.getArrayByIndex(o):t.getArrayByName(a)}else if(n===Di.USE_CELL_FIELD_DATA){const t=e.getCellData();s=!0,i=r===Vi.BY_ID?t.getArrayByIndex(o):t.getArrayByName(a)}else if(n===Di.USE_FIELD_DATA){const t=e.getFieldData();i=r===Vi.BY_ID?t.getArrayByIndex(o):t.getArrayByName(a)}return{scalars:i,cellFlag:s}},e.mapScalars=(n,r)=>{const o=e.getAbstractScalars(n,t.scalarMode,t.arrayAccessMode,t.arrayId,t.colorByArrayName).scalars;if(!o)return t.colorCoordinates=null,t.colorTextureMap=null,void(t.colorMapColors=null);if(t.useLookupTableScalarRange||e.getLookupTable().setRange(t.scalarRange[0],t.scalarRange[1]),e.canUseTextureMapForColoring(n))return void e.mapScalarsToTexture(o,r);t.colorCoordinates=null,t.colorTextureMap=null;const a=e.getLookupTable();a&&(a.build(),t.colorMapColors=a.mapScalars(o,t.colorMode,-1))},e.scalarToTextureCoordinate=(e,t,n)=>{let r=.5,o=1;return uo(e)||(o=.49,r=(e-t)*n,r>1e3?r=1e3:r<-1e3&&(r=-1e3)),{texCoordS:r,texCoordT:o}},e.createColorTextureCoordinates=(t,n,r,o,a,i,s,l,c)=>{const u=(i[1]-i[0])/l,d=[];d[0]=i[0]-u,d[1]=i[1]+u;const f=1/(d[1]-d[0]),p=n.getData(),m=t.getData();let g=0,h=0;if(a<0||a>=o)for(let t=0;t<r;++t){let t=0;for(let e=0;e<o;++e)t+=m[g]*m[g],g++;let n=Math.sqrt(t);c&&(n=yi.applyLogScale(n,s,i));const r=e.scalarToTextureCoordinate(n,d[0],f);p[h]=r.texCoordS,p[h+1]=r.texCoordT,h+=2}else{g+=a;for(let t=0;t<r;++t){let t=m[g];c&&(t=yi.applyLogScale(t,s,i));const n=e.scalarToTextureCoordinate(t,d[0],f);p[h]=n.texCoordS,p[h+1]=n.texCoordT,h+=2,g+=o}}},e.mapScalarsToTexture=(n,r)=>{const o=t.lookupTable.getRange(),a=t.lookupTable.usingLogScale();a&&yi.getLogRange(o,o);const i=t.lookupTable.getAlpha();if(t.colorMapColors=null,null==t.colorTextureMap||e.getMTime()>t.colorTextureMap.getMTime()||t.lookupTable.getMTime()>t.colorTextureMap.getMTime()||t.lookupTable.getAlpha()!==r){t.lookupTable.setAlpha(r),t.colorTextureMap=null,t.lookupTable.build();let e=t.lookupTable.getNumberOfAvailableColors();e>4094&&(e=4094),e+=2;const n=(o[1]-o[0])/(e-1-2),s=new Float64Array(2*e);for(let t=0;t<e;++t)s[t]=o[0]+t*n-n,a&&(s[t]=10**s[t]);for(let t=0;t<e;++t)s[t+e]=NaN;t.colorTextureMap=ni.newInstance(),t.colorTextureMap.setExtent(0,e-1,0,1,0,0);const l=Co.newInstance({numberOfComponents:1,values:s});t.colorTextureMap.getPointData().setScalars(t.lookupTable.mapScalars(l,t.colorMode,0)),t.lookupTable.setAlpha(i)}if(!t.colorCoordinates||e.getMTime()>t.colorCoordinates.getMTime()||e.getInputData(0).getMTime()>t.colorCoordinates.getMTime()||t.lookupTable.getMTime()>t.colorCoordinates.getMTime()){t.colorCoordinates=null;const r=n.getNumberOfComponents(),i=n.getNumberOfTuples();t.colorCoordinates=Co.newInstance({numberOfComponents:2,values:new Float32Array(2*i)});let s=t.lookupTable.getVectorComponent();t.lookupTable.getVectorMode()===Li.MAGNITUDE&&n.getNumberOfComponents()>1&&(s=-1),e.createColorTextureCoordinates(n,t.colorCoordinates,i,r,s,o,t.lookupTable.getRange(),t.colorTextureMap.getPointData().getScalars().getNumberOfTuples()/2-2,a)}},e.getIsOpaque=()=>{const t=e.getLookupTable();return!t||(t.build(),t.isOpaque())},e.canUseTextureMapForColoring=n=>{if(!t.interpolateScalarsBeforeMapping)return!1;if(t.lookupTable&&t.lookupTable.getIndexedLookup())return!1;const r=e.getAbstractScalars(n,t.scalarMode,t.arrayAccessMode,t.arrayId,t.colorByArrayName),o=r.scalars;return!!o&&(!r.cellFlag&&((t.colorMode!==Ii.DEFAULT||o.getDataType()!==_i.UNSIGNED_CHAR)&&t.colorMode!==Ii.DIRECT_SCALARS))},e.clearColorArrays=()=>{t.colorMapColors=null,t.colorCoordinates=null,t.colorTextureMap=null},e.getLookupTable=()=>(t.lookupTable||e.createDefaultLookupTable(),t.lookupTable),e.getMTime=()=>{let e=t.mtime;if(null!==t.lookupTable){const n=t.lookupTable.getMTime();e=n>e?n:e}return e},e.getPrimitiveCount=()=>{const t=e.getInputData();return{points:t.getPoints().getNumberOfValues()/3,verts:t.getVerts().getNumberOfValues()-t.getVerts().getNumberOfCells(),lines:t.getLines().getNumberOfValues()-2*t.getLines().getNumberOfCells(),triangles:t.getPolys().getNumberOfValues()-3*t.getLines().getNumberOfCells()}},e.acquireInvertibleLookupTable=Fi("AcquireInvertibleLookupTable"),e.valueToColor=Fi("ValueToColor"),e.colorToValue=Fi("ColorToValue"),e.useInvertibleColorFor=Fi("UseInvertibleColorFor"),e.clearInvertibleColor=Fi("ClearInvertibleColor")}(e,t)}var ki={newInstance:C.default.newInstance(Bi,"vtkMapper"),extend:Bi,...Pi,...Oi,...ai};function Gi(e){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ui(e){return function(e){if(Array.isArray(e))return Wi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wi(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hi(e,t){return(Hi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xi(e);if(t){var o=Xi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ki(this,n)}}function Ki(e,t){return!t||"object"!==Gi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xi(e){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hi(e,t)}(a,e);var t,n,r,o=ji(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).actor=Ra.newInstance(),t.mapper=ki.newInstance(),t.actor.setMapper(t.mapper),t}return t=a,(n=[{key:"render",value:function(){console.log("VtkGeometryRepresentation",this);var e=this.props,t=e.id,n=e.setProps,r=e.children,o=e.view,a={downstream:this.mapper,representation:this,view:o,setProps:n},i=u.a.Children.map(r,(function(e){return u.a.cloneElement(e,a)}));return u.a.createElement("div",{id:t},i)}},{key:"componentDidMount",value:function(){this.props.view.renderer.addActor(this.actor),this.update(this.props)}},{key:"componentDidUpdate",value:function(e,t,n){this.update(this.props,e)}},{key:"componentWillUnmount",value:function(){this.props.view.renderer.remoteActor(this.actor),this.actor.delete(),this.actor=null,this.mapper.delete(),this.mapper=null}},{key:"update",value:function(e,t){var n=e.pointSize,r=e.color,o=e.colorBy;!n||t&&n===t.pointSize||this.actor.getProperty().setPointSize(n),!r||t&&r===t.color||this.actor.getProperty().setColor(r),!o||t&&o===t.colorBy||this.setColorBy.apply(this,Ui(o))}},{key:"setColorBy",value:function(e,t){var n=ki.ColorMode.DEFAULT,r=ki.ScalarMode.DEFAULT,o=t,a=this.mapper.getInputData().getReferenceByName(e),i=!(!a||!a.getArray(t));i&&(n=ki.ColorMode.MAP_SCALARS,r="pointData"===e?ki.ScalarMode.USE_POINT_FIELD_DATA:ki.ScalarMode.USE_CELL_FIELD_DATA),this.mapper.set({colorByArrayName:o,colorMode:n,scalarMode:r,scalarVisibility:i},!0)}}])&&zi(t.prototype,n),r&&zi(t,r),a}(c.Component);function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $i(e,t){return($i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ts(e);if(t){var o=ts(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return es(this,n)}}function es(e,t){return!t||"object"!==Yi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ts(e){return(ts=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Qi.defaultProps={colorBy:["pointData",""],pointSize:1,color:[1,1,1]},Qi.propTypes={id:f.a.string,setProps:f.a.func,colorBy:f.a.arrayOf(f.a.string),pointSize:f.a.number,color:f.a.arrayOf(f.a.number),children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])};var ns=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$i(e,t)}(a,e);var t,n,r,o=Ji(a);function a(){return qi(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){console.log("VtkPointData",this.props);var e=this.props,t=e.id,n=e.setProps,r=e.children,o=e.view,a=e.representation,i=e.dataset,s={fields:i.getPointData(),dataset:i,representation:a,view:o,setProps:n},l=u.a.Children.map(r,(function(e){return u.a.cloneElement(e,s)}));return u.a.createElement("div",{id:t},l)}}])&&Zi(t.prototype,n),r&&Zi(t,r),a}(c.Component);function rs(e){let t=0;return e.filter((e,n)=>n===t&&(t+=e+1,!0))}ns.defaultProps={},ns.propTypes={id:f.a.string,setProps:f.a.func,children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])};const os={extractCellSizes:rs,getNumberOfCells:function(e){return rs(e).length}};const as={empty:!0,numberOfComponents:1,dataType:T.UNSIGNED_INT};function is(e,t,n={}){Object.assign(t,as,n),Co.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkCellArray"),e.getNumberOfCells=e=>void 0===t.numberOfCells||e?(t.cellSizes=rs(t.values),t.numberOfCells=t.cellSizes.length,t.numberOfCells):t.numberOfCells,e.getCellSizes=e=>void 0===t.cellSizes||e?(t.cellSizes=rs(t.values),t.cellSizes):t.cellSizes;const n=e.setData;e.setData=e=>{n(e,1),t.numberOfCells=void 0,t.cellSizes=void 0},e.getCell=e=>{let n=e;const r=t.values[n++];return t.values.subarray(n,n+r)}}(e,t)}var ss={newInstance:C.default.newInstance(is,"vtkCellArray"),extend:is,...os};const{vtkErrorMacro:ls}=C.default,cs=[1,-1,1,-1,1,-1];const us={empty:!0,numberOfComponents:3,dataType:T.FLOAT,bounds:[1,-1,1,-1,1,-1]};function ds(e,t,n={}){Object.assign(t,us,n),Co.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkPoints"),e.getNumberOfPoints=e.getNumberOfTuples,e.setNumberOfPoints=(n,r=3)=>{e.getNumberOfPoints()!==n&&(t.size=n*r,t.values=new window[t.dataType](t.size),e.setNumberOfComponents(r),e.modified())},e.setPoint=(e,...n)=>{const r=e*t.numberOfComponents;for(let e=0;e<t.numberOfComponents;e++)t.values[r+e]=n[e]},e.getPoint=e.getTuple,e.getBounds=()=>{if(3===e.getNumberOfComponents()){const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);t.bounds[2]=r[0],t.bounds[3]=r[1];const o=e.getRange(2);return t.bounds[4]=o[0],t.bounds[5]=o[1],t.bounds}if(2!==e.getNumberOfComponents())return ls("getBounds called on an array with components of\n        "+e.getNumberOfComponents()),cs;const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);return t.bounds[2]=r[0],t.bounds[3]=r[1],t.bounds[4]=0,t.bounds[5]=0,t.bounds},e.computeBounds=e.getBounds,e.setNumberOfComponents(t.numberOfComponents<2?3:t.numberOfComponents)}(e,t)}var fs={newInstance:C.default.newInstance(ds,"vtkPoints"),extend:ds};const ps={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function ms(e,t,n={}){Object.assign(t,ps,n),C.default.obj(e,t),t.points||(t.points=fs.newInstance()),C.default.get(e,t,["points","pointsIds"]),function(e,t){t.classHierarchy.push("vtkCell"),e.initialize=(e,n=null)=>{if(n){t.pointsIds=n;let r=t.points.getData();r.length!==3*t.pointsIds.length&&(r=new(window[e.getDataType()])(3*t.pointsIds.length));const o=e.getData();t.pointsIds.forEach((e,t)=>{let n=3*e,a=3*t;r[a]=o[n],r[++a]=o[++n],r[++a]=o[++n]}),t.points.setData(r)}else{t.points=e,t.pointsIds=new Array(e.getNumberOfPoints());for(let n=e.getNumberOfPoints()-1;n>=0;--n)t.pointsIds[n]=n}},e.getBounds=()=>{const e=t.points.getNumberOfPoints(),n=[];if(e){t.points.getPoint(0,n),t.bounds[0]=n[0],t.bounds[1]=n[0],t.bounds[2]=n[1],t.bounds[3]=n[1],t.bounds[4]=n[2],t.bounds[5]=n[2];for(let r=1;r<e;r++)t.points.getPoint(r,n),t.bounds[0]=n[0]<t.bounds[0]?n[0]:t.bounds[0],t.bounds[1]=n[0]>t.bounds[1]?n[0]:t.bounds[1],t.bounds[2]=n[1]<t.bounds[2]?n[1]:t.bounds[2],t.bounds[3]=n[1]>t.bounds[3]?n[1]:t.bounds[3],t.bounds[4]=n[2]<t.bounds[4]?n[2]:t.bounds[4],t.bounds[5]=n[2]>t.bounds[5]?n[2]:t.bounds[5]}else no(t.bounds);return t.bounds},e.getLength2=()=>{e.getBounds();let n=0,r=0;for(let e=0;e<3;e++)r=t.bounds[2*e+1]-t.bounds[2*e],n+=r*r;return n},e.getParametricDistance=e=>{let t,n=0;for(let r=0;r<3;r++)t=e[r]<0?-e[r]:e[r]>1?e[r]-1:0,t>n&&(n=t);return n},e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.deepCopy=e=>{e.initialize(t.points,t.pointsIds)},e.getCellDimension=()=>{},e.intersectWithLine=(e,t,n,r,o,a,i)=>{},e.evaluatePosition=(e,t,n,r,o,a)=>{}}(e,t)}var gs={newInstance:C.default.newInstance(ms,"vtkCell"),extend:ms};const hs={array:null,maxId:0,extend:0};function As(e,t,n={}){Object.assign(t,hs,n),C.default.obj(e,t),function(e,t){t.classHierarchy.push("vtkCellLinks"),e.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),o=n.getNumberOfCells(),a=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let t=0;t<o;++t){const{cellPointIds:r}=n.getCellPoints(t);r.forEach(t=>{e.incrementLinkCount(t)})}e.allocateLinks(r),t.maxId=r-1;for(let t=0;t<o;++t){const{cellPointIds:r}=n.getCellPoints(t);r.forEach(n=>{e.insertCellReference(n,a[n]++,t)})}}else{for(let t=0;t<o;t++){gs.newInstance().getPointsIds().forEach(t=>{e.incrementLinkCount(t)})}e.allocateLinks(r),t.maxId=r-1;for(let t=0;t<o;++t){gs.newInstance().getPointsIds().forEach(n=>{e.insertCellReference(n,a[n]++,t)})}}},e.allocate=(e,n=1e3)=>{t.array=Array(e).fill().map(()=>({ncells:0,cells:null})),t.extend=n,t.maxId=-1},e.initialize=()=>{t.array=null},e.getLink=e=>t.array[e],e.getNcells=e=>t.array[e].ncells,e.getCells=e=>t.array[e].cells,e.insertNextPoint=e=>{t.array.push({ncells:e,cells:Array(e)}),++t.maxId},e.insertNextCellReference=(e,n)=>{t.array[e].cells[t.array[e].ncells++]=n},e.deletePoint=e=>{t.array[e].ncells=0,t.array[e].cells=null},e.removeCellReference=(e,n)=>{t.array[n].cells=t.array[n].cells.filter(t=>t!==e),t.array[n].ncells=t.array[n].cells.length},e.addCellReference=(e,n)=>{t.array[n].cells[t.array[n].ncells++]=e},e.resizeCellList=(e,n)=>{t.array[e].cells.length=n},e.squeeze=()=>{!function(e,t){let n=t;for(t>=e.array.length&&(n+=e.array.length);n>e.array.length;)e.array.push({ncells:0,cells:null});e.array.length=n}(t,t.maxId+1)},e.reset=()=>{t.maxId=-1},e.deepCopy=e=>{t.array=[...e.array],t.extend=e.extend,t.maxId=e.maxId},e.incrementLinkCount=e=>{++t.array[e].ncells},e.allocateLinks=e=>{for(let n=0;n<e;++n)t.array[n].cells=new Array(t.array[n].ncells)},e.insertCellReference=(e,n,r)=>{t.array[e].cells[n]=r}}(e,t)}var vs={newInstance:C.default.newInstance(As,"vtkCellLinks"),extend:As};const ys={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},bs=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];const Ts={getClassNameFromTypeId:function(e){return e<bs.length?bs[e]:"UnknownClass"},getTypeIdFromClassName:function(e){return bs.findIndex(e)},isLinear:function(e){return e<ys.VTK_QUADRATIC_EDGE||e===ys.VTK_CONVEX_POINT_SET||e===ys.VTK_POLYHEDRON}};const xs={size:0,maxId:-1,extend:1e3};function Cs(e,t,n={}){Object.assign(t,xs,n),C.default.obj(e,t),C.default.get(e,t,["size","maxId","extend"]),C.default.getArray(e,t,["typeArray","locationArray"]),function(e,t){t.classHierarchy.push("vtkCellTypes"),e.allocate=(e=512,n=1e3)=>{t.size=e>0?e:1,t.extend=n>0?n:1,t.maxId=-1,t.typeArray=new Uint8Array(e),t.locationArray=new Uint32Array(e)},e.insertCell=(e,n,r)=>{t.typeArray[e]=n,t.locationArray[e]=r,e>t.maxId&&(t.maxId=e)},e.insertNextCell=(n,r)=>(e.insertCell(++t.maxId,n,r),t.maxId),e.setCellTypes=(e,n,r)=>{t.size=e,t.typeArray=n,t.locationArray=r,t.maxId=e-1},e.getCellLocation=e=>t.locationArray[e],e.deleteCell=e=>{t.typeArray[e]=ys.VTK_EMPTY_CELL},e.getNumberOfTypes=()=>t.maxId+1,e.isType=t=>{const n=e.getNumberOfTypes();for(let r=0;r<n;++r)if(t===e.getCellType(r))return!0;return!1},e.insertNextType=t=>e.insertNextCell(t,-1),e.getCellType=e=>t.typeArray[e],e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{e.allocate(n.getSize(),n.getExtend()),t.typeArray.set(n.getTypeArray()),t.locationArray.set(n.getLocationArray()),t.maxId=n.getMaxId()}}(e,t)}var Es={newInstance:C.default.newInstance(Cs,"vtkCellTypes"),extend:Cs,...Ts};var Ms={IntersectionState:{NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2}};const{IntersectionState:Ss}=Ms;function ws(e,t,n,r=null){const o={t:Number.MIN_VALUE,distance:0},a=[];let i;a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2];const s=a[0]*(e[0]-t[0])+a[1]*(e[1]-t[1])+a[2]*(e[2]-t[2]),l=Kr(a,a);let c=1e-5*s;return 0!==l&&(o.t=s/l),c<0&&(c=-c),-c<l&&l<c||l<=0||o.t<0?i=t:o.t>1?i=n:(i=a,a[0]=t[0]+o.t*a[0],a[1]=t[1]+o.t*a[1],a[2]=t[2]+o.t*a[2]),r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2]),o.distance=qr(i,e),o}function Rs(e,t,n,r,o,a){const i=[],s=[],l=[];o[0]=0,a[0]=0,i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=r[0]-n[0],s[1]=r[1]-n[1],s[2]=r[2]-n[2],l[0]=n[0]-e[0],l[1]=n[1]-e[1],l[2]=n[2]-e[2];const c=[];c[0]=[Kr(i,i),-Kr(i,s)],c[1]=[c[0][1],Kr(s,s)];const u=[];if(u[0]=Kr(i,l),u[1]=-Kr(s,l),0===eo(c,u,2)){let i=Number.MAX_VALUE;const s=[e,t,n,r],l=[n,n,e,e],c=[r,r,t,t],u=[a[0],a[0],o[0],o[0]],d=[o[0],o[0],a[0],a[0]];let f;for(let e=0;e<4;e++)f=ws(s[e],l[e],c[e]),f.distance<i&&(i=f.distance,u[e]=f.t,d[e]=e%2);return Ss.ON_LINE}return o[0]=u[0],a[0]=u[1],o[0]>=0&&o[0]<=1&&a[0]>=0&&a[0]<=1?Ss.YES_INTERSECTION:Ss.NO_INTERSECTION}const Ps={distanceToLine:ws,intersection:Rs};const Os={};function Is(e,t,n={}){Object.assign(t,Os,n),gs.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkLine"),e.getCellDimension=()=>1,e.intersectWithLine=(e,n,r,o,a)=>{const i={intersect:0,t:Number.MIN_VALUE,subId:0};a[1]=0,a[2]=0;const s=[],l=[],c=[];t.points.getPoint(0,l),t.points.getPoint(1,c);const u=[],d=[],f=Rs(e,n,l,c,u,d);if(i.t=u[0],a[0]=d[0],f===Ss.YES_INTERSECTION){for(let t=0;t<3;t++)o[t]=l[t]+a[0]*(c[t]-l[t]),s[t]=e[t]+i.t*(n[t]-e[t]);if(qr(o,s)<=r*r)return i.intersect=1,i}else{let t;if(i.t<0)return i.t=0,t=ws(e,l,c,o),a[0]=t.t,t.distance<=r*r?(i.intersect=1,i):i;if(i.t>1)return i.t=1,t=ws(n,l,c,o),a[0]=t.t,t.distance<=r*r?(i.intersect=1,i):i;if(a[0]<0)return a[0]=0,t=ws(l,e,n,o),i.t=t.t,t.distance<=r*r?(i.intersect=1,i):i;if(a[1]>1)return a[1]=1,t=ws(c,e,n,o),i.t=t.t,t.distance<=r*r?(i.intersect=1,i):i}return i},e.evaluatePosition=(e,t,n,r,o,a)=>{}}(e,t)}var Ds={newInstance:C.default.newInstance(Is,"vtkLine"),extend:Is,...Ps,...Ms};const Vs={};function Ls(e,t,n={}){Object.assign(t,Vs,n),Qa.extend(e,t,n),C.default.setGet(e,t,["points"]),function(e,t){t.classHierarchy.push("vtkPointSet"),t.points?t.points=Object(Va.a)(t.points):t.points=fs.newInstance(),e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.getBounds=()=>t.points.getBounds(),e.computeBounds=()=>{e.getBounds()};const n=e.shallowCopy;e.shallowCopy=(e,r=!1)=>{n(e,r),t.points=fs.newInstance(),t.points.shallowCopy(e.getPoints())}}(e,t)}var _s={newInstance:C.default.newInstance(Ls,"vtkPointSet"),extend:Ls};function Fs(e,t,n,r){const o=n[0]-t[0],a=n[1]-t[1],i=n[2]-t[2],s=e[0]-t[0],l=e[1]-t[1],c=e[2]-t[2];r[0]=a*c-i*l,r[1]=i*s-o*c,r[2]=o*l-a*s}function Ns(e,t,n,r){Fs(e,t,n,r);const o=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);0!==o&&(r[0]/=o,r[1]/=o,r[2]/=o)}const Bs={computeNormalDirection:Fs,computeNormal:Ns};const ks={};function Gs(e,t,n={}){Object.assign(t,ks,n),gs.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkTriangle"),e.getCellDimension=()=>2,e.intersectWithLine=(n,r,o,a,i)=>{const s={subId:0,t:0,intersect:-1};i[2]=0;const l=[],c=o*o,u=[],d=[],f=[];t.points.getPoint(0,u),t.points.getPoint(1,d),t.points.getPoint(2,f);const p=[],m=[];if(Ns(u,d,f,p),0!==p[0]||0!==p[1]||0!==p[2]){const t=Qo.intersectWithLine(n,r,u,p);if(s.t=t.t,a[0]=t.x[0],a[1]=t.x[1],a[2]=t.x[2],!t.intersection)return i[0]=0,i[1]=0,s.intersect=0,s;const o=e.evaluatePosition(a,l,i,m);if(o.evaluation>=0)return o.dist2<=c?(s.intersect=1,s):(s.intersect=o.evaluation,s)}const g=qr(u,d),h=qr(d,f),A=qr(f,u);t.line||(t.line=Ds.newInstance()),g>h&&g>A?(t.line.getPoints().setPoint(0,u),t.line.getPoints().setPoint(1,d)):h>A&&h>g?(t.line.getPoints().setPoint(0,d),t.line.getPoints().setPoint(1,f)):(t.line.getPoints().setPoint(0,f),t.line.getPoints().setPoint(1,u));if(t.line.intersectWithLine(n,r,o,a,i).intersect){const e=[],t=[],n=[];for(let r=0;r<3;r++)e[r]=u[r]-f[r],t[r]=d[r]-f[r],n[r]=a[r]-f[r];return i[0]=Kr(n,e)/A,i[1]=Kr(n,t)/h,s.evaluation=1,s}return i[0]=0,i[1]=0,s.evaluation=0,s},e.evaluatePosition=(e,n,r,o)=>{const a={subId:0,dist2:0,evaluation:-1};let i,s;const l=[],c=[],u=[],d=[];let f;const p=[],m=[],g=[];let h=0,A=0;const v=[];let y,b,T,x=[];const C=[],E=[],M=[];a.subId=0,r[2]=0,t.points.getPoint(1,l),t.points.getPoint(2,c),t.points.getPoint(0,u),Fs(l,c,u,d),Qo.generalizedProjectPoint(e,l,d,M);let S=0;for(i=0;i<3;i++)f=d[i]<0?-d[i]:d[i],f>S&&(S=f,A=i);for(s=0,i=0;i<3;i++)i!==A&&(v[s++]=i);for(i=0;i<2;i++)p[i]=M[v[i]]-u[v[i]],m[i]=l[v[i]]-u[v[i]],g[i]=c[v[i]]-u[v[i]];if(h=Zr(m,g),0===h)return r[0]=0,r[1]=0,a.evaluation=-1,a;if(r[0]=Zr(p,g)/h,r[1]=Zr(m,p)/h,o[0]=1-(r[0]+r[1]),o[1]=r[0],o[2]=r[1],o[0]>=0&&o[0]<=1&&o[1]>=0&&o[1]<=1&&o[2]>=0&&o[2]<=1)n&&(a.dist2=qr(M,e),n[0]=M[0],n[1]=M[1],n[2]=M[2]),a.evaluation=1;else{let t;if(n)if(o[1]<0&&o[2]<0)for(y=qr(e,u),b=Ds.distanceToLine(e,l,u,t,C),T=Ds.distanceToLine(e,u,c,t,E),y<b?(a.dist2=y,x=u):(a.dist2=b,x=C),T<a.dist2&&(a.dist2=T,x=E),i=0;i<3;i++)n[i]=x[i];else if(o[2]<0&&o[0]<0)for(y=qr(e,l),b=Ds.distanceToLine(e,l,u,t,C),T=Ds.distanceToLine(e,l,c,t,E),y<b?(a.dist2=y,x=l):(a.dist2=b,x=C),T<a.dist2&&(a.dist2=T,x=E),i=0;i<3;i++)n[i]=x[i];else if(o[1]<0&&o[0]<0)for(y=qr(e,c),b=Ds.distanceToLine(e,c,u,t,C),T=Ds.distanceToLine(e,l,c,t,E),y<b?(a.dist2=y,x=c):(a.dist2=b,x=C),T<a.dist2&&(a.dist2=T,x=E),i=0;i<3;i++)n[i]=x[i];else if(o[0]<0){const t=Ds.distanceToLine(e,l,c,n);a.dist2=t.distance}else if(o[1]<0){const t=Ds.distanceToLine(e,c,u,n);a.dist2=t.distance}else if(o[2]<0){const t=Ds.distanceToLine(e,l,u,n);a.dist2=t.distance}a.evaluation=0}return a},e.evaluateLocation=(e,n,r)=>{const o=[],a=[],i=[];t.points.getPoint(0,o),t.points.getPoint(1,a),t.points.getPoint(2,i);const s=1-e[0]-e[1];for(let t=0;t<3;t++)n[t]=o[t]*s+a[t]*e[0]+i[t]*e[1];r[0]=s,r[1]=e[0],r[2]=e[1]},e.getParametricDistance=e=>{let t,n=0;const r=[];r[0]=e[0],r[1]=e[1],r[2]=1-e[0]-e[1];for(let e=0;e<3;e++)t=r[e]<0?-r[e]:r[e]>1?r[e]-1:0,t>n&&(n=t);return n}}(e,t)}var Us={newInstance:C.default.newInstance(Gs,"vtkTriangle"),extend:Gs,...Bs};const Ws=["verts","lines","polys","strips"];const{vtkWarningMacro:zs}=C.default,Hs={[ys.VTK_LINE]:Ds,[ys.VTK_POLY_LINE]:Ds,[ys.VTK_TRIANGLE]:Us};const js={};function Ks(e,t,n={}){Object.assign(t,js,n),_s.extend(e,t,n),C.default.get(e,t,["cells","links"]),C.default.setGet(e,t,["verts","lines","polys","strips"]),function(e,t){t.classHierarchy.push("vtkPolyData"),Ws.forEach(n=>{e["getNumberOf"+function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,e=>e.toUpperCase()).replace(/\s+/g,"")}(n)]=()=>t[n].getNumberOfCells(),t[n]?t[n]=Object(Va.a)(t[n]):t[n]=ss.newInstance()}),e.getNumberOfCells=()=>Ws.reduce((e,n)=>e+t[n].getNumberOfCells(),0);const n=e.shallowCopy;e.shallowCopy=(e,r=!1)=>{n(e,r),Ws.forEach(n=>{t[n]=ss.newInstance(),t[n].shallowCopy(e.getReferenceByName(n))})},e.buildCells=()=>{const n=e.getNumberOfVerts(),r=e.getNumberOfLines(),o=e.getNumberOfPolys(),a=e.getNumberOfStrips(),i=n+r+o+a,s=new Uint8Array(i);let l=s;const c=new Uint32Array(i);let u=c;if(n){let e=0;t.verts.getCellSizes().forEach((t,n)=>{u[n]=e,l[n]=t>1?ys.VTK_POLY_VERTEX:ys.VTK_VERTEX,e+=t+1}),u=u.subarray(n),l=l.subarray(n)}if(r){let e=0;t.lines.getCellSizes().forEach((t,n)=>{u[n]=e,l[n]=t>2?ys.VTK_POLY_LINE:ys.VTK_LINE,1===t&&zs("Building VTK_LINE ",n," with only one point, but VTK_LINE needs at least two points. Check the input."),e+=t+1}),u=u.subarray(r),l=l.subarray(r)}if(o){let e=0;t.polys.getCellSizes().forEach((t,n)=>{switch(u[n]=e,t){case 3:l[n]=ys.VTK_TRIANGLE;break;case 4:l[n]=ys.VTK_QUAD;break;default:l[n]=ys.VTK_POLYGON}t<3&&zs("Building VTK_TRIANGLE ",n," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),e+=t+1}),u+=u.subarray(o),l+=l.subarray(o)}if(a){let e=0;l.fill(ys.VTK_TRIANGLE_STRIP,0,a),t.strips.getCellSizes().forEach((t,n)=>{u[n]=e,e+=t+1})}t.cells=Es.newInstance(),t.cells.setCellTypes(i,s,c)},e.buildLinks=(n=0)=>{void 0===t.cells&&e.buildCells(),t.links=vs.newInstance(),n>0?t.links.allocate(n):t.links.allocate(e.getPoints().getNumberOfPoints()),t.links.buildLinks(e)},e.getCellPoints=e=>{const n=t.cells.getCellType(e);let r=null;switch(n){case ys.VTK_VERTEX:case ys.VTK_POLY_VERTEX:r=t.verts;break;case ys.VTK_LINE:case ys.VTK_POLY_LINE:r=t.lines;break;case ys.VTK_TRIANGLE:case ys.VTK_QUAD:case ys.VTK_POLYGON:r=t.polys;break;case ys.VTK_TRIANGLE_STRIP:r=t.strips;break;default:return r=null,{type:0,cellPointIds:null}}const o=t.cells.getCellLocation(e);return{cellType:n,cellPointIds:r.getCell(o)}},e.getPointCells=e=>t.links.getCells(e),e.getCellEdgeNeighbors=(e,n,r)=>{const o=t.links.getLink(n),a=t.links.getLink(r);return o.cells.filter(t=>t!==e&&-1!==a.cells.indexOf(t))},e.getCell=(t,n=null)=>{const r=e.getCellPoints(t),o=n||Hs[r.cellType].newInstance();return o.initialize(e.getPoints(),r.cellPointIds),o}}(e,t)}var Xs={newInstance:C.default.newInstance(Ks,"vtkPolyData"),extend:Ks};function Qs(e){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qs(e,t){return(qs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Js(e);if(t){var o=Js(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $s(this,n)}}function $s(e,t){return!t||"object"!==Qs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Js(e){return(Js=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var el=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qs(e,t)}(a,e);var t,n,r,o=Zs(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).polydata=Xs.newInstance(),t}return t=a,(n=[{key:"render",value:function(){console.log("VtkPolyDataSource",this.props);var e=this.props,t=e.id,n=e.setProps,r=e.children,o=e.view,a=e.representation,i={dataset:this.polydata,representation:a,view:o,setProps:n},s=u.a.Children.map(r,(function(e){return u.a.cloneElement(e,i)}));return u.a.createElement("div",{id:t},s)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.downstream,n=e.port;this.update(this.props),t.setInputData(this.polydata,n)}},{key:"componentDidUpdate",value:function(e,t,n){this.update(this.props,e)}},{key:"componentWillUnmount",value:function(){this.polydata.delete(),this.polydata=null}},{key:"update",value:function(e,t){var n=e.pointCloud,r=e.points,o=e.verts,a=e.lines,i=e.polys,s=e.strips,l=!1,c=!1;if(!r||t&&r===t.points||(this.polydata.getPoints().setData(Float32Array.from(r),3),c=!0,l=!0),!o||t&&o===t.verts||(this.polydata.getVerts().setData(Uint16Array.from(o)),l=!0),!a||t&&a===t.lines||(this.polydata.getLines().setData(Uint16Array.from(a)),l=!0),!i||t&&i===t.polys||(this.polydata.getPolys().setData(Uint16Array.from(i)),l=!0),!s||t&&s===t.strips||(this.polydata.getStrips().setData(Uint16Array.from(s)),l=!0),n&&(c||!t||n!==t.pointCloud)){var u=r.length/3,d=new Uint16Array(u+1);d[0]=u;for(var f=0;f<u;f++)d[f+1]=f;this.polydata.getVerts().setData(d),l=!0}l&&this.polydata.modified()}}])&&Ys(t.prototype,n),r&&Ys(t,r),a}(c.Component);el.defaultProps={port:0,points:[],pointCloud:!1},el.propTypes={id:f.a.string,setProps:f.a.func,port:f.a.number,points:f.a.arrayOf(f.a.number),verts:f.a.arrayOf(f.a.number),lines:f.a.arrayOf(f.a.number),polys:f.a.arrayOf(f.a.number),strips:f.a.arrayOf(f.a.number),pointCloud:f.a.bool,children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])};const tl={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},nl={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var rl={Wrap:tl,Filter:nl};const{vtkErrorMacro:ol}=C.default;const al={parent:null,renderable:null,myFactory:null,children:[],visited:!1};function il(e,t,n={}){Object.assign(t,al,n),C.default.obj(e,t),C.default.event(e,t,"event"),t.renderableChildMap=new Map,C.default.get(e,t,["visited"]),C.default.setGet(e,t,["parent","renderable","myFactory"]),C.default.getArray(e,t,["children"]),function(e,t){t.classHierarchy.push("vtkViewNode"),e.build=e=>{},e.render=e=>{},e.traverse=n=>{const r=n.getTraverseOperation(),o=e[r];if(o)o(n);else{e.apply(n,!0);for(let e=0;e<t.children.length;e++)t.children[e].traverse(n);e.apply(n,!1)}},e.apply=(t,n)=>{const r=e[t.getOperation()];r&&r(n,t)},e.getViewNodeFor=n=>{if(t.renderable===n)return e;for(let e=0;e<t.children.length;++e){const r=t.children[e].getViewNodeFor(n);if(r)return r}},e.getFirstAncestorOfType=e=>t.parent?t.parent.isA(e)?t.parent:t.parent.getFirstAncestorOfType(e):null,e.addMissingNode=n=>{if(!n)return;const r=t.renderableChildMap.get(n);if(void 0!==r)r.setVisited(!0);else{const r=e.createViewNode(n);r&&(r.setParent(e),r.setVisited(!0),t.renderableChildMap.set(n,r),t.children.push(r))}},e.addMissingNodes=n=>{if(n&&n.length)for(let r=0;r<n.length;++r){const o=n[r],a=t.renderableChildMap.get(o);if(void 0!==a)a.setVisited(!0);else{const n=e.createViewNode(o);n&&(n.setParent(e),n.setVisited(!0),t.renderableChildMap.set(o,n),t.children.push(n))}}},e.prepareNodes=()=>{for(let e=0;e<t.children.length;++e)t.children[e].setVisited(!1)},e.setVisited=e=>{t.visited=e},e.removeUnusedNodes=()=>{let e=null;for(let n=0;n<t.children.length;++n){const r=t.children[n];if(r.getVisited())r.setVisited(!1);else{const n=r.getRenderable();n&&t.renderableChildMap.delete(n),e||(e=[]),e.push(r)}}e&&(t.children=t.children.filter(t=>!e.includes(t)))},e.createViewNode=e=>{if(!t.myFactory)return ol("Cannot create view nodes without my own factory"),null;const n=t.myFactory.createNode(e);return n&&n.setRenderable(e),n}}(e,t)}var sl={newInstance:C.default.newInstance(il,"vtkViewNode"),extend:il,PASS_TYPES:["Build","Render"]};const{Wrap:ll,Filter:cl}=rl,{VtkDataTypes:ul}=Co,{vtkDebugMacro:dl,vtkErrorMacro:fl,vtkWarningMacro:pl}=C.default;const ml={openGLRenderWindow:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:ll.CLAMP_TO_EDGE,wrapT:ll.CLAMP_TO_EDGE,wrapR:ll.CLAMP_TO_EDGE,minificationFilter:cl.NEAREST,magnificationFilter:cl.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1};function gl(e,t,n={}){Object.assign(t,ml,n),sl.extend(e,t,n),t.sendParametersTime={},C.default.obj(t.sendParametersTime,{mtime:0}),t.textureBuildTime={},C.default.obj(t.textureBuildTime,{mtime:0}),C.default.set(e,t,["format","openGLDataType"]),C.default.setGet(e,t,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap"]),C.default.get(e,t,["width","height","volumeInfo","components","handle","target"]),function(e,t){function n(e,n){const r=[];if(e!==ul.FLOAT&&t.openGLDataType===t.context.FLOAT){const e=t.width*t.height*t.components;for(let t=0;t<n.length;t++){const o=new Float32Array(e);for(let r=0;r<e;r++)o[r]=n[t][r];r.push(o)}}if(e!==ul.UNSIGNED_CHAR&&t.openGLDataType===t.context.UNSIGNED_BYTE){const e=t.width*t.height*t.components;for(let t=0;t<n.length;t++){const o=new Uint8Array(e);for(let r=0;r<e;r++)o[r]=n[t][r];r.push(o)}}if(0===r.length)for(let e=0;e<n.length;e++)r.push(n[e]);return r}function r(e){if(t.openGLRenderWindow.getWebgl2())return e;const n=[],r=t.width,o=t.height,a=t.components;if(e&&(!zr(r)||!zr(o))){const i=Wr(r),s=Wr(o),l=i*s*t.components;for(let c=0;c<e.length;c++)if(null!==e[c]){let u=null;switch(t.openGLDataType){case t.context.FLOAT:u=new Float32Array(l);break;default:case t.context.UNSIGNED_BYTE:u=new Uint8Array(l)}const d=o/s,f=r/i;for(let t=0;t<s;t++){const n=t*i*a,s=t*d;let l=Math.floor(s),p=Math.ceil(s);p>=o&&(p=o-1);const m=s-l,g=1-m;l=l*r*a,p=p*r*a;for(let t=0;t<i;t++){const o=t*a,i=t*f;let s=Math.floor(i),d=Math.ceil(i);d>=r&&(d=r-1);const h=i-s;s*=a,d*=a;for(let t=0;t<a;t++)u[n+o+t]=e[c][l+s+t]*g*(1-h)+e[c][l+d+t]*g*h+e[c][p+s+t]*m*(1-h)+e[c][p+d+t]*m*h}}n.push(u),t.width=i,t.height=s}else n.push(null)}if(0===n.length)for(let t=0;t<e.length;t++)n.push(e[t]);return n}function o(e,t,n){const r=[],o=[];for(let t=0;t<e;++t)r[t]=n[t],o[t]=n[t];let a=0;for(let i=0;i<t;++i)for(let t=0;t<e;++t)n[a]<r[t]&&(r[t]=n[a]),n[a]>o[t]&&(o[t]=n[a]),a++;const i=[],s=[];for(let t=0;t<e;++t)r[t]===o[t]&&(o[t]=r[t]+1),i[t]=r[t],s[t]=o[t]-r[t];return{scale:s,offset:i}}t.classHierarchy.push("vtkOpenGLTexture"),e.render=(n=null)=>{if(n?t.openGLRenderWindow=n:(t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.openGLRenderWindow=t.openGLRenderer.getParent()),t.context=t.openGLRenderWindow.getContext(),t.renderable.getInterpolate()?(t.generateMipmap?e.setMinificationFilter(cl.LINEAR_MIPMAP_LINEAR):e.setMinificationFilter(cl.LINEAR),e.setMagnificationFilter(cl.LINEAR)):(e.setMinificationFilter(cl.NEAREST),e.setMagnificationFilter(cl.NEAREST)),t.renderable.getRepeat()&&(e.setWrapR(ll.REPEAT),e.setWrapS(ll.REPEAT),e.setWrapT(ll.REPEAT)),t.renderable.getInputData()&&t.renderable.setImage(null),!t.handle||t.renderable.getMTime()>t.textureBuildTime.getMTime()){null!==t.renderable.getImage()&&(t.renderable.getInterpolate()&&(t.generateMipmap=!0,e.setMinificationFilter(cl.LINEAR_MIPMAP_LINEAR)),t.renderable.getImage()&&t.renderable.getImageLoaded()&&(e.create2DFromImage(t.renderable.getImage()),e.activate(),e.sendParameters(),t.textureBuildTime.modified()));const n=t.renderable.getInputData(0);if(n&&n.getPointData().getScalars()){const r=n.getExtent(),o=n.getPointData().getScalars(),a=[];for(let e=0;e<t.renderable.getNumberOfInputPorts();++e){const n=t.renderable.getInputData(e),r=n?n.getPointData().getScalars().getData():null;r&&a.push(r)}t.renderable.getInterpolate()&&4===o.getNumberOfComponents()&&(t.generateMipmap=!0,e.setMinificationFilter(cl.LINEAR_MIPMAP_LINEAR)),a.length%6==0?e.createCubeFromRaw(r[1]-r[0]+1,r[3]-r[2]+1,o.getNumberOfComponents(),o.getDataType(),a):e.create2DFromRaw(r[1]-r[0]+1,r[3]-r[2]+1,o.getNumberOfComponents(),o.getDataType(),o.getData()),e.activate(),e.sendParameters(),t.textureBuildTime.modified()}}t.handle&&e.activate()},e.destroyTexture=()=>{e.deactivate(),t.context&&t.handle&&t.context.deleteTexture(t.handle),t.handle=0,t.numberOfDimensions=0,t.target=0,t.components=0,t.width=0,t.height=0,t.depth=0,e.resetFormatAndType()},e.createTexture=()=>{t.handle||(t.handle=t.context.createTexture(),t.target&&(t.context.bindTexture(t.target,t.handle),t.context.texParameteri(t.target,t.context.TEXTURE_MIN_FILTER,e.getOpenGLFilterMode(t.minificationFilter)),t.context.texParameteri(t.target,t.context.TEXTURE_MAG_FILTER,e.getOpenGLFilterMode(t.magnificationFilter)),t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_S,e.getOpenGLWrapMode(t.wrapS)),t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_T,e.getOpenGLWrapMode(t.wrapT)),t.openGLRenderWindow.getWebgl2()&&t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_R,e.getOpenGLWrapMode(t.wrapR)),t.context.bindTexture(t.target,null)))},e.getTextureUnit=()=>t.openGLRenderWindow?t.openGLRenderWindow.getTextureUnitForTexture(e):-1,e.activate=()=>{t.openGLRenderWindow.activateTexture(e),e.bind()},e.deactivate=()=>{t.openGLRenderWindow&&t.openGLRenderWindow.deactivateTexture(e)},e.releaseGraphicsResources=n=>{n&&t.handle&&(n.activateTexture(e),n.deactivateTexture(e),t.context.deleteTexture(t.handle),t.handle=0,t.numberOfDimensions=0,t.target=0,t.internalFormat=0,t.format=0,t.openGLDataType=0,t.components=0,t.width=0,t.height=0,t.depth=0),t.shaderProgram&&(t.shaderProgram.releaseGraphicsResources(n),t.shaderProgram=null)},e.bind=()=>{t.context.bindTexture(t.target,t.handle),t.autoParameters&&e.getMTime()>t.sendParametersTime.getMTime()&&e.sendParameters()},e.isBound=()=>{let e=!1;if(t.context&&t.handle){let n=0;switch(t.target){case t.context.TEXTURE_2D:n=t.context.TEXTURE_BINDING_2D;break;default:pl("impossible case")}e=t.context.getIntegerv(n)===t.handle}return e},e.sendParameters=()=>{t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_S,e.getOpenGLWrapMode(t.wrapS)),t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_T,e.getOpenGLWrapMode(t.wrapT)),t.openGLRenderWindow.getWebgl2()&&t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_R,e.getOpenGLWrapMode(t.wrapR)),t.context.texParameteri(t.target,t.context.TEXTURE_MIN_FILTER,e.getOpenGLFilterMode(t.minificationFilter)),t.context.texParameteri(t.target,t.context.TEXTURE_MAG_FILTER,e.getOpenGLFilterMode(t.magnificationFilter)),t.openGLRenderWindow.getWebgl2()&&(t.context.texParameteri(t.target,t.context.TEXTURE_BASE_LEVEL,t.baseLevel),t.context.texParameteri(t.target,t.context.TEXTURE_MAX_LEVEL,t.maxLevel)),t.sendParametersTime.modified()},e.getInternalFormat=(n,r)=>(t.internalFormat||(t.internalFormat=e.getDefaultInternalFormat(n,r)),t.internalFormat||dl(`Unable to find suitable internal format for T=${n} NC= ${r}`),t.internalFormat),e.getDefaultInternalFormat=(e,n)=>{let r=0;return r=t.openGLRenderWindow.getDefaultTextureInternalFormat(e,n,!1),r||(r=this.openGLRenderWindow.getDefaultTextureInternalFormat(e,n,!0),r||(dl("Unsupported internal texture type!"),dl(`Unable to find suitable internal format for T=${e} NC= ${n}`)),r)},e.setInternalFormat=n=>{n!==t.internalFormat&&(t.internalFormat=n,e.modified())},e.getFormat=(n,r)=>(t.format=e.getDefaultFormat(n,r),t.format),e.getDefaultFormat=(e,n)=>{if(t.openGLRenderWindow.getWebgl2())switch(n){case 1:return t.context.RED;case 2:return t.context.RG;case 3:return t.context.RGB;case 4:return t.context.RGBA;default:return t.context.RGB}else switch(n){case 1:return t.context.LUMINANCE;case 2:return t.context.LUMINANCE_ALPHA;case 3:return t.context.RGB;case 4:return t.context.RGBA;default:return t.context.RGB}},e.resetFormatAndType=()=>{t.format=0,t.internalFormat=0,t.openGLDataType=0},e.getDefaultDataType=e=>{if(t.openGLRenderWindow.getWebgl2())switch(e){case ul.UNSIGNED_CHAR:return t.context.UNSIGNED_BYTE;case ul.FLOAT:case ul.VOID:default:return t.context.FLOAT}switch(e){case ul.UNSIGNED_CHAR:return t.context.UNSIGNED_BYTE;case ul.FLOAT:case ul.VOID:default:return t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear")?t.context.FLOAT:t.context.UNSIGNED_BYTE}},e.getOpenGLDataType=n=>(t.openGLDataType=e.getDefaultDataType(n),t.openGLDataType),e.getShiftAndScale=()=>{let e=0,n=1;switch(t.openGLDataType){case t.context.BYTE:n=127.5,e=n-128;break;case t.context.UNSIGNED_BYTE:n=255,e=0;break;case t.context.SHORT:n=32767.5,e=n-32768;break;case t.context.UNSIGNED_SHORT:n=65536,e=0;break;case t.context.INT:n=2147483647.5,e=n-2147483648;break;case t.context.UNSIGNED_INT:n=4294967295,e=0;break;case t.context.FLOAT:}return{shift:e,scale:n}},e.getOpenGLFilterMode=e=>{switch(e){case cl.NEAREST:return t.context.NEAREST;case cl.LINEAR:return t.context.LINEAR;case cl.NEAREST_MIPMAP_NEAREST:return t.context.NEAREST_MIPMAP_NEAREST;case cl.NEAREST_MIPMAP_LINEAR:return t.context.NEAREST_MIPMAP_LINEAR;case cl.LINEAR_MIPMAP_NEAREST:return t.context.LINEAR_MIPMAP_NEAREST;case cl.LINEAR_MIPMAP_LINEAR:return t.context.LINEAR_MIPMAP_LINEAR;default:return t.context.NEAREST}},e.getOpenGLWrapMode=e=>{switch(e){case ll.CLAMP_TO_EDGE:return t.context.CLAMP_TO_EDGE;case ll.REPEAT:return t.context.REPEAT;case ll.MIRRORED_REPEAT:return t.context.MIRRORED_REPEAT;default:return t.context.CLAMP_TO_EDGE}},e.create2DFromRaw=(o,a,i,s,l)=>{if(e.getOpenGLDataType(s),e.getInternalFormat(s,i),e.getFormat(s,i),!t.internalFormat||!t.format||!t.openGLDataType)return fl("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_2D,t.components=i,t.width=o,t.height=a,t.depth=1,t.numberOfDimensions=2,t.openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind();const c=r(n(s,[l]));return t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,c[0]),t.generateMipmap&&t.context.generateMipmap(t.target),e.deactivate(),!0},e.createCubeFromRaw=(o,a,i,s,l)=>{if(e.getOpenGLDataType(s),e.getInternalFormat(s,i),e.getFormat(s,i),!t.internalFormat||!t.format||!t.openGLDataType)return fl("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_CUBE_MAP,t.components=i,t.width=o,t.height=a,t.depth=1,t.numberOfDimensions=2,t.openGLRenderWindow.activateTexture(e),t.maxLevel=l.length/6-1,e.createTexture(),e.bind();const c=r(n(s,l)),u=[];let d=t.width,f=t.height;for(let e=0;e<c.length;e++){e%6==0&&0!==e&&(d/=2,f/=2),u[e]=new window[s](f*d*t.components);for(let n=0;n<f;++n){const r=n*d*t.components,o=(f-n-1)*d*t.components;u[e].set(c[e].slice(o,o+d*t.components),r)}}t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1);for(let e=0;e<6;e++){let n=0,r=t.width,o=t.height;for(;r>=1&&o>=1;){let a=null;n<=t.maxLevel&&(a=u[6*n+e]),t.context.texImage2D(t.context.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,t.internalFormat,r,o,0,t.format,t.openGLDataType,a),n++,r/=2,o/=2}}return e.deactivate(),!0},e.createDepthFromRaw=(n,r,o,a)=>(e.getOpenGLDataType(o),t.format=t.context.DEPTH_COMPONENT,t.openGLRenderWindow.getWebgl2()?o===ul.FLOAT?t.internalFormat=t.context.DEPTH_COMPONENT32F:t.internalFormat=t.context.DEPTH_COMPONENT16:t.internalFormat=t.context.DEPTH_COMPONENT,t.internalFormat&&t.format&&t.openGLDataType?(t.target=t.context.TEXTURE_2D,t.components=1,t.width=n,t.height=r,t.depth=1,t.numberOfDimensions=2,t.openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,a),t.generateMipmap&&t.context.generateMipmap(t.target),e.deactivate(),!0):(fl("Failed to determine texture parameters."),!1)),e.create2DFromImage=n=>{if(e.getOpenGLDataType(ul.UNSIGNED_CHAR),e.getInternalFormat(ul.UNSIGNED_CHAR,4),e.getFormat(ul.UNSIGNED_CHAR,4),!t.internalFormat||!t.format||!t.openGLDataType)return fl("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_2D,t.components=4,t.width=n.width,t.height=n.height,t.depth=1,t.numberOfDimensions=2,t.openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1);const r=!zr(n.width)||!zr(n.height),o=document.createElement("canvas");o.width=r?Wr(n.width):n.width,o.height=r?Wr(n.height):n.height;const a=o.getContext("2d");a.translate(0,o.height),a.scale(1,-1),a.drawImage(n,0,0,n.width,n.height,0,0,o.width,o.height),navigator.userAgent.indexOf("Chrome/69")>=0&&a.getImageData(0,0,1,1);const i=o;return t.context.texImage2D(t.target,0,t.internalFormat,t.format,t.openGLDataType,i),t.generateMipmap&&t.context.generateMipmap(t.target),e.deactivate(),!0},e.create3DFromRaw=(n,r,o,a,i,s)=>(e.getOpenGLDataType(i),e.getInternalFormat(i,a),e.getFormat(i,a),t.internalFormat&&t.format&&t.openGLDataType?(t.target=t.context.TEXTURE_3D,t.components=a,t.width=n,t.height=r,t.depth=o,t.numberOfDimensions=3,t.openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.context.texImage3D(t.target,0,t.internalFormat,t.width,t.height,t.depth,0,t.format,t.openGLDataType,s),t.generateMipmap&&t.context.generateMipmap(t.target),e.deactivate(),!0):(fl("Failed to determine texture parameters."),!1)),e.create3DFilterableFromRaw=(n,r,a,i,s,l)=>{const c=n*r*a,u=[],d=[];for(let e=0;e<i;++e)u[e]=0,d[e]=1;if(t.volumeInfo={scale:d,offset:u,width:n,height:r,depth:a},t.openGLRenderWindow.getWebgl2()){if(s===ul.FLOAT)return e.create3DFromRaw(n,r,a,i,s,l);if(s===ul.UNSIGNED_CHAR){for(let e=0;e<i;++e)t.volumeInfo.scale[e]=255;return e.create3DFromRaw(n,r,a,i,s,l)}const u=new Float32Array(c*i),d=o(i,c,l);t.volumeInfo.offset=d.offset,t.volumeInfo.scale=d.scale;let f=0;for(let e=0;e<c;++e)for(let e=0;e<i;++e)u[f]=(l[f]-t.volumeInfo.offset[e])/t.volumeInfo.scale[e],f++;return e.create3DFromRaw(n,r,a,i,ul.FLOAT,u)}const f=o(i,c,l);let p=(e,t,n,r,o)=>{e[t]=n},m=ul.UNSIGNED_CHAR;if(s===ul.UNSIGNED_CHAR)for(let e=0;e<i;++e)f.offset[e]=0,f.scale[e]=255;else t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear")?(m=ul.FLOAT,p=(e,t,n,r,o)=>{e[t]=(n-r)/o}):(m=ul.UNSIGNED_CHAR,p=(e,t,n,r,o)=>{e[t]=255*(n-r)/o});if(e.getOpenGLDataType(m),e.getInternalFormat(m,i),e.getFormat(m,i),!t.internalFormat||!t.format||!t.openGLDataType)return fl("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_2D,t.components=i,t.depth=1,t.numberOfDimensions=2;let g=t.context.getParameter(t.context.MAX_TEXTURE_SIZE);g>4096&&(m===ul.FLOAT||i>=3)&&(g=4096);let h=1,A=1;c>g*g&&(h=Math.ceil(Math.sqrt(c/(g*g))),A=h);let v=Math.sqrt(c)/h;v=Wr(v);const y=Math.floor(v*h/n),b=Math.ceil(a/y),T=Wr(r*b/A);let x;t.width=v,t.height=T,t.openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.volumeInfo.xreps=y,t.volumeInfo.yreps=b,t.volumeInfo.xstride=h,t.volumeInfo.ystride=A,t.volumeInfo.offset=f.offset,t.volumeInfo.scale=f.scale;const C=v*T*i;x=m===ul.FLOAT?new Float32Array(C):new Uint8Array(C);let E=0;const M=Math.floor(n/h),S=Math.floor(r/A);for(let e=0;e<b;e++){const o=Math.min(y,a-e*y),s=i*(t.width-o*Math.floor(n/h));for(let t=0;t<S;t++){for(let a=0;a<o;a++){const o=i*((e*y+a)*n*r+A*t*n);for(let e=0;e<M;e++)for(let t=0;t<i;t++)p(x,E,l[o+h*e*i+t],f.offset[t],f.scale[t]),E++}E+=s}}return t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,x),e.deactivate(),!0},e.setOpenGLRenderWindow=n=>{t.openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t.openGLRenderWindow=n,t.context=null,n&&(t.context=t.openGLRenderWindow.getContext()))},e.getMaximumTextureSize=e=>e&&e.isCurrent()?e.getIntegerv(e.MAX_TEXTURE_SIZE):-1}(e,t)}var hl={newInstance:C.default.newInstance(gl,"vtkOpenGLTexture"),extend:gl,...rl};const Al={openGLRenderWindow:null,glFramebuffer:null,colorTexture:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function vl(e,t,n={}){Object.assign(t,Al,n),C.obj(e,t),C.setGet(e,t,["colorTexture"]),function(e,t){t.classHierarchy.push("vtkFramebuffer"),e.getBothMode=()=>t.context.FRAMEBUFFER,e.saveCurrentBindingsAndBuffers=t=>{const n=void 0!==t?t:e.getBothMode();e.saveCurrentBindings(n),e.saveCurrentBuffers(n)},e.saveCurrentBindings=e=>{const n=t.context;t.previousDrawBinding=n.getParameter(t.context.FRAMEBUFFER_BINDING),t.previousActiveFramebuffer=t.openGLRenderWindow.getActiveFramebuffer()},e.saveCurrentBuffers=e=>{},e.restorePreviousBindingsAndBuffers=t=>{const n=void 0!==t?t:e.getBothMode();e.restorePreviousBindings(n),e.restorePreviousBuffers(n)},e.restorePreviousBindings=e=>{const n=t.context;n.bindFramebuffer(n.FRAMEBUFFER,t.previousDrawBinding),t.openGLRenderWindow.setActiveFramebuffer(t.previousActiveFramebuffer)},e.restorePreviousBuffers=e=>{},e.bind=()=>{t.context.bindFramebuffer(t.context.FRAMEBUFFER,t.glFramebuffer),t.colorTexture&&t.colorTexture.bind(),t.openGLRenderWindow.setActiveFramebuffer(e)},e.create=(e,n)=>{t.glFramebuffer=t.context.createFramebuffer(),t.glFramebuffer.width=e,t.glFramebuffer.height=n},e.setColorBuffer=(e,n=0)=>{const r=t.context;let o=r.COLOR_ATTACHMENT0;if(n>0){if(!t.openGLRenderWindow.getWebgl2())return void C.vtkErrorMacro("Using multiple framebuffer attachments requires WebGL 2");o+=n}t.colorTexture=e,r.framebufferTexture2D(r.FRAMEBUFFER,o,r.TEXTURE_2D,e.getHandle(),0)},e.removeColorBuffer=(e=0)=>{const n=t.context;let r=n.COLOR_ATTACHMENT0;if(e>0){if(!t.openGLRenderWindow.getWebgl2())return void C.vtkErrorMacro("Using multiple framebuffer attachments requires WebGL 2");r+=e}n.framebufferTexture2D(n.FRAMEBUFFER,r,n.TEXTURE_2D,null,0)},e.setDepthBuffer=e=>{if(t.openGLRenderWindow.getWebgl2()){const n=t.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,e.getHandle(),0)}else C.vtkErrorMacro("Attaching depth buffer textures to fbo requires WebGL 2")},e.removeDepthBuffer=()=>{if(t.openGLRenderWindow.getWebgl2()){const e=t.context;e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,null,0)}else C.vtkErrorMacro("Attaching depth buffer textures to framebuffers requires WebGL 2")},e.getGLFramebuffer=()=>t.glFramebuffer,e.setOpenGLRenderWindow=n=>{t.openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t.openGLRenderWindow=n,t.context=null,n&&(t.context=t.openGLRenderWindow.getContext()))},e.releaseGraphicsResources=()=>{t.glFramebuffer&&t.context.deleteFramebuffer(t.glFramebuffer),t.colorTexture&&t.colorTexture.releaseGraphicsResources()},e.getSize=()=>{const e=[0,0];return null!==t.glFramebuffer&&(e[0]=t.glFramebuffer.width,e[1]=t.glFramebuffer.height),e},e.populateFramebuffer=()=>{e.bind();const n=t.context,r=hl.newInstance();r.setOpenGLRenderWindow(t.openGLRenderWindow),r.setMinificationFilter(nl.LINEAR),r.setMagnificationFilter(nl.LINEAR),r.create2DFromRaw(t.glFramebuffer.width,t.glFramebuffer.height,4,T.UNSIGNED_CHAR,null),e.setColorBuffer(r),t.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,t.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t.glFramebuffer.width,t.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,t.depthTexture)}}(e,t)}var yl={newInstance:C.newInstance(vl,"vtkFramebuffer"),extend:vl};const bl={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function Tl(e,t,n={}){Object.assign(t,bl,n),C.default.obj(e,t),C.default.get(e,t,["currentOperation"]),C.default.setGet(e,t,["delegates","currentParent","preDelegateOperations","postDelegateOperations"]),function(e,t){t.classHierarchy.push("vtkRenderPass"),e.getOperation=()=>t.currentOperation,e.setCurrentOperation=e=>{t.currentOperation=e,t.currentTraverseOperation="traverse"+C.default.capitalize(t.currentOperation)},e.getTraverseOperation=()=>t.currentTraverseOperation,e.traverse=(n,r=null)=>{t.deleted||(t.currentParent=r,t.preDelegateOperations.forEach(t=>{e.setCurrentOperation(t),n.traverse(e)}),t.delegates.forEach(t=>{t.traverse(n,e)}),t.postDelegateOperations.forEach(t=>{e.setCurrentOperation(t),n.traverse(e)}))}}(e,t)}var xl={newInstance:C.default.newInstance(Tl,"vtkRenderPass"),extend:Tl};const Cl={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,framebuffer:null,depthRequested:!1};function El(e,t,n={}){Object.assign(t,Cl,n),xl.extend(e,t,n),C.default.get(e,t,["framebuffer"]),C.default.setGet(e,t,["depthRequested"]),function(e,t){t.classHierarchy.push("vtkForwardPass"),e.traverse=(n,r=null)=>{if(t.deleted)return;t.currentParent=r,e.setCurrentOperation("buildPass"),n.traverse(e);const o=n.getRenderable().getNumberOfLayers(),a=n.getChildren();for(let r=0;r<o;r++)for(let o=0;o<a.length;o++){const i=a[o],s=n.getRenderable().getRenderers()[o];if(s.getDraw()&&s.getLayer()===r){if(t.opaqueActorCount=0,t.translucentActorCount=0,t.volumeCount=0,e.setCurrentOperation("queryPass"),i.traverse(e),t.opaqueActorCount>0&&t.volumeCount>0||t.depthRequested){const r=n.getFramebufferSize();null===t.framebuffer&&(t.framebuffer=yl.newInstance()),t.framebuffer.setOpenGLRenderWindow(n),t.framebuffer.saveCurrentBindingsAndBuffers();const o=t.framebuffer.getSize();null!==o&&o[0]===r[0]&&o[1]===r[1]||(t.framebuffer.create(r[0],r[1]),t.framebuffer.populateFramebuffer()),t.framebuffer.bind(),e.setCurrentOperation("opaqueZBufferPass"),i.traverse(e),t.framebuffer.restorePreviousBindingsAndBuffers()}e.setCurrentOperation("cameraPass"),i.traverse(e),t.opaqueActorCount>0&&(e.setCurrentOperation("opaquePass"),i.traverse(e)),t.translucentActorCount>0&&(e.setCurrentOperation("translucentPass"),i.traverse(e)),t.volumeCount>0&&(e.setCurrentOperation("volumePass"),i.traverse(e))}}},e.getZBufferTexture=()=>t.framebuffer?t.framebuffer.getColorTexture():null,e.incrementOpaqueActorCount=()=>t.opaqueActorCount++,e.incrementTranslucentActorCount=()=>t.translucentActorCount++,e.incrementVolumeCount=()=>t.volumeCount++}(e,t)}var Ml={newInstance:C.default.newInstance(El,"vtkForwardPass"),extend:El};const Sl={};function wl(e,t,n={}){Object.assign(t,Sl,n),sl.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkGenericWidgetRepresentation")}(0,t)}var Rl={newInstance:C.default.newInstance(wl),extend:wl};const Pl={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function Ol(e,t,n={}){Object.assign(t,Pl,n),sl.extend(e,t,n),t.keyMatrixTime={},C.default.obj(t.keyMatrixTime,{mtime:0}),t.keyMatrices={normalMatrix:o.create(),mcwc:a.create()},C.default.setGet(e,t,["context"]),C.default.get(e,t,["activeTextures"]),function(e,t){t.classHierarchy.push("vtkOpenGLActor"),e.buildPass=n=>{if(n){t.openGLRenderWindow=e.getFirstAncestorOfType("vtkOpenGLRenderWindow"),t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.context=t.openGLRenderWindow.getContext(),e.prepareNodes(),e.addMissingNodes(t.renderable.getTextures()),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes(),t.ogltextures=null,t.activeTextures=null;for(let e=0;e<t.children.length;e++){const n=t.children[e];n.isA("vtkOpenGLTexture")?(t.ogltextures||(t.ogltextures=[]),t.ogltextures.push(n)):t.oglmapper=n}}},e.traverseOpaqueZBufferPass=t=>{e.traverseOpaquePass(t)},e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getVisibility()&&t.renderable.getIsOpaque()&&(!t.openGLRenderer.getSelector()||t.renderable.getPickable())&&(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getVisibility()||t.renderable.getIsOpaque()||t.openGLRenderer.getSelector()&&!t.renderable.getPickable()||(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.activateTextures=()=>{if(t.ogltextures){t.activeTextures=[];for(let e=0;e<t.ogltextures.length;e++){const n=t.ogltextures[e];n.render(),n.getHandle()&&t.activeTextures.push(n)}}},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.opaqueZBufferPass=(t,n)=>e.opaquePass(t,n),e.opaquePass=(n,r)=>{if(n)t.openGLRenderWindow.enableDepthMask(),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()},e.translucentPass=(n,r)=>{if(n)t.openGLRenderWindow.disableDepthMask(),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()},e.getKeyMatrices=()=>(t.renderable.getMTime()>t.keyMatrixTime.getMTime()&&(t.renderable.computeMatrix(),a.copy(t.keyMatrices.mcwc,t.renderable.getMatrix()),a.transpose(t.keyMatrices.mcwc,t.keyMatrices.mcwc),t.renderable.getIsIdentity()?o.identity(t.keyMatrices.normalMatrix):(o.fromMat4(t.keyMatrices.normalMatrix,t.keyMatrices.mcwc),o.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),o.transpose(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix)),t.keyMatrixTime.modified()),t.keyMatrices)}(e,t)}var Il={newInstance:C.default.newInstance(Ol),extend:Ol};const Dl={context:null,activeTextures:[]};function Vl(e,t,n={}){Object.assign(t,Dl,n),sl.extend(e,t,n),C.setGet(e,t,["context"]),C.get(e,t,["activeTextures"]),function(e,t){t.classHierarchy.push("vtkOpenGLActor2D"),e.buildPass=n=>{if(n){if(!t.renderable)return;t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),e.prepareNodes(),e.addMissingNodes(t.renderable.getTextures()),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes()}},e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getVisibility()&&t.renderable.getIsOpaque()&&(!t.openGLRenderer.getSelector()||t.renderable.getPickable())&&(e.apply(n,!0),t.children.forEach(e=>{e.isA("vtkOpenGLTexture")||e.traverse(n)}),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getVisibility()||t.renderable.getIsOpaque()||t.openGLRenderer.getSelector()&&!t.renderable.getPickable()||(e.apply(n,!0),t.children.forEach(e=>{e.isA("vtkOpenGLTexture")||e.traverse(n)}),e.apply(n,!1))},e.activateTextures=()=>{t.activeTextures=[],t.children.forEach(e=>{e.isA("vtkOpenGLTexture")&&(e.render(),e.getHandle()&&t.activeTextures.push(e))})},e.opaquePass=(n,r)=>{n?(t.context=e.getFirstAncestorOfType("vtkOpenGLRenderWindow").getContext(),t.context.depthMask(!0),e.activateTextures()):t.activeTextures.forEach(e=>{e.deactivate()})},e.translucentPass=(n,r)=>{n?(t.context=e.getFirstAncestorOfType("vtkOpenGLRenderWindow").getContext(),t.context.depthMask(!1),e.activateTextures()):(t.activeTextures.forEach(e=>{e.deactivate()}),t.context.depthMask(!0))}}(e,t)}var Ll={newInstance:C.newInstance(Vl),extend:Vl};const _l={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function Fl(e,t,n={}){Object.assign(t,_l,n),sl.extend(e,t,n),t.keyMatrixTime={},C.obj(t.keyMatrixTime),t.keyMatrices={normalMatrix:o.create(),vcpc:a.create(),wcvc:a.create(),wcpc:a.create()},C.setGet(e,t,["context","keyMatrixTime"]),function(e,t){t.classHierarchy.push("vtkOpenGLCamera"),e.buildPass=n=>{n&&(t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.openGLRenderWindow=t.openGLRenderer.getParent(),t.context=t.openGLRenderWindow.getContext())},e.opaquePass=e=>{if(e){const e=t.openGLRenderer.getTiledSizeAndOrigin();t.context.viewport(e.lowerLeftU,e.lowerLeftV,e.usize,e.vsize),t.context.scissor(e.lowerLeftU,e.lowerLeftV,e.usize,e.vsize)}},e.translucentPass=e.opaquePass,e.opaqueZBufferPass=e.opaquePass,e.volumePass=e.opaquePass,e.getKeyMatrices=n=>{if(n!==t.lastRenderer||t.openGLRenderWindow.getMTime()>t.keyMatrixTime.getMTime()||e.getMTime()>t.keyMatrixTime.getMTime()||n.getMTime()>t.keyMatrixTime.getMTime()||t.renderable.getMTime()>t.keyMatrixTime.getMTime()){a.copy(t.keyMatrices.wcvc,t.renderable.getViewMatrix()),o.fromMat4(t.keyMatrices.normalMatrix,t.keyMatrices.wcvc),o.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),a.transpose(t.keyMatrices.wcvc,t.keyMatrices.wcvc);const e=t.openGLRenderer.getAspectRatio();a.copy(t.keyMatrices.vcpc,t.renderable.getProjectionMatrix(e,-1,1)),a.transpose(t.keyMatrices.vcpc,t.keyMatrices.vcpc),a.multiply(t.keyMatrices.wcpc,t.keyMatrices.vcpc,t.keyMatrices.wcvc),t.keyMatrixTime.modified(),t.lastRenderer=n}return t.keyMatrices}}(e,t)}var Nl={newInstance:C.newInstance(Fl),extend:Fl};const Bl={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var kl={ObjectType:Bl};const{ObjectType:Gl}=kl;const Ul={objectType:Gl.ARRAY_BUFFER,openGLRenderWindow:null,context:null};function Wl(e,t,n={}){Object.assign(t,Ul,n),C.default.obj(e,t),C.default.get(e,t,["openGLRenderWindow"]),function(e,t){function n(e){switch(e){case Gl.ELEMENT_ARRAY_BUFFER:return t.context.ELEMENT_ARRAY_BUFFER;case Gl.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in t.context)return t.context.TEXTURE_BUFFER;default:case Gl.ARRAY_BUFFER:return t.context.ARRAY_BUFFER}}t.classHierarchy.push("vtkOpenGLBufferObject");let r=null,o=null,a=!0,i="";e.getType=()=>r,e.setType=e=>{r=e},e.getHandle=()=>o,e.isReady=()=>!1===a,e.generateBuffer=e=>{const a=n(e);return null===o&&(o=t.context.createBuffer(),r=e),n(r)===a},e.upload=(s,l)=>e.generateBuffer(l)?(t.context.bindBuffer(n(r),o),t.context.bufferData(n(r),s,t.context.STATIC_DRAW),a=!1,!0):(i="Trying to upload array buffer to incompatible buffer.",!1),e.bind=()=>!!o&&(t.context.bindBuffer(n(r),o),!0),e.release=()=>!!o&&(t.context.bindBuffer(n(r),null),!0),e.releaseGraphicsResources=()=>{null!==o&&(t.context.bindBuffer(n(r),null),t.context.deleteBuffer(o),o=null)},e.setOpenGLRenderWindow=n=>{t.openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t.openGLRenderWindow=n,t.context=null,n&&(t.context=t.openGLRenderWindow.getContext()))},e.getError=()=>i}(e,t)}var zl={newInstance:C.default.newInstance(Wl),extend:Wl,...kl};var Hl={PassTypes:{MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,MAX_KNOWN_PASS:2}};var jl={SelectionContent:{GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},SelectionField:{CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5}};const Kl={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function Xl(e,t,n={}){Object.assign(t,Kl,n),C.default.obj(e,t),t.properties={},C.default.setGet(e,t,["contentType","fieldType","properties","selectionList"]),function(e,t){t.classHierarchy.push("vtkSelectionNode"),e.getBounds=()=>t.points.getBounds()}(e,t)}var Ql={newInstance:C.default.newInstance(Xl,"vtkSelectionNode"),extend:Xl,...jl};const{PassTypes:Yl}=Hl,{SelectionContent:ql,SelectionField:Zl}=Ql,{FieldAssociations:$l}=Qa,{vtkErrorMacro:Jl}=C.default;const ec={fieldAssociation:$l.FIELD_ASSOCIATION_CELLS,renderer:null,area:null,openGLRenderWindow:null,openGLRenderer:null,currentPass:-1,propColorValue:null,props:null,idOffset:1,captureZValues:!1};function tc(e,t,n={}){Object.assign(t,ec,n),C.default.obj(e,t),t.area=[0,0,0,0],t.propColorValue=[0,0,0],t.props=[],C.default.setGet(e,t,["fieldAssociation","renderer","currentPass","captureZValues"]),C.default.setGetArray(e,t,["area"],4),C.default.setGetArray(e,t,["propColorValue"],3),C.default.event(e,t,"event"),function(e,t){t.classHierarchy.push("vtkOpenGLHardwareSelector"),e.releasePixBuffers=()=>{t.pixBuffer=[],t.zBuffer=null},e.beginSelection=()=>{t.openGLRenderer=t.openGLRenderWindow.getViewNodeFor(t.renderer),t.maxAttributeId=0;const n=t.openGLRenderWindow.getSize();if(t.framebuffer){t.framebuffer.setOpenGLRenderWindow(t.openGLRenderWindow),t.framebuffer.saveCurrentBindingsAndBuffers();const e=t.framebuffer.getSize();e[0]!==n[0]||e[1]!==n[1]?(t.framebuffer.create(n[0],n[1]),t.framebuffer.populateFramebuffer()):t.framebuffer.bind()}else t.framebuffer=yl.newInstance(),t.framebuffer.setOpenGLRenderWindow(t.openGLRenderWindow),t.framebuffer.saveCurrentBindingsAndBuffers(),t.framebuffer.create(n[0],n[1]),t.framebuffer.populateFramebuffer();t.openGLRenderer.clear(),t.openGLRenderer.setSelector(e),t.hitProps={},t.props=[],e.releasePixBuffers()},e.endSelection=()=>{t.hitProps={},t.openGLRenderer.setSelector(null),t.framebuffer.restorePreviousBindingsAndBuffers()},e.preCapturePass=()=>{},e.postCapturePass=()=>{},e.select=()=>{let n=null;return e.captureBuffers()&&(n=e.generateSelection(t.area[0],t.area[1],t.area[2],t.area[3]),e.releasePixBuffers()),n},e.captureBuffers=()=>{if(!t.renderer||!t.openGLRenderWindow)return Jl("Renderer and view must be set before calling Select."),!1;t.openGLRenderer=t.openGLRenderWindow.getViewNodeFor(t.renderer),e.invokeEvent({type:"StartEvent"}),t.originalBackground=t.renderer.getBackgroundByReference(),t.renderer.setBackground(0,0,0);const n=t.openGLRenderWindow.getRenderPasses();for(e.beginSelection(),t.currentPass=Yl.MIN_KNOWN_PASS;t.currentPass<=Yl.COMPOSITE_INDEX_PASS;t.currentPass++)e.passRequired(t.currentPass)&&(e.preCapturePass(t.currentPass),t.captureZValues&&t.currentPass===Yl.ACTOR_PASS&&"function"==typeof n[0].setDepthRequested&&"function"==typeof n[0].getFramebuffer?(n[0].setDepthRequested(!0),t.openGLRenderWindow.traverseAllPasses(),n[0].setDepthRequested(!1)):t.openGLRenderWindow.traverseAllPasses(),e.postCapturePass(t.currentPass),e.savePixelBuffer(t.currentPass));return e.endSelection(),t.renderer.setBackground(t.originalBackground),e.invokeEvent({type:"EndEvent"}),!0},e.passRequired=e=>!0,e.savePixelBuffer=n=>{if(t.pixBuffer[n]=t.openGLRenderWindow.getPixelData(t.area[0],t.area[1],t.area[2],t.area[3]),n===Yl.ACTOR_PASS){if(t.captureZValues){const e=t.openGLRenderWindow.getRenderPasses();if("function"==typeof e[0].setDepthRequested&&"function"==typeof e[0].getFramebuffer){const n=e[0].getFramebuffer();n.saveCurrentBindingsAndBuffers(),n.bind(),t.zBuffer=t.openGLRenderWindow.getPixelData(t.area[0],t.area[1],t.area[2],t.area[3]),n.restorePreviousBindingsAndBuffers()}}e.buildPropHitList(t.pixBuffer[n])}},e.buildPropHitList=n=>{for(let r=0;r<=t.area[3]-t.area[1];r++)for(let o=0;o<=t.area[2]-t.area[0];o++){let a=e.convert(o,r,n);a>0&&(a--,a in t.hitProps||(t.hitProps[a]=!0))}},e.renderProp=n=>{t.currentPass===Yl.ACTOR_PASS&&(e.setPropColorValueFromInt(t.props.length+t.idOffset),t.props.push(n))},e.renderCompositeIndex=n=>{t.currentPass===Yl.COMPOSITE_INDEX_PASS&&e.setPropColorValueFromInt(n+t.idOffset)},e.renderAttributeId=e=>{e<0||(t.maxAttributeId=e>t.maxAttributeId?e:t.maxAttributeId)},e.getPropFromID=e=>e>=0&&e<t.props.length?t.props[e]:null,e.passTypeToString=e=>C.default.enumToString(Yl,e),e.isPropHit=e=>Boolean(t.hitProps[e]),e.convert=(e,n,r)=>{if(!r)return 0;const o=4*(n*(t.area[2]-t.area[0]+1)+e),a=[];a[0]=r[o],a[1]=r[o+1],a[2]=r[o+2];let i=a[2];return i*=256,i+=a[1],i*=256,i+=a[0],i},e.setPropColorValueFromInt=e=>{t.propColorValue[0]=e%256/255,t.propColorValue[1]=Math.floor(e/256)%256/255,t.propColorValue[2]=Math.floor(e/65536)%256/255},e.getPixelInformation=(n,r,o)=>{const a=r<0?0:r;if(0===a){if(o[0]=n[0],o[1]=n[1],n[0]<t.area[0]||n[0]>t.area[2]||n[1]<t.area[1]||n[1]>t.area[3])return null;const r=[n[0]-t.area[0],n[1]-t.area[1]],a=e.convert(r[0],r[1],t.pixBuffer[Yl.ACTOR_PASS]);if(a<=0)return null;const i={valid:!0};i.propID=a-t.idOffset,i.prop=e.getPropFromID(i.propID);let s=e.convert(r[0],r[1],t.pixBuffer[Yl.COMPOSITE_INDEX_PASS]);if((s<0||s>16777215)&&(s=0),i.compositeID=s-t.idOffset,t.captureZValues){const e=4*(r[1]*(t.area[2]-t.area[0]+1)+r[0]);i.zValue=(256*t.zBuffer[e]+t.zBuffer[e+1])/65535,i.displayPosition=n}return i}const i=[n[0],n[1]],s=[0,0];let l=e.getPixelInformation(n,0,o);if(l&&l.valid)return l;for(let t=1;t<a;++t){for(let n=i[1]>t?i[1]-t:0;n<=i[1]+t;++n){if(s[1]=n,i[0]>=t&&(s[0]=i[0]-t,l=e.getPixelInformation(s,0,o),l&&l.valid))return l;if(s[0]=i[0]+t,l=e.getPixelInformation(s,0,o),l&&l.valid)return l}for(let n=i[0]>=t?i[0]-(t-1):0;n<=i[0]+(t-1);++n){if(s[0]=n,i[1]>=t&&(s[1]=i[1]-t,l=e.getPixelInformation(s,0,o),l&&l.valid))return l;if(s[1]=i[1]+t,l=e.getPixelInformation(s,0,o),l&&l.valid)return l}}return o[0]=n[0],o[1]=n[1],null},e.convertSelection=(e,n)=>{const r=[];let o=0;return n.forEach((n,a)=>{const i=Ql.newInstance();switch(i.setContentType(ql.INDICES),e){case $l.FIELD_ASSOCIATION_CELLS:i.setFieldType(Zl.CELL);break;case $l.FIELD_ASSOCIATION_POINTS:i.setFieldType(Zl.POINT);break;default:Jl("Unknown field association")}i.getProperties().propID=n.info.propID,i.getProperties().prop=n.info.prop,i.getProperties().compositeID=n.info.compositeID,i.getProperties().pixelCount=n.pixelCount,t.captureZValues&&(i.getProperties().displayPosition=[n.info.displayPosition[0],n.info.displayPosition[1],n.info.zValue],i.getProperties().worldPosition=t.openGLRenderWindow.displayToWorld(n.info.displayPosition[0],n.info.displayPosition[1],n.info.zValue,t.renderer)),i.setSelectionList(n.attributeIDs),r[o]=i,o++}),r},e.getInfoHash=e=>`${e.propID} ${e.compositeID}`,e.generateSelection=(n,r,o,a)=>{const i=Math.floor(n),s=Math.floor(r),l=Math.floor(o),c=Math.floor(a),u=new Map,d=[0,0];for(let n=s;n<=c;n++)for(let r=i;r<=l;r++){const o=[r,n],a=e.getPixelInformation(o,0,d);if(a&&a.valid){const n=e.getInfoHash(a);if(u.has(n)){const e=u.get(n);e.pixelCount++,t.captureZValues&&a.zValue<e.info.zValue&&(e.info=a),-1===e.attributeIDs.indexOf(a.attributeID)&&e.attributeIDs.push(a.attributeID)}else u.set(n,{info:a,pixelCount:1,attributeIDs:[a.attributeID]})}}return e.convertSelection(t.fieldAssociation,u)},e.attach=(e,n)=>{t.openGLRenderWindow=e,t.renderer=n};const n=e.setArea;e.setArea=(...e)=>!!n(...e)&&(t.area[0]=Math.floor(t.area[0]),t.area[1]=Math.floor(t.area[1]),t.area[2]=Math.floor(t.area[2]),t.area[3]=Math.floor(t.area[3]),!0)}(e,t)}var nc={newInstance:C.default.newInstance(tc,"vtkOpenGLHardwareSelector"),extend:tc,...Hl};const{vtkDebugMacro:rc,vtkErrorMacro:oc}=C.default;function ac(e,t){t.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),e.setType(Bl.ARRAY_BUFFER),e.createVBO=(n,r,o,a)=>{if(!n.getData()||!n.getData().length)return t.elementCount=0,0;t.blockSize=3,t.vertexOffset=0,t.normalOffset=0,t.tCoordOffset=0,t.tCoordComponents=0,t.colorComponents=0,t.colorOffset=0,t.customData=[];const s=a.points.getData();let l=null,c=null,u=null;const d=a.colors?a.colors.getNumberOfComponents():0,f=a.tcoords?a.tcoords.getNumberOfComponents():0;a.normals&&(t.normalOffset=4*t.blockSize,t.blockSize+=3,l=a.normals.getData()),a.customAttributes&&a.customAttributes.forEach(e=>{e&&(t.customData.push({data:e.getData(),offset:4*t.blockSize,components:e.getNumberOfComponents(),name:e.getName()}),t.blockSize+=e.getNumberOfComponents())}),a.tcoords&&(t.tCoordOffset=4*t.blockSize,t.tCoordComponents=f,t.blockSize+=f,c=a.tcoords.getData()),a.colors?(t.colorComponents=a.colors.getNumberOfComponents(),t.colorOffset=0,u=a.colors.getData(),t.colorBO||(t.colorBO=zl.newInstance()),t.colorBO.setOpenGLRenderWindow(t.openGLRenderWindow)):t.colorBO=null,t.stride=4*t.blockSize;let p,m=0,g=0,h=0,A=0,v=0,y=0;const b={anythingToPoints(e,t,n){for(let r=0;r<e;++r)p(t[n+r])},linesToWireframe(e,t,n){for(let r=0;r<e-1;++r)p(t[n+r]),p(t[n+r+1])},polysToWireframe(e,t,n){for(let r=0;r<e;++r)p(t[n+r]),p(t[n+(r+1)%e])},stripsToWireframe(e,t,n){for(let r=0;r<e-1;++r)p(t[n+r]),p(t[n+r+1]);for(let r=0;r<e-2;r++)p(t[n+r]),p(t[n+r+2])},polysToSurface(e,t,n){if(e<3)rc("skipping degenerate triangle");else for(let r=0;r<e-2;r++)p(t[n+0]),p(t[n+r+1]),p(t[n+r+2])},stripsToSurface(e,t,n){for(let r=0;r<e-2;r++)p(t[n+r]),p(t[n+r+1+r%2]),p(t[n+r+1+(r+1)%2])}},T={anythingToPoints:(e,t)=>e,linesToWireframe:(e,t)=>2*(e-1),polysToWireframe:(e,t)=>2*e,stripsToWireframe:(e,t)=>4*e-6,polysToSurface:(e,t)=>e<3?0:3*(e-2),stripsToSurface:(e,t,n)=>3*(e-2)};let x=null,C=null;o===Aa.POINTS||"verts"===r?(x=b.anythingToPoints,C=T.anythingToPoints):o===Aa.WIREFRAME||"lines"===r?(x=b[r+"ToWireframe"],C=T[r+"ToWireframe"]):(x=b[r+"ToSurface"],C=T[r+"ToSurface"]);const E=n.getData(),M=E.length;let S=0;for(let e=0;e<M;)S+=C(E[e],E),e+=E[e]+1;let w=null;const R=new Float32Array(S*t.blockSize);u&&(w=new Uint8Array(4*S));let P=0,O=0,I=0,D=0;for(let e=0;e<3;++e){const t=a.points.getRange(e),n=t[1]-t[0];I+=n*n;const r=.5*(t[1]+t[0]);D+=r*r}if(I>0&&(Math.abs(D)/I>1e6||Math.abs(Math.log10(I))>3||0===I&&D>1e6)){const t=i.create(),n=i.create();for(let e=0;e<3;++e){const r=a.points.getRange(e),o=r[1]-r[0];t[e]=.5*(r[1]+r[0]),n[e]=o>0?1/o:1}e.setCoordShiftAndScale(t,n)}else!0===t.coordShiftAndScaleEnabled&&e.setCoordShiftAndScale(null,null);p=function(e){if(m=3*e,t.coordShiftAndScaleEnabled?(R[P++]=(s[m++]-t.coordShift[0])*t.coordScale[0],R[P++]=(s[m++]-t.coordShift[1])*t.coordScale[1],R[P++]=(s[m++]-t.coordShift[2])*t.coordScale[2]):(R[P++]=s[m++],R[P++]=s[m++],R[P++]=s[m++]),null!==l&&(g=a.haveCellNormals?3*(y+a.cellOffset):3*e,R[P++]=l[g++],R[P++]=l[g++],R[P++]=l[g++]),t.customData.forEach(t=>{v=e*t.components;for(let e=0;e<t.components;++e)R[P++]=t.data[v++]}),null!==c){h=e*f;for(let e=0;e<f;++e)R[P++]=c[h++]}null!==u&&(A=a.haveCellScalars?(y+a.cellOffset)*d:e*d,w[O++]=u[A++],w[O++]=u[A++],w[O++]=u[A++],w[O++]=4===d?u[A++]:255)};for(let e=0;e<M;)x(E[e],E,e+1),e+=E[e]+1,y++;return t.elementCount=S,e.upload(R,Bl.ARRAY_BUFFER),t.colorBO&&(t.colorBOStride=4,t.colorBO.upload(w,Bl.ARRAY_BUFFER)),y},e.setCoordShiftAndScale=(e,n)=>{null===e||e.constructor===Float32Array&&3===e.length?null===n||n.constructor===Float32Array&&3===n.length?(null!==t.coordShift&&null!==e&&i.equals(e,t.coordShift)||(t.coordShift=e),null!==t.coordScale&&null!==n&&i.equals(n,t.coordScale)||(t.coordScale=n),t.coordShiftAndScaleEnabled=function(e,t){return null!==e&&null!==t&&!(i.exactEquals(e,[0,0,0])&&i.exactEquals(t,[1,1,1]))}(t.coordShift,t.coordScale),t.coordShiftAndScaleEnabled?t.inverseShiftAndScaleMatrix=function(e,t){const n=i.create();i.inverse(n,t);const r=a.create();return a.fromRotationTranslationScale(r,l.create(),e,n),r}(t.coordShift,t.coordScale):t.inverseShiftAndScaleMatrix=null):oc("Wrong type for coordScale, expected vec3 or null"):oc("Wrong type for coordShift, expected vec3 or null")}}const ic={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function sc(e,t,n={}){Object.assign(t,ic,n),zl.extend(e,t,n),C.default.setGet(e,t,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),C.default.get(e,t,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),ac(e,t)}var lc={newInstance:C.default.newInstance(sc),extend:sc};const{vtkErrorMacro:cc}=C.default;const uc={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function dc(e,t,n={}){Object.assign(t,uc,n),C.default.obj(e,t),C.default.setGet(e,t,["shaderType","source","error","handle","context"]),function(e,t){t.classHierarchy.push("vtkShader"),e.compile=()=>{let e=t.context.VERTEX_SHADER;if(!t.source||!t.source.length||"Unknown"===t.shaderType)return!1;switch(0!==t.handle&&(t.context.deleteShader(t.handle),t.handle=0),t.shaderType){case"Fragment":e=t.context.FRAGMENT_SHADER;break;case"Vertex":default:e=t.context.VERTEX_SHADER}t.handle=t.context.createShader(e),t.context.shaderSource(t.handle,t.source),t.context.compileShader(t.handle);if(!t.context.getShaderParameter(t.handle,t.context.COMPILE_STATUS)){const e=t.context.getShaderInfoLog(t.handle);return cc(`Error compiling shader '${t.source}': ${e}`),t.context.deleteShader(t.handle),t.handle=0,!1}return!0},e.cleanup=()=>{"Unknown"!==t.shaderType&&0!==t.handle&&(t.context.deleteShader(t.handle),t.handle=0,t.dirty=!0)}}(e,t)}var fc={newInstance:C.default.newInstance(dc,"vtkShader"),extend:dc};const{vtkErrorMacro:pc}=C.default;const mc={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function gc(e,t,n={}){Object.assign(t,mc,n),t.attributesLocs={},t.uniformLocs={},t.vertexShader=fc.newInstance(),t.vertexShader.setShaderType("Vertex"),t.fragmentShader=fc.newInstance(),t.fragmentShader.setShaderType("Fragment"),t.geometryShader=fc.newInstance(),t.geometryShader.setShaderType("Geometry"),C.default.obj(e,t),C.default.get(e,t,["lastCameraMTime"]),C.default.setGet(e,t,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),function(e,t){t.classHierarchy.push("vtkShaderProgram"),e.compileShader=()=>t.vertexShader.compile()?t.fragmentShader.compile()?e.attachShader(t.vertexShader)&&e.attachShader(t.fragmentShader)?e.link()?(e.setCompiled(!0),1):(pc("Links failed: "+t.error),0):(pc(t.error),0):(pc(t.fragmentShader.getSource().split("\n").map((e,t)=>`${t}: ${e}`).join("\n")),pc(t.fragmentShader.getError()),0):(pc(t.vertexShader.getSource().split("\n").map((e,t)=>`${t}: ${e}`).join("\n")),pc(t.vertexShader.getError()),0),e.cleanup=()=>{"Unknown"!==t.shaderType&&0!==t.handle&&(t.context.deleteShader(t.handle),t.handle=0)},e.bind=()=>!(!t.linked&&!e.link())&&(t.context.useProgram(t.handle),e.setBound(!0),!0),e.isBound=()=>!!t.bound,e.release=()=>{t.context.useProgram(null),e.setBound(!1)},e.setContext=e=>{t.vertexShader.setContext(e),t.fragmentShader.setContext(e),t.geometryShader.setContext(e)},e.link=()=>{if(t.inked)return!0;if(0===t.handle)return t.error="Program has not been initialized, and/or does not have shaders.",!1;t.uniformLocs={},t.context.linkProgram(t.handle);if(!t.context.getProgramParameter(t.handle,t.context.LINK_STATUS)){const e=t.context.getProgramInfoLog(t.handle);return pc("Error linking shader "+e),t.handle=0,!1}return e.setLinked(!0),t.attributeLocs={},!0},e.setUniformMatrix=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniformMatrix4fv(o,!1,r),!0)},e.setUniformMatrix3x3=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniformMatrix3fv(o,!1,r),!0)},e.setUniformf=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1f(o,r),!0)},e.setUniformfv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1fv(o,r),!0)},e.setUniformi=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1i(o,r),!0)},e.setUniformiv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1iv(o,r),!0)},e.setUniform2f=(n,r,o)=>{const a=e.findUniform(n);if(-1===a)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(void 0===o)throw new RangeError("Invalid number of values for array");return t.context.uniform2f(a,r,o),!0},e.setUniform2fv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform2fv(o,r),!0)},e.setUniform2i=(n,r,o)=>{const a=e.findUniform(n);if(-1===a)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(void 0===o)throw new RangeError("Invalid number of values for array");return t.context.uniform2i(a,r,o),!0},e.setUniform2iv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform2iv(o,r),!0)},e.setUniform3f=(n,r,o,a)=>{const i=e.findUniform(n);if(-1===i)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(void 0===a)throw new RangeError("Invalid number of values for array");return t.context.uniform3f(i,r,o,a),!0},e.setUniform3fArray=(n,r)=>{const o=e.findUniform(n);if(-1===o)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||3!==r.length)throw new RangeError("Invalid number of values for array");return t.context.uniform3f(o,r[0],r[1],r[2]),!0},e.setUniform3fv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform3fv(o,r),!0)},e.setUniform3i=(n,...r)=>{const o=e.findUniform(n);if(-1===o)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;let a=r;if(1===a.length&&Array.isArray(a[0])&&(a=a[0]),3!==a.length)throw new RangeError("Invalid number of values for array");return t.context.uniform3i(o,a[0],a[1],a[2]),!0},e.setUniform3iv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform3iv(o,r),!0)},e.setUniform4f=(n,...r)=>{const o=e.findUniform(n);if(-1===o)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;let a=r;if(1===a.length&&Array.isArray(a[0])&&(a=a[0]),4!==a.length)throw new RangeError("Invalid number of values for array");return t.context.uniform4f(o,a[0],a[1],a[2],a[3]),!0},e.setUniform4fv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform4fv(o,r),!0)},e.setUniform4i=(n,...r)=>{const o=e.findUniform(n);if(-1===o)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;let a=r;if(1===a.length&&Array.isArray(a[0])&&(a=a[0]),4!==a.length)throw new RangeError("Invalid number of values for array");return t.context.uniform4i(o,a[0],a[1],a[2],a[3]),!0},e.setUniform4iv=(n,r)=>{const o=e.findUniform(n);return-1===o?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform4iv(o,r),!0)},e.setUniform4fv=(n,r,o)=>{const a=e.findUniform(n);return-1===a?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform4fv(a,o),!0)},e.findUniform=e=>{if(!e||!t.linked)return-1;let n=t.uniformLocs[e];return void 0!==n?n:(n=t.context.getUniformLocation(t.handle,e),null===n?(t.error=`Uniform ${e} not found in current shader program.`,t.uniformLocs[e]=-1,-1):(t.uniformLocs[e]=n,n))},e.isUniformUsed=e=>{if(!e)return!1;let n=t.uniformLocs[e];return void 0!==n?null!==n:t.linked?(n=t.context.getUniformLocation(t.handle,e),t.uniformLocs[e]=n,null!==n):(pc("attempt to find uniform when the shader program is not linked"),!1)},e.isAttributeUsed=e=>{if(!e)return!1;let n=Object.keys(t.attributeLocs).indexOf(e);return-1!==n||(t.linked?(n=t.context.getAttribLocation(t.handle,e),-1!==n&&(t.attributeLocs[e]=n,!0)):(pc("attempt to find uniform when the shader program is not linked"),!1))},e.attachShader=n=>{if(0===n.getHandle())return t.error="Shader object was not initialized, cannot attach it.",!1;if("Unknown"===n.getShaderType())return t.error="Shader object is of type Unknown and cannot be used.",!1;if(0===t.handle){const e=t.context.createProgram();if(0===e)return t.error="Could not create shader program.",!1;t.handle=e,t.linked=!1}return"Vertex"===n.getShaderType()&&(0!==t.vertexShaderHandle&&t.comntext.detachShader(t.handle,t.vertexShaderHandle),t.vertexShaderHandle=n.getHandle()),"Fragment"===n.getShaderType()&&(0!==t.fragmentShaderHandle&&t.context.detachShader(t.handle,t.fragmentShaderHandle),t.fragmentShaderHandle=n.getHandle()),t.context.attachShader(t.handle,n.getHandle()),e.setLinked(!1),!0},e.detachShader=e=>{if(0===e.getHandle())return t.error="shader object was not initialized, cannot attach it.",!1;if("Unknown"===e.getShaderType())return t.error="Shader object is of type Unknown and cannot be used.",!1;switch(0===t.handle&&(t.error="This shader program has not been initialized yet."),e.getShaderType()){case"Vertex":return t.vertexShaderHandle!==e.getHandle()?(t.error="The supplied shader was not attached to this program.",!1):(t.context.detachShader(t.handle,e.getHandle()),t.vertexShaderHandle=0,t.linked=!1,!0);case"Fragment":return t.fragmentShaderHandle!==e.getHandle()?(t.error="The supplied shader was not attached to this program.",!1):(t.context.detachShader(t.handle,e.getHandle()),t.fragmentShaderHandle=0,t.linked=!1,!0);default:return!1}},e.setContext=e=>{t.context=e,t.vertexShader.setContext(e),t.fragmentShader.setContext(e),t.geometryShader.setContext(e)},e.setLastCameraMTime=e=>{t.lastCameraMTime=e}}(e,t)}var hc={newInstance:C.default.newInstance(gc,"vtkShaderProgram"),extend:gc,substitute:function(e,t,n,r=!0){const o=Array.isArray(n)?n.join("\n"):n;let a=!1;-1!==e.search(t)&&(a=!0);let i="";r&&(i="g");const s=new RegExp(t,i);return{replace:a,result:e.replace(s,o)}}};const Ac={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null,openGLRenderWindow:null};function vc(e,t,n={}){Object.assign(t,Ac,n),t.buffers=[],C.default.obj(e,t),C.default.get(e,t,["supported"]),C.default.setGet(e,t,["forceEmulation"]),function(e,t){t.classHierarchy.push("vtkOpenGLVertexArrayObject"),e.exposedMethod=()=>{},e.initialize=()=>{t.instancingExtension=null,t.openGLRenderWindow.getWebgl2()||(t.instancingExtension=t.context.getExtension("ANGLE_instanced_arrays")),!t.forceEmulation&&t.openGLRenderWindow&&t.openGLRenderWindow.getWebgl2()?(t.extension=null,t.supported=!0,t.handleVAO=t.context.createVertexArray()):(t.extension=t.context.getExtension("OES_vertex_array_object"),!t.forceEmulation&&t.extension?(t.supported=!0,t.handleVAO=t.extension.createVertexArrayOES()):t.supported=!1)},e.isReady=()=>0!==t.handleVAO||!1===t.supported,e.bind=()=>{if(e.isReady()||e.initialize(),e.isReady()&&t.supported)t.extension?t.extension.bindVertexArrayOES(t.handleVAO):t.context.bindVertexArray(t.handleVAO);else if(e.isReady()){const e=t.context;for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];t.context.bindBuffer(e.ARRAY_BUFFER,r.buffer);for(let n=0;n<r.attributes.length;++n){const o=r.attributes[n],a=o.isMatrix?o.size:1;for(let n=0;n<a;++n)e.enableVertexAttribArray(o.index+n),e.vertexAttribPointer(o.index+n,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*n/o.size),o.divisor>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(o.index+n,1):e.vertexAttribDivisor(o.index+n,1))}}}},e.release=()=>{if(e.isReady()&&t.supported)t.extension?t.extension.bindVertexArrayOES(null):t.context.bindVertexArray(null);else if(e.isReady()){const e=t.context;for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];t.context.bindBuffer(e.ARRAY_BUFFER,r.buffer);for(let n=0;n<r.attributes.length;++n){const o=r.attributes[n],a=o.isMatrix?o.size:1;for(let n=0;n<a;++n)e.enableVertexAttribArray(o.index+n),e.vertexAttribPointer(o.index+n,o.size,o.type,o.normalize,o.stride,o.offset+o.stride*n/o.size),o.divisor>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(o.index+n,0):e.vertexAttribDivisor(o.index+n,0)),e.disableVertexAttribArray(o.index+n)}}}},e.shaderProgramChanged=()=>{e.release(),t.handleVAO&&(t.extension?t.extension.deleteVertexArrayOES(t.handleVAO):t.context.deleteVertexArray(t.handleVAO)),t.handleVAO=0,t.handleProgram=0},e.releaseGraphicsResources=()=>{e.shaderProgramChanged(),t.handleVAO&&(t.extension?t.extension.deleteVertexArrayOES(t.handleVAO):t.context.deleteVertexArray(t.handleVAO)),t.handleVAO=0,t.supported=!0,t.handleProgram=0},e.addAttributeArray=(t,n,r,o,a,i,s,l)=>e.addAttributeArrayWithDivisor(t,n,r,o,a,i,s,l,0,!1),e.addAttributeArrayWithDivisor=(n,r,o,a,i,s,l,c,u,d)=>{if(!n)return!1;if(!n.isBound()||0===r.getHandle()||r.getType()!==Bl.ARRAY_BUFFER)return!1;if(0===t.handleProgram&&(t.handleProgram=n.getHandle()),e.isReady()||e.initialize(),!e.isReady()||t.handleProgram!==n.getHandle())return!1;const f=t.context,p={};if(p.name=o,p.index=f.getAttribLocation(t.handleProgram,o),p.offset=a,p.stride=i,p.type=s,p.size=l,p.normalize=c,p.isMatrix=d,p.divisor=u,-1===p.Index)return!1;if(r.bind(),f.enableVertexAttribArray(p.index),f.vertexAttribPointer(p.index,p.size,p.type,p.normalize,p.stride,p.offset),u>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(p.index,1):f.vertexAttribDivisor(p.index,1)),p.buffer=r.getHandle(),!t.supported){let e=!1;for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];if(r.buffer===p.buffer){e=!0;let t=!1;for(let e=0;e<r.attributes.length;++e){r.attributes[e].name===o&&(t=!0,r.attributes[e]=p)}t||r.attributes.push(p)}}e||t.buffers.push({buffer:p.buffer,attributes:[p]})}return!0},e.addAttributeMatrixWithDivisor=(n,r,o,a,i,s,l,c,u)=>{const d=e.addAttributeArrayWithDivisor(n,r,o,a,i,s,l,c,u,!0);if(!d)return d;const f=t.context,p=f.getAttribLocation(t.handleProgram,o);for(let e=1;e<l;e++)f.enableVertexAttribArray(p+e),f.vertexAttribPointer(p+e,l,s,c,i,a+i*e/l),u>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(p+e,1):f.vertexAttribDivisor(p+e,1));return!0},e.removeAttributeArray=n=>{if(!e.isReady()||0===t.handleProgram)return!1;if(!t.supported)for(let e=0;e<t.buffers.length;++e){const r=t.buffers[e];for(let o=0;o<r.attributes.length;++o){if(r.attributes[o].name===n)return r.attributes.splice(o,1),r.attributes.length||t.buffers.splice(e,1),!0}}return!0},e.setOpenGLRenderWindow=n=>{t.openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t.openGLRenderWindow=n,t.context=null,n&&(t.context=t.openGLRenderWindow.getContext()))}}(e,t)}var yc={newInstance:C.default.newInstance(vc,"vtkOpenGLVertexArrayObject"),extend:vc};const bc={program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0};function Tc(e,t,n={}){Object.assign(t,bc,n),C.default.obj(e,t),t.shaderSourceTime={},C.default.obj(t.shaderSourceTime),t.attributeUpdateTime={},C.default.obj(t.attributeUpdateTime),C.default.setGet(e,t,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType"]),t.program=hc.newInstance(),t.VAO=yc.newInstance(),t.CABO=lc.newInstance(),function(e,t){t.classHierarchy.push("vtkOpenGLHelper"),e.setOpenGLRenderWindow=e=>{t.program.setContext(e.getContext()),t.VAO.setOpenGLRenderWindow(e),t.CABO.setOpenGLRenderWindow(e)},e.releaseGraphicsResources=e=>{t.VAO.releaseGraphicsResources(),t.CABO.releaseGraphicsResources(),t.CABO.setElementCount(0)}}(e,t)}var xc={newInstance:C.default.newInstance(Tc),extend:Tc},Cc=n(8),Ec=n.n(Cc),Mc=n(5),Sc=n.n(Mc);var wc={implementReplaceShaderCoincidentOffset:function(e,t,n={}){e.replaceShaderCoincidentOffset=(n,r,o)=>{const a=e.getCoincidentParameters(r,o);if(a&&(0!==a.factor||0!==a.offset)){let e=n.Fragment;e=hc.substitute(e,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,t.context.getExtension("EXT_frag_depth")&&(0!==a.factor?(e=hc.substitute(e,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,e=hc.substitute(e,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):e=hc.substitute(e,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),t.openGLRenderWindow.getWebgl2()&&(0!==a.factor?(e=hc.substitute(e,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,e=hc.substitute(e,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):e=hc.substitute(e,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=e}}}};const Rc={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6},{Representation:Pc,Shading:Oc}=Ea,{ScalarMode:Ic}=ki,{Filter:Dc,Wrap:Vc}=hl,{vtkErrorMacro:Lc}=C.default,_c={type:"StartEvent"},Fc={type:"EndEvent"};const Nc={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightHalfAngle:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1};function Bc(e,t,n={}){Object.assign(t,Nc,n),sl.extend(e,t,n),wc.implementReplaceShaderCoincidentOffset(e,t,n),t.primitives=[],t.primTypes=Rc,t.tmpMat3=o.create(),t.tmpMat4=a.create();for(let e=Rc.Start;e<Rc.End;e++)t.primitives[e]=xc.newInstance(),t.primitives[e].setPrimitiveType(e),t.primitives[e].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);C.default.setGet(e,t,["context"]),t.VBOBuildTime={},C.default.obj(t.VBOBuildTime,{mtime:0}),function(e,t){function n(e,t,n){return t.identity(n),e.reduce((e,n,r)=>0===r?n?t.copy(e,n):t.identity(e):n?t.multiply(e,e,n):e,n)}t.classHierarchy.push("vtkOpenGLPolyDataMapper"),e.buildPass=n=>{n&&(t.openGLActor=e.getFirstAncestorOfType("vtkOpenGLActor"),t.openGLRenderer=t.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),t.openGLRenderWindow=t.openGLRenderer.getParent(),t.openGLCamera=t.openGLRenderer.getViewNodeFor(t.openGLRenderer.getRenderable().getActiveCamera()))},e.translucentPass=t=>{t&&e.render()},e.opaqueZBufferPass=n=>{n&&(t.haveSeenDepthRequest=!0,t.renderDepth=!0,e.render(),t.renderDepth=!1)},e.opaquePass=t=>{t&&e.render()},e.render=()=>{const n=t.openGLRenderWindow.getContext();if(t.context!==n){t.context=n;for(let e=Rc.Start;e<Rc.End;e++)t.primitives[e].setOpenGLRenderWindow(t.openGLRenderWindow)}const r=t.openGLActor.getRenderable(),o=t.openGLRenderer.getRenderable();e.renderPiece(o,r)},e.buildShaders=(n,r,o)=>{e.getShaderTemplate(n,r,o);const a=t.renderable.getViewSpecificProperties().OpenGL;let i=null;if(a&&(i=a.ShaderReplacements),i)for(let e=0;e<i.length;e++){const t=i[e];if(t.replaceFirst){const e=t.shaderType,r=n[e],o=hc.substitute(r,t.originalValue,t.replacementValue,t.replaceAll);n[e]=o.result}}if(e.replaceShaderValues(n,r,o),i)for(let e=0;e<i.length;e++){const t=i[e];if(!t.replaceFirst){const e=t.shaderType,r=n[e],o=hc.substitute(r,t.originalValue,t.replacementValue,t.replaceAll);n[e]=o.result}}},e.getShaderTemplate=(e,n,r)=>{const o=t.renderable.getViewSpecificProperties().OpenGL;let a=Ec.a;if(o){const e=o.VertexShaderCode;void 0!==e&&""!==e&&(a=e)}e.Vertex=a;let i=Sc.a;if(o){const e=o.FragmentShaderCode;void 0!==e&&""!==e&&(i=e)}e.Fragment=i;let s="";if(o){const e=o.GeometryShaderCode;void 0!==e&&(s=e)}e.Geometry=s},e.replaceShaderColor=(e,n,r)=>{let o=e.Vertex,a=e.Geometry,i=e.Fragment;const s=t.lastBoundBO.getReferenceByName("lastLightComplexity");let l=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];s&&(l=l.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let c=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];s&&(c=c.concat(["  vec3 specularColor;","  float specularPower;"])),c=c.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),s&&(c=c.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),0===t.lastBoundBO.getCABO().getColorComponents()||t.drawingEdges||(l=l.concat(["varying vec4 vertexColorVSOutput;"]),o=hc.substitute(o,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,o=hc.substitute(o,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,a=hc.substitute(a,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,a=hc.substitute(a,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),i=0===t.lastBoundBO.getCABO().getColorComponents()||t.drawingEdges?t.renderable.getInterpolateScalarsBeforeMapping()&&t.renderable.getColorCoordinates()&&!t.drawingEdges?hc.substitute(i,"//VTK::Color::Impl",c.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:hc.substitute(i,"//VTK::Color::Impl",c).result:hc.substitute(i,"//VTK::Color::Impl",c.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result,i=hc.substitute(i,"//VTK::Color::Dec",l).result,e.Vertex=o,e.Geometry=a,e.Fragment=i},e.replaceShaderLight=(e,n,r)=>{let o=e.Fragment;const a=t.lastBoundBO.getReferenceByName("lastLightComplexity"),i=t.lastBoundBO.getReferenceByName("lastLightCount");let s=[];switch(a){case 0:o=hc.substitute(o,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:o=hc.substitute(o,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let e=0;e<i;++e)s=s.concat([`uniform vec3 lightColor${e};`,`uniform vec3 lightDirectionVC${e}; // normalized`,`uniform vec3 lightHalfAngleVC${e}; // normalized`]);o=hc.substitute(o,"//VTK::Light::Dec",s).result,s=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let e=0;e<i;++e)s=s.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${e}));`,`  diffuseL += ((df) * lightColor${e});`,`  if (dot(normalVCVSOutput, lightDirectionVC${e}) < 0.0)`,"    {",`    float sf = pow( max(0.0, dot(lightHalfAngleVC${e},normalVCVSOutput)), specularPower);`,`    specularL += ((sf) * lightColor${e});`,"    }"]);s=s.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=hc.substitute(o,"//VTK::Light::Impl",s,!1).result;break;case 3:for(let e=0;e<i;++e)s=s.concat([`uniform vec3 lightColor${e};`,`uniform vec3 lightDirectionVC${e}; // normalized`,`uniform vec3 lightHalfAngleVC${e}; // normalized`,`uniform vec3 lightPositionVC${e};`,`uniform vec3 lightAttenuation${e};`,`uniform float lightConeAngle${e};`,`uniform float lightExponent${e};`,`uniform int lightPositional${e};`]);o=hc.substitute(o,"//VTK::Light::Dec",s).result,s=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let e=0;e<i;++e)s=s.concat(["  attenuation = 1.0;",`  if (lightPositional${e} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${e};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${e};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${e}.x`,`       + lightAttenuation${e}.y * distanceVC`,`       + lightAttenuation${e}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${e} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${e});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${e})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${e});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df) * lightColor${e});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = attenuation*pow( max(0.0, dot(lightHalfAngleVC${e},normalVCVSOutput)), specularPower);`,`    specularL += ((sf) * lightColor${e});`,"    }"]);s=s.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),o=hc.substitute(o,"//VTK::Light::Impl",s,!1).result;break;default:Lc("bad light complexity")}e.Fragment=o},e.replaceShaderNormal=(n,r,o)=>{if(t.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let r=n.Vertex,a=n.Geometry,i=n.Fragment;t.lastBoundBO.getCABO().getNormalOffset()?(r=hc.substitute(r,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,r=hc.substitute(r,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,a=hc.substitute(a,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,a=hc.substitute(a,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,i=hc.substitute(i,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,i=hc.substitute(i,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):t.haveCellNormals?(i=hc.substitute(i,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,i=hc.substitute(i,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.getOpenGLMode(o.getProperty().getRepresentation(),t.lastBoundBO.getPrimitiveType())===t.context.LINES?(i=hc.substitute(i,"//VTK::UniformFlow::Impl",["  vec3 fdx = vec3(dFdx(vertexVC.x),dFdx(vertexVC.y),dFdx(vertexVC.z));","  vec3 fdy = vec3(dFdy(vertexVC.x),dFdy(vertexVC.y),dFdy(vertexVC.z));","  //VTK::UniformFlow::Impl"]).result,i=hc.substitute(i,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  fdx = normalize(fdx);","  fdy = normalize(fdy);","  if (abs(fdx.x) > 0.0)","    { normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(i=hc.substitute(i,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,i=hc.substitute(i,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,i=hc.substitute(i,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),n.Vertex=r,n.Geometry=a,n.Fragment=i}},e.replaceShaderPositionVC=(e,n,r)=>{let o=e.Vertex,a=e.Geometry,i=e.Fragment;r.getProperty().getRepresentation()!==Pc.POINTS&&t.lastBoundBO.getPrimitiveType()!==Rc.Points||(o=hc.substitute(o,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl",`  gl_PointSize = ${r.getProperty().getPointSize()}.0;`],!1).result);t.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(o=hc.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=hc.substitute(o,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,o=hc.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,a=hc.substitute(a,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,a=hc.substitute(a,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,i=hc.substitute(i,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,i=hc.substitute(i,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(o=hc.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=hc.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),e.Vertex=o,e.Geometry=a,e.Fragment=i},e.replaceShaderTCoord=(e,n,r)=>{if(t.lastBoundBO.getCABO().getTCoordOffset()){let n=e.Vertex,r=e.Geometry,o=e.Fragment;if(t.drawingEdges)return;n=hc.substitute(n,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const a=t.openGLActor.getActiveTextures();let i=2,s=2;if(a&&a.length>0&&(i=a[0].getComponents(),a[0].getTarget()===t.context.TEXTURE_CUBE_MAP&&(s=3)),t.renderable.getColorTextureMap()&&(i=t.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),s=2),2===s){if(n=hc.substitute(n,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,r=hc.substitute(r,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,r=hc.substitute(r,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=hc.substitute(o,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,a&&a.length>=1)switch(i){case 1:o=hc.substitute(o,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","gl_FragData[0] = clamp(gl_FragData[0],0.0,1.0)*","  vec4(tcolor.r,tcolor.r,tcolor.r,1.0);"]).result;break;case 2:o=hc.substitute(o,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","gl_FragData[0] = clamp(gl_FragData[0],0.0,1.0)*","  vec4(tcolor.r,tcolor.r,tcolor.r,tcolor.g);"]).result;break;default:o=hc.substitute(o,"//VTK::TCoord::Impl","gl_FragData[0] = clamp(gl_FragData[0],0.0,1.0)*texture2D(texture1, tcoordVCVSOutput.st);").result}}else switch(n=hc.substitute(n,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,r=hc.substitute(r,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,r=hc.substitute(r,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=hc.substitute(o,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,i){case 1:o=hc.substitute(o,"//VTK::TCoord::Impl",["vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","gl_FragData[0] = clamp(gl_FragData[0],0.0,1.0)*","  vec4(tcolor.r,tcolor.r,tcolor.r,1.0);"]).result;break;case 2:o=hc.substitute(o,"//VTK::TCoord::Impl",["vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","gl_FragData[0] = clamp(gl_FragData[0],0.0,1.0)*","  vec4(tcolor.r,tcolor.r,tcolor.r,tcolor.g);"]).result;break;default:o=hc.substitute(o,"//VTK::TCoord::Impl","gl_FragData[0] = clamp(gl_FragData[0],0.0,1.0)*textureCube(texture1, tcoordVCVSOutput);").result}e.Vertex=n,e.Geometry=r,e.Fragment=o}},e.replaceShaderClip=(e,n,r)=>{let o=e.Vertex,a=e.Fragment;if(t.renderable.getNumberOfClippingPlanes()){let e=t.renderable.getNumberOfClippingPlanes();e>6&&(C.default.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),e=6),o=hc.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=hc.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,a=hc.substitute(a,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,a=hc.substitute(a,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}e.Vertex=o,e.Fragment=a},e.getCoincidentParameters=(e,n)=>{let r=null;const o=n.getProperty();if(t.renderable.getResolveCoincidentTopology()||o.getEdgeVisibility()&&o.getRepresentation()===Pc.SURFACE){const e=t.lastBoundBO.getPrimitiveType();e===Rc.Points||o.getRepresentation()===Pc.POINTS?r=t.renderable.getCoincidentTopologyPointOffsetParameter():e===Rc.Lines||o.getRepresentation()===Pc.WIREFRAME?r=t.renderable.getCoincidentTopologyLineOffsetParameters():e!==Rc.Tris&&e!==Rc.TriStrips||(r=t.renderable.getCoincidentTopologyPolygonOffsetParameters()),e!==Rc.TrisEdges&&e!==Rc.TriStripsEdges||(r=t.renderable.getCoincidentTopologyPolygonOffsetParameters(),r.factor/=2,r.offset/=2)}return r},e.replaceShaderPicking=(e,t,n)=>{let r=e.Fragment;r=hc.substitute(r,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,r=hc.substitute(r,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,e.Fragment=r},e.replaceShaderValues=(n,r,o)=>{if(e.replaceShaderColor(n,r,o),e.replaceShaderNormal(n,r,o),e.replaceShaderLight(n,r,o),e.replaceShaderTCoord(n,r,o),e.replaceShaderPicking(n,r,o),e.replaceShaderClip(n,r,o),e.replaceShaderCoincidentOffset(n,r,o),e.replaceShaderPositionVC(n,r,o),t.haveSeenDepthRequest){let e=n.Fragment;e=hc.substitute(e,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,e=hc.substitute(e,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=e}},e.getNeedToRebuildShaders=(n,r,o)=>{let a=0,i=0;const s=n.getPrimitiveType(),l=t.currentInput;let c=!1;const u=l.getPointData().getNormals(),d=l.getCellData().getNormals(),f=o.getProperty().getInterpolation()===Oc.FLAT,p=o.getProperty().getRepresentation(),m=e.getOpenGLMode(p,s);if(m===t.context.TRIANGLES||d&&!u||!f&&u?c=!0:f||m!==t.context.LINES||(c=!0),o.getProperty().getLighting()&&c){a=0;const e=r.getLightsByReference();for(let t=0;t<e.length;++t){const n=e[t];n.getSwitch()>0&&(i++,0===a&&(a=1)),1===a&&(i>1||1!==n.getIntensity()||!n.lightTypeIsHeadLight())&&(a=2),a<3&&n.getPositional()&&(a=3)}}let g=!1;const h=t.lastBoundBO.getReferenceByName("lastLightComplexity"),A=t.lastBoundBO.getReferenceByName("lastLightCount");return h===a&&A===i||(t.lastBoundBO.set({lastLightComplexity:a},!0),t.lastBoundBO.set({lastLightCount:i},!0),g=!0),!!(t.lastHaveSeenDepthRequest!==t.haveSeenDepthRequest||0===n.getProgram()||n.getShaderSourceTime().getMTime()<e.getMTime()||n.getShaderSourceTime().getMTime()<o.getMTime()||n.getShaderSourceTime().getMTime()<t.renderable.getMTime()||n.getShaderSourceTime().getMTime()<t.currentInput.getMTime()||g)&&(t.lastHaveSeenDepthRequest=t.haveSeenDepthRequest,!0)},e.updateShaders=(n,r,o)=>{if(t.lastBoundBO=n,e.getNeedToRebuildShaders(n,r,o)){const a={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(a,r,o);const i=t.openGLRenderWindow.getShaderCache().readyShaderProgramArray(a.Vertex,a.Fragment,a.Geometry);i!==n.getProgram()&&(n.setProgram(i),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t.openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,o),e.setPropertyShaderParameters(n,r,o),e.setCameraShaderParameters(n,r,o),e.setLightingShaderParameters(n,r,o);const a=t.renderable.getViewSpecificProperties().ShadersCallbacks;a&&a.forEach(e=>{e.callback(e.userData,n,r,o)})},e.setMapperShaderParameters=(n,r,o)=>{if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",t.primitiveIDOffset),n.getCABO().getElementCount()&&(t.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){const e=t.lastBoundBO.getReferenceByName("lastLightComplexity");n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,!1)||Lc("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("normalMC")&&n.getCABO().getNormalOffset()&&e>0?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"normalMC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),t.context.FLOAT,3,!1)||Lc("Error setting normalMC in shader VAO."):n.getVAO().removeAttributeArray("normalMC"),t.renderable.getCustomShaderAttributes().forEach((e,r)=>{n.getProgram().isAttributeUsed(e+"MC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),e+"MC",n.getCABO().getCustomData()[r].offset,n.getCABO().getStride(),t.context.FLOAT,n.getCABO().getCustomData()[r].components,!1)||Lc(`Error setting ${e}MC in shader VAO.`))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),t.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||Lc("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),n.getProgram().isAttributeUsed("scalarColor")&&n.getCABO().getColorComponents()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"scalarColor",n.getCABO().getColorOffset(),n.getCABO().getColorBOStride(),t.context.UNSIGNED_BYTE,4,!0)||Lc("Error setting scalarColor in shader VAO."):n.getVAO().removeAttributeArray("scalarColor"),n.getAttributeUpdateTime().modified()}if(t.renderable.getNumberOfClippingPlanes()){let e=t.renderable.getNumberOfClippingPlanes();e>6&&(C.default.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),e=6);const r=[];for(let n=0;n<e;n++){const e=[];t.renderable.getClippingPlaneInDataCoords(o.getMatrix(),n,e);for(let t=0;t<4;t++)r.push(e[t])}n.getProgram().setUniformi("numClipPlanes",e),n.getProgram().setUniform4fv("clipPlanes",6,r)}t.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",t.internalColorTexture.getTextureUnit());const a=t.openGLActor.getActiveTextures();if(a)for(let e=0;e<a.length;++e){const t=a[e].getTextureUnit(),r="texture"+(t+1);n.getProgram().isUniformUsed(r)&&n.getProgram().setUniformi(r,t)}if(t.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",t.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){const t=e.getCoincidentParameters(r,o);n.getProgram().setUniformf("coffset",t.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",t.factor)}const i=t.openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",i?i.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",i?i.getCurrentPass()+1:0)},e.setLightingShaderParameters=(e,n,r)=>{const o=t.lastBoundBO.getReferenceByName("lastLightComplexity");if(o<2)return;const s=e.getProgram();let l=0;const c=n.getLightsByReference();for(let e=0;e<c.length;++e){const r=c[e];if(r.getSwitch()>0){const e=r.getColorByReference(),o=r.getIntensity();t.lightColor[0]=e[0]*o,t.lightColor[1]=e[1]*o,t.lightColor[2]=e[2]*o;const a=r.getDirection(),i=n.getActiveCamera().getViewMatrix(),c=[...a];r.lightTypeIsSceneLight()&&(c[0]=i[0]*a[0]+i[1]*a[1]+i[2]*a[2],c[1]=i[4]*a[0]+i[5]*a[1]+i[6]*a[2],c[2]=i[8]*a[0]+i[9]*a[1]+i[10]*a[2],Yr(c)),t.lightDirection[0]=c[0],t.lightDirection[1]=c[1],t.lightDirection[2]=c[2],t.lightHalfAngle[0]=-t.lightDirection[0],t.lightHalfAngle[1]=-t.lightDirection[1],t.lightHalfAngle[2]=1-t.lightDirection[2],Yr(t.lightDirection),s.setUniform3fArray("lightColor"+l,t.lightColor),s.setUniform3fArray("lightDirectionVC"+l,t.lightDirection),s.setUniform3fArray("lightHalfAngleVC"+l,t.lightHalfAngle),l++}}if(o<3)return;const u=n.getActiveCamera().getViewMatrix();a.transpose(u,u),l=0;for(let e=0;e<c.length;++e){const t=c[e];if(t.getSwitch()>0){const e=t.getTransformedPosition(),n=i.fromValues(e[0],e[1],e[2]);i.transformMat4(n,n,u),s.setUniform3fArray("lightAttenuation"+l,t.getAttenuationValuesByReference()),s.setUniformi("lightPositional"+l,t.getPositional()),s.setUniformf("lightExponent"+l,t.getExponent()),s.setUniformf("lightConeAngle"+l,t.getConeAngle()),s.setUniform3fArray("lightPositionVC"+l,[n[0],n[1],n[2]]),l++}}},e.setCameraShaderParameters=(e,r,i)=>{const s=e.getProgram(),l=t.openGLCamera.getKeyMatrices(r),c=r.getActiveCamera(),u=t.openGLCamera.getKeyMatrixTime().getMTime(),d=s.getLastCameraMTime(),f=e.getCABO().getCoordShiftAndScaleEnabled()?e.getCABO().getInverseShiftAndScaleMatrix():null,p=i.getIsIdentity(),m=p?{mcwc:null,normalMatrix:null}:t.openGLActor.getKeyMatrices();s.setUniformMatrix("MCPCMatrix",n([l.wcpc,m.mcwc,f],a,t.tmpMat4)),s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",n([l.wcvc,m.mcwc,f],a,t.tmpMat4)),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",n([l.normalMatrix,m.normalMatrix],o,t.tmpMat3)),d!==u&&(s.isUniformUsed("cameraParallel")&&s.setUniformi("cameraParallel",c.getParallelProjection()),s.setLastCameraMTime(u)),p||s.setLastCameraMTime(0)},e.setPropertyShaderParameters=(e,n,r)=>{const o=e.getProgram(),a=r.getProperty(),i=a.getOpacity();o.setUniformf("opacityUniform",i);const s=t.drawingEdges?a.getEdgeColorByReference():a.getAmbientColorByReference();o.setUniform3fArray("ambientColorUniform",s),o.setUniformf("ambient",a.getAmbient());const l=t.drawingEdges?a.getEdgeColorByReference():a.getDiffuseColorByReference();o.setUniform3fArray("diffuseColorUniform",l),o.setUniformf("diffuse",a.getDiffuse());if(t.lastBoundBO.getReferenceByName("lastLightComplexity")<1)return;const c=a.getSpecularColorByReference();o.setUniform3fArray("specularColorUniform",c),o.setUniformf("specular",a.getSpecular()),o.setUniformf("specularPowerUniform",a.getSpecularPower())},e.renderPieceStart=(n,r)=>{t.primitiveIDOffset=0,t.openGLRenderer.getSelector()&&(t.openGLRenderer.getSelector().getCurrentPass(),t.openGLRenderer.getSelector().renderProp(r)),e.updateBufferObjects(n,r),t.renderable.getColorTextureMap()&&t.internalColorTexture.activate(),t.lastBoundBO=null},e.renderPieceDraw=(n,r)=>{const o=r.getProperty().getRepresentation(),a=t.context,i=r.getProperty().getEdgeVisibility()&&o===Pc.SURFACE;a.lineWidth(r.getProperty().getLineWidth());for(let s=Rc.Start;s<Rc.End;s++){const l=t.primitives[s].getCABO();if(l.getElementCount()){t.drawingEdges=i&&(s===Rc.TrisEdges||s===Rc.TriStripsEdges);const c=e.getOpenGLMode(o,s);t.drawingEdges&&t.renderDepth||(e.updateShaders(t.primitives[s],n,r),a.drawArrays(c,0,l.getElementCount()));const u=(c===a.POINTS?1:0)||(c===a.LINES?2:3);t.primitiveIDOffset+=l.getElementCount()/u}}a.lineWidth(1)},e.getOpenGLMode=(e,n)=>e===Pc.POINTS||n===Rc.Points?t.context.POINTS:e===Pc.WIREFRAME||n===Rc.Lines||n===Rc.TrisEdges||n===Rc.TriStripsEdges?t.context.LINES:t.context.TRIANGLES,e.renderPieceFinish=(e,n)=>{t.LastBoundBO&&t.LastBoundBO.getVAO().release(),t.renderable.getColorTextureMap()&&t.internalColorTexture.deactivate()},e.renderPiece=(n,r)=>{if(e.invokeEvent(_c),t.renderable.getStatic()||t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.invokeEvent(Fc),!t.currentInput)return void Lc("No input!");if(!t.currentInput.getPoints||!t.currentInput.getPoints().getNumberOfValues())return;const o=t.context,a=r.getProperty().getBackfaceCulling(),i=r.getProperty().getFrontfaceCulling();a||i?i?(t.openGLRenderWindow.enableCullFace(),o.cullFace(o.FRONT)):(t.openGLRenderWindow.enableCullFace(),o.cullFace(o.BACK)):t.openGLRenderWindow.disableCullFace(),e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)},e.computeBounds=(n,r)=>{e.getInput()?t.bounds=e.getInput().getBounds():no(t.bounds)},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>{const o=t.VBOBuildTime.getMTime();return o<e.getMTime()||o<t.renderable.getMTime()||o<r.getMTime()||o<t.currentInput.getMTime()},e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,1);const o=t.renderable.getColorMapColors();t.haveCellScalars=!1;const a=t.renderable.getScalarMode();t.renderable.getScalarVisibility()&&(a!==Ic.USE_CELL_DATA&&a!==Ic.USE_CELL_FIELD_DATA&&a!==Ic.USE_FIELD_DATA&&r.getPointData().getScalars()||a===Ic.USE_POINT_FIELD_DATA||!o||(t.haveCellScalars=!0));let i=n.getProperty().getInterpolation()!==Oc.FLAT?r.getPointData().getNormals():null;null===i&&r.getCellData().getNormals()&&(t.haveCellNormals=!0,i=r.getCellData().getNormals());const s=n.getProperty().getRepresentation();let l=r.getPointData().getTCoords();if(t.openGLActor.getActiveTextures()||(l=null),t.renderable.getColorCoordinates()){l=t.renderable.getColorCoordinates(),t.internalColorTexture||(t.internalColorTexture=hl.newInstance());const e=t.internalColorTexture;e.setMinificationFilter(Dc.NEAREST),e.setMagnificationFilter(Dc.NEAREST),e.setWrapS(Vc.CLAMP_TO_EDGE),e.setWrapT(Vc.CLAMP_TO_EDGE),e.setOpenGLRenderWindow(t.openGLRenderWindow);const n=t.renderable.getColorTextureMap(),r=n.getExtent(),o=n.getPointData().getScalars();e.create2DFromRaw(r[1]-r[0]+1,r[3]-r[2]+1,o.getNumberOfComponents(),o.getDataType(),o.getData()),e.activate(),e.sendParameters(),e.deactivate()}const c=`${r.getMTime()}A${s}B${r.getMTime()}C${i?i.getMTime():1}D${o?o.getMTime():1}E`+n.getProperty().getEdgeVisibility()+"F"+(l?l.getMTime():1);if(t.VBOBuildString!==c){const e=r.getPoints(),a={points:e,normals:i,tcoords:l,colors:o,cellOffset:0,haveCellScalars:t.haveCellScalars,haveCellNormals:t.haveCellNormals,customAttributes:t.renderable.getCustomShaderAttributes().map(e=>r.getPointData().getArrayByName(e))};a.cellOffset+=t.primitives[Rc.Points].getCABO().createVBO(r.getVerts(),"verts",s,a),a.cellOffset+=t.primitives[Rc.Lines].getCABO().createVBO(r.getLines(),"lines",s,a),a.cellOffset+=t.primitives[Rc.Tris].getCABO().createVBO(r.getPolys(),"polys",s,a),a.cellOffset+=t.primitives[Rc.TriStrips].getCABO().createVBO(r.getStrips(),"strips",s,a);n.getProperty().getEdgeVisibility()&&s===Pc.SURFACE?(t.primitives[Rc.TrisEdges].getCABO().createVBO(r.getPolys(),"polys",Pc.WIREFRAME,{points:e,normals:i,tcoords:null,colors:null,cellOffset:0,haveCellScalars:!1,haveCellNormals:!1}),t.primitives[Rc.TriStripsEdges].getCABO().createVBO(r.getStrips(),"strips",Pc.WIREFRAME,{points:e,normals:i,tcoords:null,colors:null,cellOffset:0,haveCellScalars:!1,haveCellNormals:!1})):(t.primitives[Rc.TrisEdges].releaseGraphicsResources(t.openGLRenderWindow),t.primitives[Rc.TriStripsEdges].releaseGraphicsResources(t.openGLRenderWindow)),t.VBOBuildTime.modified(),t.VBOBuildString=c}}}(e,t)}var kc={newInstance:C.default.newInstance(Bc,"vtkOpenGLPolyDataMapper"),extend:Bc};const{vtkErrorMacro:Gc}=C.default,{Representation:Uc}=Ea,{ObjectType:Wc}=zl,{PassTypes:zc}=nc,Hc={type:"StartEvent"},jc={type:"EndEvent"};const Kc={normalMatrix:null,mcpcMatrix:null,mcwcMatrix:null};function Xc(e,t,n={}){Object.assign(t,Kc,n),kc.extend(e,t,n),t.tmpMat3=o.create(),t.normalMatrix=o.create(),t.mcpcMatrix=a.create(),t.mcvcMatrix=a.create(),t.tmpColor=[],t.glyphBOBuildTime={},C.default.obj(t.glyphBOBuildTime,{mtime:0}),function(e,t){t.classHierarchy.push("vtkOpenGLGlyph3DMapper");const n={...e};e.renderPiece=(n,r)=>{if(e.invokeEvent(Hc),t.renderable.getStatic()||t.renderable.update(),t.currentInput=t.renderable.getInputData(1),e.invokeEvent(jc),!t.currentInput)return void Gc("No input!");if(!t.currentInput.getPoints||!t.currentInput.getPoints().getNumberOfValues())return;const o=t.context;t.openGLRenderWindow.getWebgl2()?(t.hardwareSupport=!0,t.extension=null):t.extension||(t.extension=t.context.getExtension("ANGLE_instanced_arrays"),t.hardwareSupport=!!t.extension);const a=r.getProperty().getBackfaceCulling(),i=r.getProperty().getFrontfaceCulling();a||i?i?(t.openGLRenderWindow.enableCullFace(),o.cullFace(o.FRONT)):(t.openGLRenderWindow.enableCullFace(),o.cullFace(o.BACK)):t.openGLRenderWindow.disableCullFace(),e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)},e.multiply4x4WithOffset=(e,t,n,r)=>{const o=t[0],a=t[1],i=t[2],s=t[3],l=t[4],c=t[5],u=t[6],d=t[7],f=t[8],p=t[9],m=t[10],g=t[11],h=t[12],A=t[13],v=t[14],y=t[15];let b=n[r],T=n[r+1],x=n[r+2],C=n[r+3];e[0]=b*o+T*l+x*f+C*h,e[1]=b*a+T*c+x*p+C*A,e[2]=b*i+T*u+x*m+C*v,e[3]=b*s+T*d+x*g+C*y,b=n[r+4],T=n[r+5],x=n[r+6],C=n[r+7],e[4]=b*o+T*l+x*f+C*h,e[5]=b*a+T*c+x*p+C*A,e[6]=b*i+T*u+x*m+C*v,e[7]=b*s+T*d+x*g+C*y,b=n[r+8],T=n[r+9],x=n[r+10],C=n[r+11],e[8]=b*o+T*l+x*f+C*h,e[9]=b*a+T*c+x*p+C*A,e[10]=b*i+T*u+x*m+C*v,e[11]=b*s+T*d+x*g+C*y,b=n[r+12],T=n[r+13],x=n[r+14],C=n[r+15],e[12]=b*o+T*l+x*f+C*h,e[13]=b*a+T*c+x*p+C*A,e[14]=b*i+T*u+x*m+C*v,e[15]=b*s+T*d+x*g+C*y},e.replaceShaderNormal=(e,r,o)=>{if(t.hardwareSupport){if(t.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let n=e.Vertex;t.lastBoundBO.getCABO().getNormalOffset()&&(n=hc.substitute(n,"//VTK::Normal::Dec",["attribute vec3 normalMC;","attribute mat3 gNormal;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,n=hc.substitute(n,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * gNormal * normalMC;"]).result),e.Vertex=n}}n.replaceShaderNormal(e,r,o)},e.replaceShaderColor=(e,r,o)=>{if(t.hardwareSupport&&t.renderable.getColorArray()){let n=e.Vertex,r=e.Geometry,o=e.Fragment;const a=t.lastBoundBO.getReferenceByName("lastLightComplexity");let i=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity"];a&&(i=i.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let s=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];a&&(s=s.concat(["  vec3 specularColor;","  float specularPower;"])),s=s.concat(["  opacity = opacityUniform;"]),a&&(s=s.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),t.drawingEdges||(i=i.concat(["varying vec4 vertexColorVSOutput;"]),n=hc.substitute(n,"//VTK::Color::Dec",["attribute vec4 gColor;","varying vec4 vertexColorVSOutput;"]).result,n=hc.substitute(n,"//VTK::Color::Impl",["vertexColorVSOutput = gColor;"]).result,r=hc.substitute(r,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,r=hc.substitute(r,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,s=s.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])),o=hc.substitute(o,"//VTK::Color::Impl",s).result,o=hc.substitute(o,"//VTK::Color::Dec",i).result,e.Vertex=n,e.Geometry=r,e.Fragment=o}n.replaceShaderColor(e,r,o)},e.replaceShaderPositionVC=(e,r,o)=>{if(t.hardwareSupport){let n=e.Vertex;t.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(n=hc.substitute(n,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","vertexVCVSOutput = MCVCMatrix * gVertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result,n=hc.substitute(n,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result):(n=hc.substitute(n,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;"]).result,n=hc.substitute(n,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result),e.Vertex=n}n.replaceShaderPositionVC(e,r,o)},e.replaceShaderPicking=(e,r,o)=>{if(t.hardwareSupport){let t=e.Fragment,n=e.Vertex;n=hc.substitute(n,"//VTK::Picking::Dec",["attribute vec3 mapperIndexVS;","varying vec3 mapperIndexVSOutput;"]).result,n=hc.substitute(n,"//VTK::Picking::Impl","  mapperIndexVSOutput = mapperIndexVS;").result,e.Vertex=n,t=hc.substitute(t,"//VTK::Picking::Dec",["varying vec3 mapperIndexVSOutput;","uniform vec3 mapperIndex;","uniform int picking;"]).result,t=hc.substitute(t,"//VTK::Picking::Impl",["  vec4 pickColor = picking == 2 ? vec4(mapperIndexVSOutput,1.0) : vec4(mapperIndex,1.0);","  gl_FragData[0] = picking != 0 ? pickColor : gl_FragData[0];"]).result,e.Fragment=t}else n.replaceShaderPicking(e,r,o)},e.updateGlyphShaderParameters=(n,r,o,a,i,s,l,c)=>{const u=o.getProgram();if(n){const e=t.normalMatrix,n=s,r=9*l,o=t.tmpMat3,a=e[0],i=e[1],c=e[2],d=e[3],f=e[4],p=e[5],m=e[6],g=e[7],h=e[8],A=n[r],v=n[r+1],y=n[r+2],b=n[r+3],T=n[r+4],x=n[r+5],C=n[r+6],E=n[r+7],M=n[r+8];o[0]=A*a+v*d+y*m,o[1]=A*i+v*f+y*g,o[2]=A*c+v*p+y*h,o[3]=b*a+T*d+x*m,o[4]=b*i+T*f+x*g,o[5]=b*c+T*p+x*h,o[6]=C*a+E*d+M*m,o[7]=C*i+E*f+M*g,o[8]=C*c+E*p+M*h,u.setUniformMatrix3x3("normalMatrix",t.tmpMat3)}if(e.multiply4x4WithOffset(t.tmpMat4,t.mcpcMatrix,i,16*l),u.setUniformMatrix("MCPCMatrix",t.tmpMat4),r&&(e.multiply4x4WithOffset(t.tmpMat4,t.mcvcMatrix,i,16*l),u.setUniformMatrix("MCVCMatrix",t.tmpMat4)),a){const e=a.getData();t.tmpColor[0]=e[4*l]/255,t.tmpColor[1]=e[4*l+1]/255,t.tmpColor[2]=e[4*l+2]/255,u.setUniform3fArray("ambientColorUniform",t.tmpColor),u.setUniform3fArray("diffuseColorUniform",t.tmpColor)}c&&u.setUniform3fArray("mapperIndex",c.getPropColorValue())},e.renderPieceDraw=(n,r)=>{const i=r.getProperty().getRepresentation(),s=t.context,l=r.getProperty().getEdgeVisibility()&&i===Uc.SURFACE,c=t.openGLCamera.getKeyMatrices(n),u=t.openGLActor.getKeyMatrices();o.multiply(t.normalMatrix,c.normalMatrix,u.normalMatrix),a.multiply(t.mcpcMatrix,c.wcpc,u.mcwc),a.multiply(t.mcvcMatrix,c.wcvc,u.mcwc);const d=t.renderable.getMatrixArray(),f=t.renderable.getNormalArray(),p=t.renderable.getColorArray(),m=d.length/16;let g=!1;t.openGLRenderer.getSelector()&&t.openGLRenderer.getSelector().getCurrentPass()===zc.COMPOSITE_INDEX_PASS&&(g=!0);for(let o=t.primTypes.Start;o<t.primTypes.End;o++){const a=t.primitives[o].getCABO();if(a.getElementCount()){t.drawingEdges=l&&(o===t.primTypes.TrisEdges||o===t.primTypes.TriStripsEdges),e.updateShaders(t.primitives[o],n,r);const c=t.primitives[o].getProgram(),u=e.getOpenGLMode(i,o),h=c.isUniformUsed("normalMatrix"),A=c.isUniformUsed("MCVCMatrix");if(t.hardwareSupport)t.extension?t.extension.drawArraysInstancedANGLE(u,0,a.getElementCount(),m):s.drawArraysInstanced(u,0,a.getElementCount(),m);else for(let n=0;n<m;++n)g&&t.openGLRenderer.getSelector().renderCompositeIndex(n),e.updateGlyphShaderParameters(h,A,t.primitives[o],p,d,f,n,g?t.openGLRenderer.getSelector():null),s.drawArrays(u,0,a.getElementCount())}}},e.setMapperShaderParameters=(e,r,o)=>{if(e.getCABO().getElementCount()&&(t.glyphBOBuildTime.getMTime()>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime()))return e.getProgram().isAttributeUsed("gMatrix")?e.getVAO().addAttributeMatrixWithDivisor(e.getProgram(),t.matrixBuffer,"gMatrix",0,64,t.context.FLOAT,4,!1,1)||Gc("Error setting gMatrix in shader VAO."):e.getVAO().removeAttributeArray("gMatrix"),e.getProgram().isAttributeUsed("gNormal")?e.getVAO().addAttributeMatrixWithDivisor(e.getProgram(),t.normalBuffer,"gNormal",0,36,t.context.FLOAT,3,!1,1)||Gc("Error setting gNormal in shader VAO."):e.getVAO().removeAttributeArray("gNormal"),e.getProgram().isAttributeUsed("gColor")?e.getVAO().addAttributeArrayWithDivisor(e.getProgram(),t.colorBuffer,"gColor",0,4,t.context.UNSIGNED_BYTE,4,!0,1,!1)||Gc("Error setting gColor in shader VAO."):e.getVAO().removeAttributeArray("gColor"),e.getProgram().isAttributeUsed("mapperIndexVS")?e.getVAO().addAttributeArrayWithDivisor(e.getProgram(),t.pickBuffer,"mapperIndexVS",0,4,t.context.UNSIGNED_BYTE,4,!0,1,!1)||Gc("Error setting mapperIndexVS in shader VAO."):e.getVAO().removeAttributeArray("mapperIndexVS"),n.setMapperShaderParameters(e,r,o),void e.getAttributeUpdateTime().modified();n.setMapperShaderParameters(e,r,o)},e.getNeedToRebuildBufferObjects=(e,r)=>{t.renderable.buildArrays();return t.VBOBuildTime.getMTime()<t.renderable.getBuildTime().getMTime()||n.getNeedToRebuildBufferObjects(e,r)},e.buildBufferObjects=(e,r)=>{if(t.hardwareSupport){const e=t.renderable.getMatrixArray(),n=t.renderable.getNormalArray(),r=t.renderable.getColorArray();if(t.matrixBuffer||(t.matrixBuffer=zl.newInstance(),t.matrixBuffer.setOpenGLRenderWindow(t.openGLRenderWindow),t.normalBuffer=zl.newInstance(),t.normalBuffer.setOpenGLRenderWindow(t.openGLRenderWindow),t.colorBuffer=zl.newInstance(),t.colorBuffer.setOpenGLRenderWindow(t.openGLRenderWindow),t.pickBuffer=zl.newInstance(),t.pickBuffer.setOpenGLRenderWindow(t.openGLRenderWindow)),t.renderable.getBuildTime().getMTime()>t.glyphBOBuildTime.getMTime()){t.matrixBuffer.upload(e,Wc.ARRAY_BUFFER),t.normalBuffer.upload(n,Wc.ARRAY_BUFFER),r?t.colorBuffer.upload(r.getData(),Wc.ARRAY_BUFFER):t.colorBuffer.releaseGraphicsResources();const o=e.length/16,a=new Uint8Array(4*o);for(let e=0;e<o;++e){let t=e+1;const n=4*e;a[n]=t%256,t-=a[n],t/=256,a[n+1]=t%256,t-=a[n+1],t/=256,a[n+2]=t%256,a[n+3]=255}t.pickBuffer.upload(a,Wc.ARRAY_BUFFER),t.glyphBOBuildTime.modified()}}return n.buildBufferObjects(e,r)}}(e,t)}var Qc={newInstance:C.default.newInstance(Xc,"vtkOpenGLGlyph3DMapper"),extend:Xc};var Yc={SlicingMode:{NONE:-1,I:0,J:1,K:2,X:3,Y:4,Z:5}};const qc={NEAREST:0,LINEAR:1};const{vtkErrorMacro:Zc}=C.default,{SlicingMode:$c}=Yc;function Jc(e,t,n){if(t.apply(e)){const t=e.getIndependentComponents();return`${e.getMTime()}-${t}-${n}`}return"0"}const eu={VBOBuildTime:0,VBOBuildString:null,openGLTexture:null,tris:null,imagemat:null,colorTexture:null,pwfTexture:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0};function tu(e,t,n={}){Object.assign(t,eu,n),sl.extend(e,t,n),wc.implementReplaceShaderCoincidentOffset(e,t,n),t.tris=xc.newInstance(),t.openGLTexture=hl.newInstance(),t.colorTexture=hl.newInstance(),t.pwfTexture=hl.newInstance(),t.imagemat=a.create(),C.default.setGet(e,t,[]),t.VBOBuildTime={},C.default.obj(t.VBOBuildTime),function(e,t){t.classHierarchy.push("vtkOpenGLImageMapper"),e.buildPass=n=>{if(n){t.openGLImageSlice=e.getFirstAncestorOfType("vtkOpenGLImageSlice"),t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.openGLRenderWindow=t.openGLRenderer.getParent(),t.context=t.openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t.openGLRenderWindow),t.openGLTexture.setOpenGLRenderWindow(t.openGLRenderWindow),t.colorTexture.setOpenGLRenderWindow(t.openGLRenderWindow),t.pwfTexture.setOpenGLRenderWindow(t.openGLRenderWindow);const n=t.openGLRenderer.getRenderable();t.openGLCamera=t.openGLRenderer.getViewNodeFor(n.getActiveCamera()),t.renderable.getSliceAtFocalPoint()&&t.renderable.setSliceFromCamera(n.getActiveCamera())}},e.translucentPass=t=>{t&&e.render()},e.opaqueZBufferPass=n=>{n&&(t.haveSeenDepthRequest=!0,t.renderDepth=!0,e.render(),t.renderDepth=!1)},e.opaquePass=t=>{t&&e.render()},e.getCoincidentParameters=(e,n)=>t.renderable.getResolveCoincidentTopology()?t.renderable.getCoincidentTopologyPolygonOffsetParameters():null,e.render=()=>{const n=t.openGLImageSlice.getRenderable(),r=t.openGLRenderer.getRenderable();e.renderPiece(r,n)},e.buildShaders=(t,n,r)=>{e.getShaderTemplate(t,n,r),e.replaceShaderValues(t,n,r)},e.getShaderTemplate=(e,t,n)=>{e.Vertex=Ec.a,e.Fragment=Sc.a,e.Geometry=""},e.replaceShaderValues=(n,r,o)=>{let a=n.Vertex,i=n.Fragment;a=hc.substitute(a,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,a=hc.substitute(a,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result,a=hc.substitute(a,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result,a=hc.substitute(a,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result;const s=t.openGLTexture.getComponents(),l=o.getProperty().getIndependentComponents();let c=["varying vec2 tcoordVCVSOutput;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D texture1;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;"];if(l){for(let e=1;e<s;e++)c=c.concat([`uniform float cshift${e};`,`uniform float cscale${e};`,`uniform float pwfshift${e};`,`uniform float pwfscale${e};`]);switch(s){case 1:c=c.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:c=c.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:c=c.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:c=c.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:Zc("Unsupported number of independent coordinates.")}}if(i=hc.substitute(i,"//VTK::TCoord::Dec",c).result,l){const e=["r","g","b","a"];let t=["vec4 tvalue = texture2D(texture1, tcoordVCVSOutput);"];for(let n=0;n<s;n++)t=t.concat([`vec3 tcolor${n} = mix${n} * texture2D(colorTexture1, vec2(tvalue.${e[n]} * cscale${n} + cshift${n}, height${n})).rgb;`,`float compWeight${n} = mix${n} * texture2D(pwfTexture1, vec2(tvalue.${e[n]} * pwfscale${n} + pwfshift${n}, height${n})).r;`]);switch(s){case 1:t=t.concat(["gl_FragData[0] = vec4(tcolor0.rgb, opacity);"]);break;case 2:t=t.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:t=t.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:t=t.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:Zc("Unsupported number of independent coordinates.")}i=hc.substitute(i,"//VTK::TCoord::Impl",t).result}else switch(s){case 1:i=hc.substitute(i,"//VTK::TCoord::Impl",["float intensity = texture2D(texture1, tcoordVCVSOutput).r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]).result;break;case 2:i=hc.substitute(i,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","float intensity = tcolor.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tcolor.g + pwfshift0);"]).result;break;default:i=hc.substitute(i,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"]).result}t.haveSeenDepthRequest&&(i=hc.substitute(i,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,i=hc.substitute(i,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=a,n.Fragment=i,e.replaceShaderCoincidentOffset(n,r,o)},e.getNeedToRebuildShaders=(e,n,r)=>{const o=t.openGLTexture.getComponents(),a=r.getProperty().getIndependentComponents();return(t.lastHaveSeenDepthRequest!==t.haveSeenDepthRequest||0===e.getProgram()||t.lastTextureComponents!==o||t.lastIndependentComponents!==a)&&(t.lastHaveSeenDepthRequest=t.haveSeenDepthRequest,t.lastTextureComponents=o,t.lastIndependentComponents=a,!0)},e.updateShaders=(n,r,o)=>{if(t.lastBoundBO=n,e.getNeedToRebuildShaders(n,r,o)){const a={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(a,r,o);const i=t.openGLRenderWindow.getShaderCache().readyShaderProgramArray(a.Vertex,a.Fragment,a.Geometry);i!==n.getProgram()&&(n.setProgram(i),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t.openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,o),e.setCameraShaderParameters(n,r,o),e.setPropertyShaderParameters(n,r,o)},e.setMapperShaderParameters=(n,r,o)=>{n.getCABO().getElementCount()&&(t.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||Zc("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),t.context.FLOAT,n.getCABO().getTCoordComponents(),t.context.FALSE)||Zc("Error setting tcoordMC in shader VAO.")),n.getAttributeUpdateTime().modified());const a=t.openGLTexture.getTextureUnit();n.getProgram().setUniformi("texture1",a);const i=t.openGLTexture.getComponents(),s=o.getProperty().getIndependentComponents();if(s)for(let e=0;e<i;e++)n.getProgram().setUniformf("mix"+e,o.getProperty().getComponentWeight(e));const l=t.openGLTexture.getShiftAndScale();for(let e=0;e<i;e++){let t=o.getProperty().getColorWindow(),r=o.getProperty().getColorLevel();const a=s?e:0,i=o.getProperty().getRGBTransferFunction(a);if(i){const e=i.getRange();t=e[1]-e[0],r=.5*(e[1]+e[0])}const c=l.scale/t,u=(l.shift-r)/t+.5;n.getProgram().setUniformf("cshift"+e,u),n.getProgram().setUniformf("cscale"+e,c)}for(let e=0;e<i;e++){let t=1,r=0;const a=s?e:0,i=o.getProperty().getPiecewiseFunction(a);if(i){const e=i.getRange(),n=e[1]-e[0],o=.5*(e[0]+e[1]);t=l.scale/n,r=(l.shift-o)/n+.5}n.getProgram().setUniformf("pwfshift"+e,r),n.getProgram().setUniformf("pwfscale"+e,t)}if(t.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",t.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){const t=e.getCoincidentParameters(r,o);n.getProgram().setUniformf("coffset",t.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",t.factor)}const c=t.colorTexture.getTextureUnit();n.getProgram().setUniformi("colorTexture1",c);const u=t.pwfTexture.getTextureUnit();n.getProgram().setUniformi("pwfTexture1",u)},e.setCameraShaderParameters=(e,n,r)=>{const o=e.getProgram(),i=t.openGLImageSlice.getKeyMatrices(),s=t.currentInput.getIndexToWorld();a.multiply(t.imagemat,i.mcwc,s);const l=t.openGLCamera.getKeyMatrices(n);if(a.multiply(t.imagemat,l.wcpc,t.imagemat),e.getCABO().getCoordShiftAndScaleEnabled()){const n=e.getCABO().getInverseShiftAndScaleMatrix();a.multiply(t.imagemat,t.imagemat,n)}o.setUniformMatrix("MCPCMatrix",t.imagemat)},e.setPropertyShaderParameters=(e,t,n)=>{const r=e.getProgram(),o=n.getProperty().getOpacity();r.setUniformf("opacity",o)},e.renderPieceStart=(n,r)=>{e.updateBufferObjects(n,r),t.lastBoundBO=null},e.renderPieceDraw=(n,r)=>{const o=t.context;t.openGLTexture.activate(),t.colorTexture.activate(),t.pwfTexture.activate(),t.tris.getCABO().getElementCount()&&(e.updateShaders(t.tris,n,r),o.drawArrays(o.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release()),t.openGLTexture.deactivate(),t.colorTexture.deactivate(),t.pwfTexture.deactivate()},e.renderPieceFinish=(e,t)=>{},e.renderPiece=(n,r)=>{e.invokeEvent({type:"StartEvent"}),t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.invokeEvent({type:"EndEvent"}),t.currentInput?(e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)):Zc("No input!")},e.computeBounds=(n,r)=>{e.getInput()?t.bounds=e.getInput().getBounds():no(t.bounds)},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>t.VBOBuildTime.getMTime()<e.getMTime()||t.VBOBuildTime.getMTime()<r.getMTime()||t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<r.getProperty().getMTime()||t.VBOBuildTime.getMTime()<t.currentInput.getMTime(),e.buildBufferObjects=(n,r)=>{const o=t.currentInput;if(null===o)return;const a=r.getProperty(),i=a.getInterpolationType();i===qc.NEAREST?(t.colorTexture.setMinificationFilter(nl.NEAREST),t.colorTexture.setMagnificationFilter(nl.NEAREST),t.pwfTexture.setMinificationFilter(nl.NEAREST),t.pwfTexture.setMagnificationFilter(nl.NEAREST)):(t.colorTexture.setMinificationFilter(nl.LINEAR),t.colorTexture.setMagnificationFilter(nl.LINEAR),t.pwfTexture.setMinificationFilter(nl.LINEAR),t.pwfTexture.setMagnificationFilter(nl.LINEAR));const s=o.getPointData().getScalars().getNumberOfComponents(),l=a.getIndependentComponents(),c=l?s:1,u=l?2*c:1,d=Jc(a,a.getRGBTransferFunction,c);if(t.colorTextureString!==d){const e=1024,n=new Uint8Array(e*u*3);let r=a.getRGBTransferFunction();if(r){const o=new Float32Array(3*e);for(let t=0;t<c;t++){r=a.getRGBTransferFunction(t);const i=r.getRange();if(r.getTable(i[0],i[1],e,o,1),l)for(let r=0;r<3*e;r++)n[t*e*6+r]=255*o[r],n[t*e*6+r+3*e]=255*o[r];else for(let r=0;r<3*e;r++)n[t*e*6+r]=255*o[r]}t.colorTexture.create2DFromRaw(e,u,3,T.UNSIGNED_CHAR,n)}else{for(let t=0;t<3*e;++t)n[t]=255*t/(3*(e-1)),n[t+1]=255*t/(3*(e-1)),n[t+2]=255*t/(3*(e-1));t.colorTexture.create2DFromRaw(e,1,3,T.UNSIGNED_CHAR,n)}t.colorTextureString=d}const f=Jc(a,a.getPiecewiseFunction,c);if(t.pwfTextureString!==f){const e=1024,n=e*u,r=new Uint8Array(n);let o=a.getPiecewiseFunction();if(t.pwfTexture.resetFormatAndType(),o){const r=new Float32Array(n),i=new Float32Array(e);for(let t=0;t<c;++t)if(o=a.getPiecewiseFunction(t),null===o)r.fill(1);else{const n=o.getRange();if(o.getTable(n[0],n[1],e,i,1),l)for(let n=0;n<e;n++)r[t*e*2+n]=i[n],r[t*e*2+n+e]=i[n];else for(let n=0;n<e;n++)r[t*e*2+n]=i[n]}t.pwfTexture.create2DFromRaw(e,u,1,T.FLOAT,r)}else r.fill(255),t.pwfTexture.create2DFromRaw(e,1,1,T.UNSIGNED_CHAR,r);t.pwfTextureString=f}const{ijkMode:p}=t.renderable.getClosestIJKAxis();let m=t.renderable.getSlice();p!==t.renderable.getSlicingMode()&&(m=t.renderable.getSliceAtPosition(m));const g=o.getExtent();let h;p===$c.I&&(h=m-g[0]),p===$c.J&&(h=m-g[2]),p!==$c.K&&p!==$c.NONE||(h=m-g[4]);const A=`${m}A${o.getMTime()}A${o.getPointData().getScalars().getMTime()}B${e.getMTime()}C${t.renderable.getSlicingMode()}D${r.getProperty().getMTime()}`;if(t.VBOBuildString!==A){const e=o.getDimensions();i===qc.NEAREST?(4===s?(t.openGLTexture.setGenerateMipmap(!0),t.openGLTexture.setMinificationFilter(nl.NEAREST)):t.openGLTexture.setMinificationFilter(nl.NEAREST),t.openGLTexture.setMagnificationFilter(nl.NEAREST)):(4===s?(t.openGLTexture.setGenerateMipmap(!0),t.openGLTexture.setMinificationFilter(nl.LINEAR_MIPMAP_LINEAR)):t.openGLTexture.setMinificationFilter(nl.LINEAR),t.openGLTexture.setMagnificationFilter(nl.LINEAR)),t.openGLTexture.setWrapS(tl.CLAMP_TO_EDGE),t.openGLTexture.setWrapT(tl.CLAMP_TO_EDGE);const n=e[0]*e[1]*s,r=new Float32Array(12),a=new Float32Array(8);for(let e=0;e<4;e++)a[2*e]=e%2?1:0,a[2*e+1]=e>1?1:0;const l=o.getPointData().getScalars().getData();let c=null;if(p===$c.I){c=new l.constructor(e[2]*e[1]*s);let t=0;for(let n=0;n<e[2];n++)for(let r=0;r<e[1];r++){const o=(h+r*e[0]+n*e[0]*e[1])*s;t=(n*e[1]+r)*s,c.set(l.subarray(o,o+s),t)}e[0]=e[1],e[1]=e[2],r[0]=m,r[1]=g[2],r[2]=g[4],r[3]=m,r[4]=g[3],r[5]=g[4],r[6]=m,r[7]=g[2],r[8]=g[5],r[9]=m,r[10]=g[3],r[11]=g[5]}else if(p===$c.J){c=new l.constructor(e[2]*e[0]*s);let t=0;for(let n=0;n<e[2];n++)for(let r=0;r<e[0];r++){const o=(r+h*e[0]+n*e[0]*e[1])*s;t=(n*e[0]+r)*s,c.set(l.subarray(o,o+s),t)}e[1]=e[2],r[0]=g[0],r[1]=m,r[2]=g[4],r[3]=g[1],r[4]=m,r[5]=g[4],r[6]=g[0],r[7]=m,r[8]=g[5],r[9]=g[1],r[10]=m,r[11]=g[5]}else p===$c.K||p===$c.NONE?(c=l.subarray(h*n,(h+1)*n),r[0]=g[0],r[1]=g[2],r[2]=m,r[3]=g[1],r[4]=g[2],r[5]=m,r[6]=g[0],r[7]=g[3],r[8]=m,r[9]=g[1],r[10]=g[3],r[11]=m):Zc("Reformat slicing not yet supported.");t.openGLTexture.create2DFromRaw(e[0],e[1],s,o.getPointData().getScalars().getDataType(),c),t.openGLTexture.activate(),t.openGLTexture.sendParameters(),t.openGLTexture.deactivate();const u=Co.newInstance({numberOfComponents:3,values:r});u.setName("points");const d=Co.newInstance({numberOfComponents:2,values:a});d.setName("tcoords");const f=new Uint16Array(8);f[0]=3,f[1]=0,f[2]=1,f[3]=3,f[4]=3,f[5]=0,f[6]=3,f[7]=2;const v=Co.newInstance({numberOfComponents:1,values:f});t.tris.getCABO().createVBO(v,"polys",Aa.SURFACE,{points:u,tcoords:d,cellOffset:0}),t.VBOBuildTime.modified(),t.VBOBuildString=A}}}(e,t)}var nu={newInstance:C.default.newInstance(tu,"vtkOpenGLImageMapper"),extend:tu};const ru={context:null,keyMatrixTime:null,keyMatrices:null};function ou(e,t,n={}){Object.assign(t,ru,n),sl.extend(e,t,n),t.keyMatrixTime={},C.default.obj(t.keyMatrixTime,{mtime:0}),t.keyMatrices={mcwc:a.create()},C.default.setGet(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLImageSlice"),e.buildPass=n=>{if(t.renderable&&t.renderable.getVisibility()&&n){if(!t.renderable)return;t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes()}},e.traverseOpaqueZBufferPass=t=>{e.traverseOpaquePass(t)},e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getVisibility()&&t.renderable.getIsOpaque()&&(!t.openGLRenderer.getSelector()||t.renderable.getPickable())&&(e.apply(n,!0),t.children.forEach(e=>{e.traverse(n)}),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getVisibility()||t.renderable.getIsOpaque()||t.openGLRenderer.getSelector()&&!t.renderable.getPickable()||(e.apply(n,!0),t.children.forEach(e=>{e.traverse(n)}),e.apply(n,!1))},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.opaqueZBufferPass=(t,n)=>e.opaquePass(t,n),e.opaquePass=(n,r)=>{n&&(t.context=e.getFirstAncestorOfType("vtkOpenGLRenderWindow").getContext(),t.context.depthMask(!0))},e.translucentPass=(n,r)=>{n?(t.context=e.getFirstAncestorOfType("vtkOpenGLRenderWindow").getContext(),t.context.depthMask(!1)):t.context.depthMask(!0)},e.getKeyMatrices=()=>(t.renderable.getMTime()>t.keyMatrixTime.getMTime()&&(a.copy(t.keyMatrices.mcwc,t.renderable.getMatrix()),a.transpose(t.keyMatrices.mcwc,t.keyMatrices.mcwc),t.keyMatrixTime.modified()),t.keyMatrices)}(e,t)}var au={newInstance:C.default.newInstance(ou,"vtkOpenGLImageSlice"),extend:ou};const{vtkDebugMacro:iu}=C.default;const su={};function lu(e,t,n={}){Object.assign(t,su,n),sl.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),e.opaquePass=(n,r)=>{t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.openGLRenderWindow=t.openGLRenderer.getParent();const o=t.openGLRenderer.getAspectRatio(),a=t.openGLRenderer?t.openGLRenderer.getRenderable().getActiveCamera():null,i=t.openGLRenderer.getTiledSizeAndOrigin();let s=null;if(t.renderable.getUseZValues()){const e=r.getZBufferTexture(),n=Math.floor(e.getWidth()),o=Math.floor(e.getHeight()),a=t.openGLRenderWindow.getContext();e.bind();const i=r.getFramebuffer();i?i.saveCurrentBindingsAndBuffers():iu("No framebuffer to save/restore");const l=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,l),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e.getHandle(),0),a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE&&(s=new Uint8Array(n*o*4),a.viewport(0,0,n,o),a.readPixels(0,0,n,o,a.RGBA,a.UNSIGNED_BYTE,s)),i&&i.restorePreviousBindingsAndBuffers(),a.deleteFramebuffer(l)}t.renderable.invokeCallback(t.renderable.getInputData(),a,o,i,s)},e.queryPass=(e,n)=>{e&&(t.renderable.getUseZValues(),n.setDepthRequested(!0))}}(e,t)}var cu={newInstance:C.default.newInstance(lu,"vtkOpenGLPixelSpaceCallbackMapper"),extend:lu};const{vtkDebugMacro:uu}=C.default;const du={context:null,openGLRenderWindow:null,selector:null};function fu(e,t,n={}){Object.assign(t,du,n),sl.extend(e,t,n),C.default.get(e,t,["shaderCache"]),C.default.setGet(e,t,["selector"]),function(e,t){t.classHierarchy.push("vtkOpenGLRenderer"),e.buildPass=n=>{if(n){if(!t.renderable)return;t.renderable.isActiveCameraCreated()||t.renderable.resetCamera(),e.updateLights(),e.prepareNodes(),e.addMissingNode(t.renderable.getActiveCamera()),e.addMissingNodes(t.renderable.getViewPropsWithNestedProps()),e.removeUnusedNodes()}},e.updateLights=()=>{let e=0;const n=t.renderable.getLightsByReference();for(let t=0;t<n.length;++t)n[t].getSwitch()>0&&e++;return e||(uu("No lights are on, creating one."),t.renderable.createLight()),e},e.opaqueZBufferPass=n=>{if(n){let n=0;const r=t.context;t.renderable.getTransparent()||(t.context.clearColor(1,0,0,1),n|=r.COLOR_BUFFER_BIT),t.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0));const o=e.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize),r.viewport(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize),r.colorMask(!0,!0,!0,!0),r.clear(n),r.enable(r.DEPTH_TEST)}},e.cameraPass=t=>{t&&e.clear()},e.getAspectRatio=()=>{const e=t.parent.getSizeByReference(),n=t.renderable.getViewportByReference();return e[0]*(n[2]-n[0])/((n[3]-n[1])*e[1])},e.getTiledSizeAndOrigin=()=>{const e=t.renderable.getViewportByReference(),n=[0,0,1,1],r=ao(e[0]-n[0],0,1),o=ao(e[1]-n[1],0,1),a=t.parent.normalizedDisplayToDisplay(r,o),i=Math.round(a[0]),s=Math.round(a[1]);let l=ao(e[2]-n[0],0,1),c=ao(e[3]-n[1],0,1);l>n[2]-n[0]&&(l=n[2]-n[0]),c>n[3]-n[1]&&(c=n[3]-n[1]);const u=t.parent.normalizedDisplayToDisplay(l,c);let d=Math.round(u[0])-i,f=Math.round(u[1])-s;return d<0&&(d=0),f<0&&(f=0),{usize:d,vsize:f,lowerLeftU:i,lowerLeftV:s}},e.clear=()=>{let n=0;const r=t.context;if(!t.renderable.getTransparent()){const e=t.renderable.getBackgroundByReference();t.context.clearColor(e[0],e[1],e[2],e[3]),n|=r.COLOR_BUFFER_BIT}t.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const o=e.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize),r.viewport(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize),r.clear(n),r.enable(r.DEPTH_TEST)},e.releaseGraphicsResources=()=>{null!==t.selector&&t.selector.releaseGraphicsResources()},e.setOpenGLRenderWindow=n=>{t.openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t.openGLRenderWindow=n,t.context=null,n&&(t.context=t.openGLRenderWindow.getContext()))}}(e,t)}var pu={newInstance:C.default.newInstance(fu,"vtkOpenGLRenderer"),extend:fu};const{vtkErrorMacro:mu}=C.default;const gu={context:null};function hu(e,t,n={}){Object.assign(t,gu,n),sl.extend(e,t,n),t.openGLTexture=hl.newInstance(),t.tris=xc.newInstance(),t.keyMatrixTime={},C.default.obj(t.keyMatrixTime,{mtime:0}),t.keyMatrices={normalMatrix:o.create(),mcwc:a.create()},C.default.setGet(e,t,["context"]),C.default.get(e,t,["activeTextures"]),function(e,t){t.classHierarchy.push("vtkOpenGLSkybox"),e.buildPass=n=>{if(n){t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.openGLRenderWindow=t.openGLRenderer.getParent(),t.context=t.openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t.openGLRenderWindow),t.openGLTexture.setOpenGLRenderWindow(t.openGLRenderWindow);const n=t.openGLRenderer.getRenderable();t.openGLCamera=t.openGLRenderer.getViewNodeFor(n.getActiveCamera())}},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;n.incrementOpaqueActorCount()}},e.opaquePass=(n,r)=>{if(n&&!t.openGLRenderer.getSelector()){e.updateBufferObjects(),t.openGLRenderWindow.enableDepthMask(),t.openGLRenderWindow.getShaderCache().readyShaderProgram(t.tris.getProgram()),t.openGLTexture.render(t.openGLRenderWindow);const n=t.openGLTexture.getTextureUnit();t.tris.getProgram().setUniformi("sbtexture",n);const r=t.openGLRenderer.getRenderable(),o=t.openGLCamera.getKeyMatrices(r),i=a.create();if(a.invert(i,o.wcpc),t.tris.getProgram().setUniformMatrix("IMCPCMatrix",i),"box"===t.lastFormat){const e=r.getActiveCamera().getPosition();t.tris.getProgram().setUniform3f("camPos",e[0],e[1],e[2])}t.tris.getVAO().bind(),t.context.drawArrays(t.context.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release(),t.openGLTexture.deactivate()}},e.updateBufferObjects=()=>{if(!t.tris.getCABO().getElementCount()){const e=new Float32Array(12);for(let t=0;t<4;t++)e[3*t]=t%2*2-1,e[3*t+1]=t>1?1:-1,e[3*t+2]=1;const n=Co.newInstance({numberOfComponents:3,values:e});n.setName("points");const r=new Uint16Array(8);r[0]=3,r[1]=0,r[2]=1,r[3]=3,r[4]=3,r[5]=0,r[6]=3,r[7]=2;const o=Co.newInstance({numberOfComponents:1,values:r});t.tris.getCABO().createVBO(o,"polys",Aa.SURFACE,{points:n,cellOffset:0})}t.renderable.getFormat()!==t.lastFormat&&(t.lastFormat=t.renderable.getFormat(),"box"===t.lastFormat&&t.tris.setProgram(t.openGLRenderWindow.getShaderCache().readyShaderProgramArray("//VTK::System::Dec\n             attribute vec3 vertexMC;\n             uniform mat4 IMCPCMatrix;\n             varying vec3 TexCoords;\n             void main () {\n              gl_Position = vec4(vertexMC.xyz, 1.0);\n              vec4 wpos = IMCPCMatrix * gl_Position;\n              TexCoords = wpos.xyz/wpos.w;\n             }","//VTK::System::Dec\n             //VTK::Output::Dec\n             varying vec3 TexCoords;\n             uniform samplerCube sbtexture;\n             uniform vec3 camPos;\n             void main () {\n               // skybox looks from inside out\n               // which means we have to adjust\n               // our tcoords. Otherwise text would\n               // be flipped\n               vec3 tc = normalize(TexCoords - camPos);\n               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))\n               {\n                 tc = vec3(1.0, 1.0, -1.0) * tc;\n               }\n               else\n               {\n                 tc = vec3(-1.0, 1.0, 1.0) * tc;\n               }\n               gl_FragData[0] = textureCube(sbtexture, tc);\n             }","")),"background"===t.lastFormat&&t.tris.setProgram(t.openGLRenderWindow.getShaderCache().readyShaderProgramArray("//VTK::System::Dec\n             attribute vec3 vertexMC;\n             uniform mat4 IMCPCMatrix;\n             varying vec2 TexCoords;\n             void main () {\n              gl_Position = vec4(vertexMC.xyz, 1.0);\n              vec4 wpos = IMCPCMatrix * gl_Position;\n              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;\n             }","//VTK::System::Dec\n             //VTK::Output::Dec\n             varying vec2 TexCoords;\n             uniform sampler2D sbtexture;\n             void main () {\n               gl_FragData[0] = texture2D(sbtexture, TexCoords);\n             }","")),t.tris.getShaderSourceTime().modified(),t.tris.getVAO().bind(),t.tris.getVAO().addAttributeArray(t.tris.getProgram(),t.tris.getCABO(),"vertexMC",t.tris.getCABO().getVertexOffset(),t.tris.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||mu("Error setting vertexMC in shader VAO."));const e=t.renderable.getTextures();e.length||mu("vtkSkybox requires a texture map"),t.openGLTexture.getRenderable()!==e[0]&&(t.openGLTexture.releaseGraphicsResources(t.openGLRenderWindow),t.openGLTexture.setRenderable(e[0]))}}(e,t)}var Au={newInstance:C.default.newInstance(hu),extend:hu},vu=n(11),yu=n.n(vu);const{vtkErrorMacro:bu}=C.default;const Tu={};function xu(e,t,n={}){Object.assign(t,Tu,n),kc.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLSphereMapper");const n={...e};e.getShaderTemplate=(e,t,n)=>{e.Vertex=yu.a,e.Fragment=Sc.a,e.Geometry=""},e.replaceShaderValues=(e,r,o)=>{let a=e.Vertex,i=e.Fragment;a=hc.substitute(a,"//VTK::Camera::Dec",["uniform mat4 VCPCMatrix;\n","uniform mat4 MCVCMatrix;"]).result,i=hc.substitute(i,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,i=hc.substitute(i,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;\n"]).result;i=hc.substitute(i,"//VTK::Normal::Dec",["uniform float invertedDepth;\n","uniform int cameraParallel;\n","varying float radiusVCVSOutput;\n","varying vec3 centerVCVSOutput;\n","uniform mat4 VCPCMatrix;\n"]).result;let s="";t.context.getExtension("EXT_frag_depth")&&(s="gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;\n"),t.openGLRenderWindow.getWebgl2()&&(s="gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;\n"),i=hc.substitute(i,"//VTK::Depth::Impl",["  vec3 EyePos;\n","  vec3 EyeDir;\n","  if (cameraParallel != 0) {\n","    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);\n","    EyeDir = vec3(0.0,0.0,-1.0); }\n","  else {\n","    EyeDir = vertexVC.xyz;\n","    EyePos = vec3(0.0,0.0,0.0);\n","    float lengthED = length(EyeDir);\n","    EyeDir = normalize(EyeDir);\n","    if (lengthED > radiusVCVSOutput*3.0) {\n","      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }\n","    }\n","  EyePos = EyePos - centerVCVSOutput;\n","  EyePos = EyePos/radiusVCVSOutput;\n","  float b = 2.0*dot(EyePos,EyeDir);\n","  float c = dot(EyePos,EyePos) - 1.0;\n","  float d = b*b - 4.0*c;\n","  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);\n","  if (d < 0.0) { discard; }\n","  else {\n","    float t = (-b - invertedDepth*sqrt(d))*0.5;\n","    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);\n","    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;\n","    }\n","  vec4 pos = VCPCMatrix * vertexVC;\n",s]).result,i=hc.substitute(i,"//VTK::Normal::Impl","").result,t.haveSeenDepthRequest&&(i=hc.substitute(i,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),e.Vertex=a,e.Fragment=i,n.replaceShaderValues(e,r,o)},e.setMapperShaderParameters=(e,r,o)=>{e.getCABO().getElementCount()&&(t.VBOBuildTime>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime())&&e.getProgram().isAttributeUsed("offsetMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"offsetMC",12,e.getCABO().getStride(),t.context.FLOAT,2,!1)||bu("Error setting 'offsetMC' in shader VAO.")),e.getProgram().isUniformUsed("invertedDepth")&&e.getProgram().setUniformf("invertedDepth",t.invert?-1:1),n.setMapperShaderParameters(e,r,o)},e.setCameraShaderParameters=(e,n,r)=>{const o=e.getProgram(),i=n.getActiveCamera(),s=t.openGLCamera.getKeyMatrices(n);if(o.isUniformUsed("VCPCMatrix")&&o.setUniformMatrix("VCPCMatrix",s.vcpc),o.isUniformUsed("MCVCMatrix"))if(r.getIsIdentity())o.setUniformMatrix("MCVCMatrix",s.wcvc);else{const e=t.openGLActor.getKeyMatrices(),n=a.create();a.multiply(n,s.wcvc,e.mcwc),o.setUniformMatrix("MCVCMatrix",n)}o.isUniformUsed("cameraParallel")&&e.getProgram().setUniformi("cameraParallel",i.getParallelProjection())},e.getOpenGLMode=(e,n)=>t.context.TRIANGLES,e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,1);const o=t.renderable.getColorMapColors(),a=t.primitives[t.primTypes.Tris].getCABO(),i=r.getPointData(),s=r.getPoints(),l=s.getNumberOfPoints(),c=s.getData();let u=null;null!=t.renderable.getScaleArray()&&i.hasArray(t.renderable.getScaleArray())&&(u=i.getArray(t.renderable.getScaleArray()).getData());let d=null,f=0,p=null;o?(f=o.getNumberOfComponents(),a.setColorOffset(0),a.setColorBOStride(4),d=o.getData(),p=new Uint8Array(3*l*4),a.getColorBO()||a.setColorBO(zl.newInstance()),a.getColorBO().setOpenGLRenderWindow(t.openGLRenderWindow)):a.getColorBO()&&a.setColorBO(null),a.setColorComponents(f);const m=new Float32Array(5*l*3);a.setStride(20);const g=Math.cos(_r(30));let h=0,A=0,v=0,y=0;for(let e=0;e<l;++e){let n=t.renderable.getRadius();u&&(n=u[e]),h=3*e,m[v++]=c[h++],m[v++]=c[h++],m[v++]=c[h++],m[v++]=-2*n*g,m[v++]=-n,d&&(A=e*f,p[y++]=d[A],p[y++]=d[A+1],p[y++]=d[A+2],p[y++]=d[A+3]),h=3*e,m[v++]=c[h++],m[v++]=c[h++],m[v++]=c[h++],m[v++]=2*n*g,m[v++]=-n,d&&(p[y++]=d[A],p[y++]=d[A+1],p[y++]=d[A+2],p[y++]=d[A+3]),h=3*e,m[v++]=c[h++],m[v++]=c[h++],m[v++]=c[h++],m[v++]=0,m[v++]=2*n,d&&(p[y++]=d[A],p[y++]=d[A+1],p[y++]=d[A+2],p[y++]=d[A+3])}a.setElementCount(v/5),a.upload(m,Bl.ARRAY_BUFFER),o&&a.getColorBO().upload(p,Bl.ARRAY_BUFFER),t.VBOBuildTime.modified()}}(e,t)}var Cu={newInstance:C.default.newInstance(xu,"vtkOpenGLSphereMapper"),extend:xu},Eu=n(12),Mu=n.n(Eu);const{vtkErrorMacro:Su}=C;const wu={};function Ru(e,t,n={}){Object.assign(t,wu,n),kc.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLStickMapper");const n={...e};e.getShaderTemplate=(e,t,n)=>{e.Vertex=Mu.a,e.Fragment=Sc.a,e.Geometry=""},e.replaceShaderValues=(e,r,o)=>{let a=e.Vertex,i=e.Fragment;a=hc.substitute(a,"//VTK::Camera::Dec",["uniform mat4 VCPCMatrix;\n","uniform mat4 MCVCMatrix;"]).result,i=hc.substitute(i,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,i=hc.substitute(i,"//VTK::PositionVC::Impl","  vec4 vertexVC = vertexVCVSOutput;\n").result;i=hc.substitute(i,"//VTK::Normal::Dec",["uniform int cameraParallel;\n","varying float radiusVCVSOutput;\n","varying vec3 orientVCVSOutput;\n","varying float lengthVCVSOutput;\n","varying vec3 centerVCVSOutput;\n","uniform mat4 VCPCMatrix;\n"]).result;let s="";t.context.getExtension("EXT_frag_depth")&&(s="  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;\n"),t.openGLRenderWindow.getWebgl2()&&(s="gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;\n"),i=hc.substitute(i,"//VTK::Depth::Impl",["  vec3 EyePos;\n","  vec3 EyeDir;\n","  if (cameraParallel != 0) {\n","    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);\n","    EyeDir = vec3(0.0,0.0,-1.0); }\n","  else {\n","    EyeDir = vertexVC.xyz;\n","    EyePos = vec3(0.0,0.0,0.0);\n","    float lengthED = length(EyeDir);\n","    EyeDir = normalize(EyeDir);\n","    if (lengthED > radiusVCVSOutput*3.0) {\n","      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }\n","    }\n","  EyePos = EyePos - centerVCVSOutput;\n","  vec3 base1;\n","  if (abs(orientVCVSOutput.z) < 0.99) {\n","    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }\n","  else {\n","    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }\n","  vec3 base2 = cross(orientVCVSOutput,base1);\n","  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));\n","  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));\n","  EyePos = EyePos/radiusVCVSOutput;\n","  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;\n","  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);\n","  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;\n","  float d = b*b - 4.0*a*c;\n","  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);\n","  if (d < 0.0) { discard; }\n","  else {\n","    float t =  (-b - sqrt(d))/(2.0*a);\n","    float tz = EyePos.z + t*EyeDir.z;\n","    vec3 iPoint = EyePos + t*EyeDir;\n","    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {\n","      float t2 = (-b + sqrt(d))/(2.0*a);\n","      float tz2 = EyePos.z + t2*EyeDir.z;\n","      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }\n","      else {\n","        normalVCVSOutput = orientVCVSOutput;\n","        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;\n","        iPoint = EyePos + t3*EyeDir;\n","        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;\n","        }\n","      }\n","    else {\n","      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;\n","      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;\n","      }\n","    }\n","  vec4 pos = VCPCMatrix * vertexVC;\n",s]).result,i=hc.substitute(i,"//VTK::Normal::Impl","").result,t.haveSeenDepthRequest&&(i=hc.substitute(i,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),e.Vertex=a,e.Fragment=i,n.replaceShaderValues(e,r,o)},e.setMapperShaderParameters=(e,r,o)=>{e.getCABO().getElementCount()&&(t.VBOBuildTime>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime())&&(e.getProgram().isAttributeUsed("orientMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"orientMC",12,e.getCABO().getStride(),t.context.FLOAT,3,!1)||Su("Error setting 'orientMC' in shader VAO.")),e.getProgram().isAttributeUsed("offsetMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO().getColorBO(),"offsetMC",0,e.getCABO().getColorBOStride(),t.context.UNSIGNED_BYTE,3,!0)||Su("Error setting 'offsetMC' in shader VAO.")),e.getProgram().isAttributeUsed("radiusMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"radiusMC",24,e.getCABO().getStride(),t.context.FLOAT,1,!1)||Su("Error setting 'radiusMC' in shader VAO."))),n.setMapperShaderParameters(e,r,o)},e.setCameraShaderParameters=(e,n,r)=>{const i=e.getProgram(),s=n.getActiveCamera(),l=t.openGLCamera.getKeyMatrices(n);if(i.isUniformUsed("VCPCMatrix")&&i.setUniformMatrix("VCPCMatrix",l.vcpc),r.getIsIdentity())i.isUniformUsed("MCVCMatrix")&&i.setUniformMatrix("MCVCMatrix",l.wcvc),i.isUniformUsed("normalMatrix")&&i.setUniformMatrix3x3("normalMatrix",l.normalMatrix);else{const e=t.openGLActor.getKeyMatrices(),n=a.create();if(i.isUniformUsed("MCVCMatrix")&&(a.multiply(n,l.wcvc,e.mcwc),i.setUniformMatrix("MCVCMatrix",n)),i.isUniformUsed("normalMatrix")){const t=o.create();o.multiply(t,l.normalMatrix,e.normalMatrix),i.setUniformMatrix3x3("normalMatrix",t)}}i.isUniformUsed("cameraParallel")&&e.getProgram().setUniformi("cameraParallel",s.getParallelProjection())},e.getOpenGLMode=(e,n)=>t.context.TRIANGLES,e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,1);const o=t.renderable.getColorMapColors(),a=t.primitives[t.primTypes.Tris].getCABO(),i=r.getPointData(),s=r.getPoints(),l=s.getNumberOfPoints(),c=s.getData();let u=3;u+=4;let d=null,f=0;a.setColorBOStride(4),a.getColorBO()||a.setColorBO(zl.newInstance()),a.getColorBO().setOpenGLRenderWindow(t.openGLRenderWindow),o&&(f=o.getNumberOfComponents(),a.setColorOffset(4),d=o.getData(),a.setColorBOStride(8)),a.setColorComponents(f),a.setStride(28);const p=new Float32Array(7*l*12),m=new Uint8Array(12*l*(d?8:4));let g=null,h=null;null!=t.renderable.getScaleArray()&&i.hasArray(t.renderable.getScaleArray())&&(g=i.getArray(t.renderable.getScaleArray()).getData()),null!=t.renderable.getOrientationArray()&&i.hasArray(t.renderable.getOrientationArray())?h=i.getArray(t.renderable.getOrientationArray()).getData():Su(["Error setting orientationArray.\n","You have to specify the stick orientation"]);const A=[0,1,3,0,3,2,2,3,5,2,5,4];let v=0,y=0,b=0,T=0;for(let e=0;e<l;++e){let n=t.renderable.getLength(),r=t.renderable.getRadius();g&&(n=g[2*e],r=g[2*e+1]);for(let t=0;t<A.length;++t)v=3*e,p[b++]=c[v++],p[b++]=c[v++],p[b++]=c[v++],v=3*e,p[b++]=h[v++]*n,p[b++]=h[v++]*n,p[b++]=h[v++]*n,p[b++]=r,m[T++]=A[t]%2*255,m[T++]=A[t]>=4?255:0,m[T++]=A[t]>=2?255:0,m[T++]=255,y=e*f,d&&(m[T++]=d[y],m[T++]=d[y+1],m[T++]=d[y+2],m[T++]=d[y+3])}a.setElementCount(b/7),a.upload(p,Bl.ARRAY_BUFFER),a.getColorBO().upload(m,Bl.ARRAY_BUFFER),t.VBOBuildTime.modified()}}(e,t)}var Pu={newInstance:C.newInstance(Ru,"vtkOpenGLStickMapper"),extend:Ru};const Ou={};function Iu(e,t,n={}){Object.assign(t,Ou,n),sl.extend(e,t,n),t.keyMatrixTime={},C.default.obj(t.keyMatrixTime,{mtime:0}),t.normalMatrix=o.create(),t.MCWCMatrix=a.create(),C.default.setGet(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLVolume"),e.buildPass=n=>{t.renderable&&t.renderable.getVisibility()&&n&&(t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes())},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;n.incrementVolumeCount()}},e.traverseVolumePass=n=>{t.renderable&&t.renderable.getVisibility()&&(!t.openGLRenderer.getSelector()||t.renderable.getPickable())&&(e.apply(n,!0),t.children[0].traverse(n),e.apply(n,!1))},e.volumePass=n=>{t.renderable&&t.renderable.getVisibility()&&(n?(t.context=e.getFirstAncestorOfType("vtkOpenGLRenderWindow").getContext(),t.context.depthMask(!1)):t.context.depthMask(!0))},e.getKeyMatrices=()=>(t.renderable.getMTime()>t.keyMatrixTime.getMTime()&&(t.renderable.computeMatrix(),a.copy(t.MCWCMatrix,t.renderable.getMatrix()),a.transpose(t.MCWCMatrix,t.MCWCMatrix),t.renderable.getIsIdentity()?o.identity(t.normalMatrix):(o.fromMat4(t.normalMatrix,t.MCWCMatrix),o.invert(t.normalMatrix,t.normalMatrix)),t.keyMatrixTime.modified()),{mcwc:t.MCWCMatrix,normalMatrix:t.normalMatrix})}(e,t)}var Du={newInstance:C.default.newInstance(Iu,"vtkOpenGLVolume"),extend:Iu};const Vu={NEAREST:0,LINEAR:1,FAST_LINEAR:2},Lu={FRACTIONAL:0,PROPORTIONAL:1};const _u={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3};var Fu=n(13),Nu=n.n(Fu),Bu=n(14),ku=n.n(Bu);const{vtkWarningMacro:Gu,vtkErrorMacro:Uu}=C.default;const Wu={context:null,VBOBuildTime:null,scalarTexture:null,scalarTextureString:null,opacityTexture:null,opacityTextureString:null,colorTexture:null,colorTextureString:null,jitterTexture:null,tris:null,framebuffer:null,copyShader:null,copyVAO:null,lastXYF:1,targetXYF:1,zBufferTexture:null,lastZBufferTexture:null,lastLightComplexity:0,fullViewportTime:1,idxToView:null,idxNormalMatrix:null,modelToView:null,projectionToView:null,avgWindowArea:0,avgFrameTime:0};function zu(e,t,n={}){Object.assign(t,Wu,n),sl.extend(e,t,n),t.VBOBuildTime={},C.default.obj(t.VBOBuildTime,{mtime:0}),t.tris=xc.newInstance(),t.scalarTexture=hl.newInstance(),t.opacityTexture=hl.newInstance(),t.colorTexture=hl.newInstance(),t.jitterTexture=hl.newInstance(),t.jitterTexture.setWrapS(tl.REPEAT),t.jitterTexture.setWrapT(tl.REPEAT),t.framebuffer=yl.newInstance(),t.idxToView=a.create(),t.idxNormalMatrix=o.create(),t.modelToView=a.create(),t.projectionToView=a.create(),t.projectionToWorld=a.create(),C.default.setGet(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLVolumeMapper"),e.buildPass=()=>{t.zBufferTexture=null},e.opaqueZBufferPass=(e,n)=>{if(e){const e=n.getZBufferTexture();e!==t.zBufferTexture&&(t.zBufferTexture=e)}},e.volumePass=(n,r)=>{if(n){t.openGLRenderWindow=e.getFirstAncestorOfType("vtkOpenGLRenderWindow"),t.context=t.openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t.openGLRenderWindow),t.jitterTexture.setOpenGLRenderWindow(t.openGLRenderWindow),t.framebuffer.setOpenGLRenderWindow(t.openGLRenderWindow),t.scalarTexture.setOpenGLRenderWindow(t.openGLRenderWindow),t.colorTexture.setOpenGLRenderWindow(t.openGLRenderWindow),t.opacityTexture.setOpenGLRenderWindow(t.openGLRenderWindow),t.openGLVolume=e.getFirstAncestorOfType("vtkOpenGLVolume");const n=t.openGLVolume.getRenderable();t.openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer");const r=t.openGLRenderer.getRenderable();t.openGLCamera=t.openGLRenderer.getViewNodeFor(r.getActiveCamera()),e.renderPiece(r,n)}},e.buildShaders=(t,n,r)=>{e.getShaderTemplate(t,n,r),e.replaceShaderValues(t,n,r)},e.getShaderTemplate=(e,t,n)=>{e.Vertex=Nu.a,e.Fragment=ku.a,e.Geometry=""},e.replaceShaderValues=(n,r,o)=>{let a=n.Fragment;o.getProperty().getInterpolationType()===Vu.LINEAR&&(a=hc.substitute(a,"//VTK::TrilinearOn","#define vtkTrilinearOn").result);!0===o.getProperty().getUseLabelOutline()&&(a=hc.substitute(a,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result);const s=t.scalarTexture.getComponents();a=hc.substitute(a,"//VTK::NumComponents","#define vtkNumComponents "+s).result;const l=o.getProperty().getIndependentComponents();if(l){a=hc.substitute(a,"//VTK::IndependentComponentsOn","#define vtkIndependentComponentsOn").result;const e=[];for(let t=0;t<s;t++)o.getProperty().getOpacityMode(t)===Lu.PROPORTIONAL&&e.push(`#define vtkComponent${t}Proportional`);e.length>0&&(a=hc.substitute(a,"//VTK::vtkProportionalComponents",e.join("\n")).result)}const c=t.currentInput.getExtent(),u=t.currentInput.getSpacing(),d=i.create();i.set(d,(c[1]-c[0])*u[0],(c[3]-c[2])*u[1],(c[5]-c[4])*u[2]);const f=i.length(d)/t.renderable.getSampleDistance();a=hc.substitute(a,"//VTK::MaximumSamplesValue",""+Math.ceil(f)).result,a=hc.substitute(a,"//VTK::LightComplexity","#define vtkLightComplexity "+t.lastLightComplexity).result,t.gopacity=o.getProperty().getUseGradientOpacity(0);for(let e=1;l&&!t.gopacity&&e<s;++e)o.getProperty().getUseGradientOpacity(e)&&(t.gopacity=!0);t.gopacity&&(a=hc.substitute(a,"//VTK::GradientOpacityOn","#define vtkGradientOpacityOn").result),null!==t.zBufferTexture&&(a=hc.substitute(a,"//VTK::ZBuffer::Dec",["uniform sampler2D zBufferTexture;","uniform float vpWidth;","uniform float vpHeight;"]).result,a=hc.substitute(a,"//VTK::ZBuffer::Impl",["vec4 depthVec = texture2D(zBufferTexture, vec2(gl_FragCoord.x / vpWidth, gl_FragCoord.y/vpHeight));","float zdepth = (depthVec.r*256.0 + depthVec.g)/257.0;","zdepth = zdepth * 2.0 - 1.0;","zdepth = -2.0 * camFar * camNear / (zdepth*(camFar-camNear)-(camFar+camNear)) - camNear;","zdepth = -zdepth/rayDir.z;","dists.y = min(zdepth,dists.y);"]).result),a=hc.substitute(a,"//VTK::BlendMode",""+t.renderable.getBlendMode()).result;const p=t.renderable.getAverageIPScalarRange();a=hc.substitute(a,"//VTK::AverageIPScalarRangeMin",p[0]+".0").result,a=hc.substitute(a,"//VTK::AverageIPScalarRangeMax",p[1]+".0").result,n.Fragment=a,e.replaceShaderLight(n,r,o)},e.replaceShaderLight=(e,n,r)=>{let o=e.Fragment;switch(t.lastLightComplexity){default:case 0:break;case 1:case 2:case 3:{let e=0;n.getLights().forEach(t=>{t.getSwitch()>0&&(o=hc.substitute(o,"//VTK::Light::Dec",[`uniform vec3 lightColor${e};`,`uniform vec3 lightDirectionVC${e}; // normalized`,`uniform vec3 lightHalfAngleVC${e}; // normalized`,"//VTK::Light::Dec"],!1).result,o=hc.substitute(o,"//VTK::Light::Impl",[`  float df = abs(dot(normal.rgb, -lightDirectionVC${e}));`,`  diffuse += ((df) * lightColor${e});`,`    float sf = pow( abs(dot(lightHalfAngleVC${e},normal.rgb)), vSpecularPower);`,`    specular += ((sf) * lightColor${e});`,"  //VTK::Light::Impl"],!1).result,e++)})}}e.Fragment=o},e.getNeedToRebuildShaders=(n,r,o)=>{let a=0;o.getProperty().getShade()&&t.renderable.getBlendMode()===_u.COMPOSITE_BLEND&&(a=0,t.numberOfLights=0,r.getLights().forEach(e=>{e.getSwitch()>0&&(t.numberOfLights++,0===a&&(a=1)),1===a&&(t.numberOfLights>1||1!==e.getIntensity()||!e.lightTypeIsHeadLight())&&(a=2),a<3&&e.getPositional()&&(a=3)}));let i=!1;return t.lastLightComplexity!==a&&(t.lastLightComplexity=a,i=!0),!!(0===n.getProgram()||i||t.lastHaveSeenDepthRequest!==t.haveSeenDepthRequest||!!t.lastZBufferTexture!=!!t.zBufferTexture||n.getShaderSourceTime().getMTime()<e.getMTime()||n.getShaderSourceTime().getMTime()<o.getMTime()||n.getShaderSourceTime().getMTime()<t.renderable.getMTime()||n.getShaderSourceTime().getMTime()<t.currentInput.getMTime())&&(t.lastZBufferTexture=t.zBufferTexture,!0)},e.updateShaders=(n,r,o)=>{if(t.lastBoundBO=n,e.getNeedToRebuildShaders(n,r,o)){const a={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(a,r,o);const i=t.openGLRenderWindow.getShaderCache().readyShaderProgramArray(a.Vertex,a.Fragment,a.Geometry);i!==n.getProgram()&&(n.setProgram(i),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t.openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,o),e.setCameraShaderParameters(n,r,o),e.setPropertyShaderParameters(n,r,o)},e.setMapperShaderParameters=(n,r,o)=>{const a=n.getProgram();if(n.getCABO().getElementCount()&&(t.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(a.isAttributeUsed("vertexDC")&&(n.getVAO().addAttributeArray(a,n.getCABO(),"vertexDC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||Uu("Error setting vertexDC in shader VAO.")),n.getAttributeUpdateTime().modified()),a.setUniformi("texture1",t.scalarTexture.getTextureUnit()),a.setUniformf("sampleDistance",t.renderable.getSampleDistance()),null!==t.zBufferTexture){a.setUniformi("zBufferTexture",t.zBufferTexture.getTextureUnit());const n=e.getRenderTargetSize();a.setUniformf("vpWidth",n[0]),a.setUniformf("vpHeight",n[1])}},e.setCameraShaderParameters=(n,r,s)=>{const l=t.openGLCamera.getKeyMatrices(r),c=t.openGLVolume.getKeyMatrices();a.multiply(t.modelToView,l.wcvc,c.mcwc);const u=n.getProgram(),d=t.openGLCamera.getRenderable(),f=d.getClippingRange();u.setUniformf("camThick",f[1]-f[0]),u.setUniformf("camNear",f[0]),u.setUniformf("camFar",f[1]);const p=t.currentInput.getBounds(),m=t.currentInput.getDimensions(),g=i.create(),h=i.create();let A=1,v=-1,y=1,b=-1;for(let e=0;e<8;++e){if(i.set(g,p[e%2],p[2+Math.floor(e/2)%2],p[4+Math.floor(e/4)]),i.transformMat4(g,g,t.modelToView),!d.getParallelProjection()){i.normalize(h,g);const e=-f[0]/g[2];i.scale(g,h,e)}i.transformMat4(g,g,l.vcpc),A=Math.min(g[0],A),v=Math.max(g[0],v),y=Math.min(g[1],y),b=Math.max(g[1],b)}u.setUniformf("dcxmin",A),u.setUniformf("dcxmax",v),u.setUniformf("dcymin",y),u.setUniformf("dcymax",b),u.isUniformUsed("cameraParallel")&&u.setUniformi("cameraParallel",d.getParallelProjection());const T=t.currentInput.getExtent(),x=t.currentInput.getSpacing(),C=i.create();i.set(C,(T[1]-T[0]+1)*x[0],(T[3]-T[2]+1)*x[1],(T[5]-T[4]+1)*x[2]),u.setUniform3f("vSpacing",x[0],x[1],x[2]),i.set(g,T[0],T[2],T[4]),t.currentInput.indexToWorldVec3(g,g),i.transformMat4(g,g,t.modelToView),u.setUniform3f("vOriginVC",g[0],g[1],g[2]);const E=t.currentInput.getIndexToWorld();a.multiply(t.idxToView,t.modelToView,E),o.multiply(t.idxNormalMatrix,l.normalMatrix,c.normalMatrix),o.multiply(t.idxNormalMatrix,t.idxNormalMatrix,t.currentInput.getDirection());const M=i.length(C)/t.renderable.getSampleDistance();M>t.renderable.getMaximumSamplesPerRay()&&Gu(`The number of steps required ${Math.ceil(M)} is larger than the\n        specified maximum number of steps ${t.renderable.getMaximumSamplesPerRay()}.\n        Please either change the\n        volumeMapper sampleDistance or its maximum number of samples.`);const S=i.create();if(i.set(S,1,1,1),i.divide(S,S,C),u.setUniform3f("vVCToIJK",S[0],S[1],S[2]),u.setUniform3i("volumeDimensions",m[0],m[1],m[2]),!t.openGLRenderWindow.getWebgl2()){const e=t.scalarTexture.getVolumeInfo();u.setUniformf("texWidth",t.scalarTexture.getWidth()),u.setUniformf("texHeight",t.scalarTexture.getHeight()),u.setUniformi("xreps",e.xreps),u.setUniformi("xstride",e.xstride),u.setUniformi("ystride",e.ystride)}const w=i.create(),R=i.create();for(let n=0;n<6;++n){switch(n){default:case 0:i.set(w,1,0,0),i.set(R,T[1],T[3],T[5]);break;case 1:i.set(w,-1,0,0),i.set(R,T[0],T[2],T[4]);break;case 2:i.set(w,0,1,0),i.set(R,T[1],T[3],T[5]);break;case 3:i.set(w,0,-1,0),i.set(R,T[0],T[2],T[4]);break;case 4:i.set(w,0,0,1),i.set(R,T[1],T[3],T[5]);break;case 5:i.set(w,0,0,-1),i.set(R,T[0],T[2],T[4])}i.transformMat3(w,w,t.idxNormalMatrix),i.transformMat4(R,R,t.idxToView);const r=-1*i.dot(R,w);if(u.setUniform3f("vPlaneNormal"+n,w[0],w[1],w[2]),u.setUniformf("vPlaneDistance"+n,r),s.getProperty().getUseLabelOutline()){const n=t.currentInput.getWorldToIndex();u.setUniformMatrix("vWCtoIDX",n),a.invert(t.projectionToWorld,l.wcpc),u.setUniformMatrix("PCWCMatrix",t.projectionToWorld);const r=e.getRenderTargetSize();u.setUniformf("vpWidth",r[0]),u.setUniformf("vpHeight",r[1])}}switch(a.invert(t.projectionToView,l.vcpc),u.setUniformMatrix("PCVCMatrix",t.projectionToView),t.lastLightComplexity){default:case 0:break;case 1:case 2:case 3:{let e=0;const t=[];r.getLights().forEach(n=>{if(n.getSwitch()>0){const r=n.getColor(),o=n.getIntensity();t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,u.setUniform3fArray("lightColor"+e,t);const a=n.getDirection();i.set(w,a[0],a[1],a[2]),i.transformMat3(w,w,l.normalMatrix),u.setUniform3f("lightDirectionVC"+e,w[0],w[1],w[2]);const s=[-.5*w[0],-.5*w[1],-.5*(w[2]-1)];u.setUniform3fArray("lightHalfAngleVC"+e,s),e++}})}}},e.setPropertyShaderParameters=(e,n,r)=>{const o=e.getProgram();o.setUniformi("ctexture",t.colorTexture.getTextureUnit()),o.setUniformi("otexture",t.opacityTexture.getTextureUnit()),o.setUniformi("jtexture",t.jitterTexture.getTextureUnit());const a=t.scalarTexture.getVolumeInfo(),i=r.getProperty(),s=t.scalarTexture.getComponents(),l=r.getProperty().getIndependentComponents();if(l&&s>=2)for(let e=0;e<s;e++)o.setUniformf("mix"+e,r.getProperty().getComponentWeight(e));for(let e=0;e<s;e++){const t=l?e:0,n=a.scale[e],r=i.getScalarOpacity(t).getRange(),s=n/(r[1]-r[0]),c=(a.offset[e]-r[0])/(r[1]-r[0]);o.setUniformf("oshift"+e,c),o.setUniformf("oscale"+e,s);const u=i.getRGBTransferFunction(t).getRange();o.setUniformf("cshift"+e,(a.offset[e]-u[0])/(u[1]-u[0])),o.setUniformf("cscale"+e,n/(u[1]-u[0]))}if(t.gopacity)if(l)for(let e=0;e<s;++e){const t=a.scale[e];if(i.getUseGradientOpacity(e)){const n=i.getGradientOpacityMinimumOpacity(e),r=i.getGradientOpacityMaximumOpacity(e);o.setUniformf("gomin"+e,n),o.setUniformf("gomax"+e,r);const a=[i.getGradientOpacityMinimumValue(e),i.getGradientOpacityMaximumValue(e)];o.setUniformf("goscale"+e,t*(r-n)/(a[1]-a[0])),o.setUniformf("goshift"+e,-a[0]*(r-n)/(a[1]-a[0])+n)}else o.setUniformf("gomin"+e,1),o.setUniformf("gomax"+e,1),o.setUniformf("goscale"+e,0),o.setUniformf("goshift"+e,1)}else{const e=a.scale[s-1],t=i.getGradientOpacityMinimumOpacity(0),n=i.getGradientOpacityMaximumOpacity(0);o.setUniformf("gomin0",t),o.setUniformf("gomax0",n);const r=[i.getGradientOpacityMinimumValue(0),i.getGradientOpacityMaximumValue(0)];o.setUniformf("goscale0",e*(n-t)/(r[1]-r[0])),o.setUniformf("goshift0",-r[0]*(n-t)/(r[1]-r[0])+t)}if(!0===r.getProperty().getUseLabelOutline()){const e=r.getProperty().getLabelOutlineThickness();o.setUniformi("outlineThickness",e)}t.lastLightComplexity>0&&(o.setUniformf("vAmbient",i.getAmbient()),o.setUniformf("vDiffuse",i.getDiffuse()),o.setUniformf("vSpecular",i.getSpecular()),o.setUniformf("vSpecularPower",i.getSpecularPower()))},e.getRenderTargetSize=()=>{if(t.lastXYF>1.43){const e=t.framebuffer.getSize();return[t.fvp[0]*e[0],t.fvp[1]*e[1]]}return t.openGLRenderWindow.getFramebufferSize()},e.renderPieceStart=(n,r)=>{if(t.renderable.getAutoAdjustSampleDistances()){const e=n.getVTKWindow().getInteractor(),r=e.getLastFrameTime();if(t.avgFrameTime=.97*t.avgFrameTime+.03*r,t.avgWindowArea=.97*t.avgWindowArea+.03/(t.lastXYF*t.lastXYF),n.getVTKWindow().getInteractor().isAnimating()){let n=Math.sqrt(t.avgFrameTime*e.getDesiredUpdateRate()/t.avgWindowArea);n>10&&(n=10),t.targetXYF=n}else t.targetXYF=Math.sqrt(t.avgFrameTime*e.getStillUpdateRate()/t.avgWindowArea);t.targetXYF<1.53&&t.targetXYF>1.33&&(t.targetXYF=t.lastXYF),Math.abs(1-t.targetXYF/t.lastXYF)<.1&&(t.targetXYF=t.lastXYF),t.lastXYF=t.targetXYF}else t.lastXYF=t.renderable.getImageSampleDistance();t.lastXYF<=1.43&&(t.lastXYF=1);const o=t.lastXYF,a=t.openGLRenderWindow.getFramebufferSize();if(o>1.43){if(t.framebuffer.saveCurrentBindingsAndBuffers(),null===t.framebuffer.getGLFramebuffer())t.framebuffer.create(Math.floor(.7*a[0]),Math.floor(.7*a[1])),t.framebuffer.populateFramebuffer();else{const e=t.framebuffer.getSize();e[0]===Math.floor(.7*a[0])&&e[1]===Math.floor(.7*a[1])||(t.framebuffer.create(Math.floor(.7*a[0]),Math.floor(.7*a[1])),t.framebuffer.populateFramebuffer())}t.framebuffer.bind();const e=t.context;e.clearColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clear(e.COLOR_BUFFER_BIT),e.viewport(0,0,a[0]/o,a[1]/o),t.fvp=[Math.floor(a[0]/o)/Math.floor(.7*a[0]),Math.floor(a[1]/o)/Math.floor(.7*a[1])]}t.context.disable(t.context.DEPTH_TEST),e.updateBufferObjects(n,r);r.getProperty().getInterpolationType()===Vu.NEAREST?(t.scalarTexture.setMinificationFilter(nl.NEAREST),t.scalarTexture.setMagnificationFilter(nl.NEAREST)):(t.scalarTexture.setMinificationFilter(nl.LINEAR),t.scalarTexture.setMagnificationFilter(nl.LINEAR)),t.lastBoundBO=null,null!==t.zBufferTexture&&t.zBufferTexture.activate()},e.renderPieceDraw=(n,r)=>{const o=t.context;t.scalarTexture.activate(),t.opacityTexture.activate(),t.colorTexture.activate(),t.jitterTexture.activate(),e.updateShaders(t.tris,n,r),o.drawArrays(o.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release(),t.scalarTexture.deactivate(),t.colorTexture.deactivate(),t.opacityTexture.deactivate(),t.jitterTexture.deactivate()},e.renderPieceFinish=(e,n)=>{if(null!==t.zBufferTexture&&t.zBufferTexture.deactivate(),t.lastXYF>1.43){if(t.framebuffer.restorePreviousBindingsAndBuffers(),null===t.copyShader){t.copyShader=t.openGLRenderWindow.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","uniform vec2 tfactor;","varying vec2 tcoord;","void main() { tcoord = vec2(vertexDC.x*0.5 + 0.5, vertexDC.y*0.5 + 0.5) * tfactor; gl_Position = vertexDC; }"].join("\n"),["//VTK::System::Dec","//VTK::Output::Dec","uniform sampler2D texture1;","varying vec2 tcoord;","void main() { gl_FragData[0] = texture2D(texture1,tcoord); }"].join("\n"),"");const e=t.copyShader;t.copyVAO=yc.newInstance(),t.copyVAO.setOpenGLRenderWindow(t.openGLRenderWindow),t.tris.getCABO().bind(),t.copyVAO.addAttributeArray(e,t.tris.getCABO(),"vertexDC",t.tris.getCABO().getVertexOffset(),t.tris.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||Uu("Error setting vertexDC in copy shader VAO.")}else t.openGLRenderWindow.getShaderCache().readyShaderProgram(t.copyShader);const e=t.openGLRenderWindow.getFramebufferSize();t.context.viewport(0,0,e[0],e[1]);const n=t.framebuffer.getColorTexture();n.activate(),t.copyShader.setUniformi("texture",n.getTextureUnit()),t.copyShader.setUniform2f("tfactor",t.fvp[0],t.fvp[1]);const r=t.context;r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),t.context.drawArrays(t.context.TRIANGLES,0,t.tris.getCABO().getElementCount()),n.deactivate(),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA)}},e.renderPiece=(n,r)=>{e.invokeEvent({type:"StartEvent"}),t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.invokeEvent({type:"EndEvent"}),t.currentInput?(e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)):Uu("No input!")},e.computeBounds=(n,r)=>{e.getInput()?t.bounds=e.getInput().getBounds():no(t.Bounds)},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>t.VBOBuildTime.getMTime()<e.getMTime()||t.VBOBuildTime.getMTime()<r.getMTime()||t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<r.getProperty().getMTime()||t.VBOBuildTime.getMTime()<t.currentInput.getMTime(),e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;const o=n.getProperty();if(!t.jitterTexture.getHandle()){const e=new Uint8Array(1024);for(let t=0;t<1024;++t)e[t]=255*Math.random();t.jitterTexture.setMinificationFilter(nl.LINEAR),t.jitterTexture.setMagnificationFilter(nl.LINEAR),t.jitterTexture.create2DFromRaw(32,32,1,T.UNSIGNED_CHAR,e)}const a=r.getPointData().getScalars().getNumberOfComponents(),i=o.getIndependentComponents()?a:1;let s=""+o.getMTime();if(t.opacityTextureString!==s){const e=1024,n=2*e*i,r=new Float32Array(n),a=new Float32Array(e);for(let n=0;n<i;++n){const i=o.getScalarOpacity(n),s=t.renderable.getSampleDistance()/o.getScalarOpacityUnitDistance(n),l=i.getRange();i.getTable(l[0],l[1],e,a,1);for(let t=0;t<e;++t)r[n*e*2+t]=1-(1-a[t])**s,r[n*e*2+t+e]=r[n*e*2+t]}if(t.opacityTexture.releaseGraphicsResources(t.openGLRenderWindow),t.opacityTexture.setMinificationFilter(nl.LINEAR),t.opacityTexture.setMagnificationFilter(nl.LINEAR),t.openGLRenderWindow.getWebgl2()||t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear"))t.opacityTexture.create2DFromRaw(e,2*i,1,T.FLOAT,r);else{const o=new Uint8Array(n);for(let e=0;e<n;++e)o[e]=255*r[e];t.opacityTexture.create2DFromRaw(e,2*i,1,T.UNSIGNED_CHAR,o)}t.opacityTextureString=s}if(s=""+o.getMTime(),t.colorTextureString!==s){const e=1024,n=new Uint8Array(2*e*i*3),r=new Float32Array(3*e);for(let t=0;t<i;++t){const a=o.getRGBTransferFunction(t),i=a.getRange();a.getTable(i[0],i[1],e,r,1);for(let o=0;o<3*e;++o)n[t*e*6+o]=255*r[o],n[t*e*6+o+3*e]=255*r[o]}t.colorTexture.releaseGraphicsResources(t.openGLRenderWindow),t.colorTexture.setMinificationFilter(nl.LINEAR),t.colorTexture.setMagnificationFilter(nl.LINEAR),t.colorTexture.create2DFromRaw(e,2*i,3,T.UNSIGNED_CHAR,n),t.colorTextureString=s}if(s=""+r.getMTime(),t.scalarTextureString!==s){const e=r.getDimensions();t.scalarTexture.releaseGraphicsResources(t.openGLRenderWindow),t.scalarTexture.resetFormatAndType(),t.scalarTexture.create3DFilterableFromRaw(e[0],e[1],e[2],a,r.getPointData().getScalars().getDataType(),r.getPointData().getScalars().getData()),t.scalarTextureString=s}if(!t.tris.getCABO().getElementCount()){const e=new Float32Array(12);for(let t=0;t<4;t++)e[3*t]=t%2*2-1,e[3*t+1]=t>1?1:-1,e[3*t+2]=-1;const n=new Uint16Array(8);n[0]=3,n[1]=0,n[2]=1,n[3]=3,n[4]=3,n[5]=0,n[6]=3,n[7]=2;const r=Co.newInstance({numberOfComponents:3,values:e});r.setName("points");const o=Co.newInstance({numberOfComponents:1,values:n});t.tris.getCABO().createVBO(o,"polys",Aa.SURFACE,{points:r,cellOffset:0})}t.VBOBuildTime.modified()}}(e,t)}var Hu={newInstance:C.default.newInstance(zu,"vtkOpenGLVolumeMapper"),extend:zu};const ju={};function Ku(e,t,n={}){Object.assign(t,ju,n),C.default.obj(e,t),function(e,t){t.overrides={},t.classHierarchy.push("vtkViewNodeFactory"),e.createNode=n=>{if(n.isDeleted())return null;let r=0,o=n.getClassName(r++),a=!1;const i=Object.keys(t.overrides);for(;o&&!a;)-1!==i.indexOf(o)?a=!0:o=n.getClassName(r++);if(!a)return null;const s=t.overrides[o]();return s.setMyFactory(e),s},e.registerOverride=(e,n)=>{t.overrides[e]=n}}(e,t)}var Xu={newInstance:C.default.newInstance(Ku,"vtkViewNodeFactory"),extend:Ku};const Qu={};function Yu(e,t,n={}){Object.assign(t,Qu,n),Xu.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLViewNodeFactory")}(0,t),e.registerOverride("vtkActor",Il.newInstance),e.registerOverride("vtkActor2D",Ll.newInstance),e.registerOverride("vtkCamera",Nl.newInstance),e.registerOverride("vtkGlyph3DMapper",Qc.newInstance),e.registerOverride("vtkImageMapper",nu.newInstance),e.registerOverride("vtkImageSlice",au.newInstance),e.registerOverride("vtkMapper",kc.newInstance),e.registerOverride("vtkPixelSpaceCallbackMapper",cu.newInstance),e.registerOverride("vtkRenderer",pu.newInstance),e.registerOverride("vtkSkybox",Au.newInstance),e.registerOverride("vtkSphereMapper",Cu.newInstance),e.registerOverride("vtkStickMapper",Pu.newInstance),e.registerOverride("vtkTexture",hl.newInstance),e.registerOverride("vtkVolume",Du.newInstance),e.registerOverride("vtkVolumeMapper",Hu.newInstance),e.registerOverride("vtkWidgetRepresentation",Rl.newInstance)}var qu={newInstance:C.default.newInstance(Yu,"vtkOpenGLViewNodeFactory"),extend:Yu},Zu=n(15),$u=n.n(Zu);const Ju=["lastShaderBound","context","openGLRenderWindow"];const ed={lastShaderBound:null,shaderPrograms:null,context:null,openGLRenderWindow:null};function td(e,t,n={}){return Object.assign(t,ed,n),t.shaderPrograms={},C.default.obj(e,t),C.default.setGet(e,t,Ju),function(e,t){t.classHierarchy.push("vtkShaderCache"),e.replaceShaderValues=(e,n,r)=>{let o=n;r.length>0&&(o=hc.substitute(o,"VSOut","GSOut").result);const a=t.openGLRenderWindow.getWebgl2();let i="\n",s="#version 100\n";a?s="#version 300 es\n#define attribute in\n#define textureCube texture\n#define texture2D texture\n#define textureCubeLod textureLod\n#define texture2DLod textureLod\n":(t.context.getExtension("OES_standard_derivatives"),t.context.getExtension("EXT_frag_depth")&&(i="#extension GL_EXT_frag_depth : enable\n"),t.context.getExtension("EXT_shader_texture_lod")&&(i+="#extension GL_EXT_shader_texture_lod : enable\n#define textureCubeLod textureCubeLodEXT\n#define texture2DLod texture2DLodEXT")),o=hc.substitute(o,"//VTK::System::Dec",[s+"\n",a?"":"#extension GL_OES_standard_derivatives : enable\n",i,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let l=hc.substitute(e,"//VTK::System::Dec",[s+"\n","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;a&&(l=hc.substitute(l,"varying","out").result,o=hc.substitute(o,"varying","in").result,o=hc.substitute(o,"gl_FragData\\[0\\]","fragOutput0").result,o=hc.substitute(o,"//VTK::Output::Dec","layout(location = 0) out vec4 fragOutput0;").result);return{VSSource:l,FSSource:o,GSSource:hc.substitute(r,"//VTK::System::Dec",s).result}},e.readyShaderProgramArray=(t,n,r)=>{const o=e.replaceShaderValues(t,n,r),a=e.getShaderProgram(o.VSSource,o.FSSource,o.GSSource);return e.readyShaderProgram(a)},e.readyShaderProgram=t=>t&&(t.getCompiled()||t.compileShader())&&e.bindShader(t)?t:null,e.getShaderProgram=(e,n,r)=>{const o=`${e}${n}${r}`,a=$u()(o);if(-1===Object.keys(t.shaderPrograms).indexOf(a)){const o=hc.newInstance();return o.setContext(t.context),o.getVertexShader().setSource(e),o.getFragmentShader().setSource(n),r&&o.getGeometryShader().setSource(r),o.setMd5Hash(a),t.shaderPrograms[a]=o,o}return t.shaderPrograms[a]},e.releaseGraphicsResources=n=>{e.releaseCurrentShader(),Object.keys(t.shaderPrograms).map(e=>t.shaderPrograms[e]).forEach(e=>e.releaseGraphicsResources(n))},e.releaseGraphicsResources=()=>{t.astShaderBound&&(t.lastShaderBound.release(),t.lastShaderBound=null)},e.bindShader=e=>(t.lastShaderBound===e||(t.lastShaderBound&&t.lastShaderBound.release(),e.bind(),t.lastShaderBound=e),1)}(e,t),Object.freeze(e)}var nd={newInstance:C.default.newInstance(td,"vtkShaderCache"),extend:td};const{vtkErrorMacro:rd}=C.default;const od={context:null,numberOfTextureUnits:0,textureUnits:0};function ad(e,t,n={}){Object.assign(t,od,n),C.default.obj(e,t),t.textureUnits=[],C.default.get(e,t,["numberOfTextureUnits"]),C.default.setGet(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLTextureUnitManager"),e.deleteTable=()=>{for(let e=0;e<t.numberOfTextureUnits;++e)!0===t.textureUnits[e]&&rd("some texture units  were not properly released");t.textureUnits=[],t.numberOfTextureUnits=0},e.setContext=n=>{if(t.context!==n){if(0!==t.context&&e.deleteTable(),t.context=n,t.context){t.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let e=0;e<t.numberOfTextureUnits;++e)t.textureUnits[e]=!1}e.modified()}},e.allocate=()=>{for(let n=0;n<t.numberOfTextureUnits;n++)if(!e.isAllocated(n))return t.textureUnits[n]=!0,n;return-1},e.allocateUnit=n=>e.isAllocated(n)?-1:(t.textureUnits[n]=!0,n),e.isAllocated=e=>t.textureUnits[e],e.free=e=>{t.textureUnits[e]=!1}}(e,t)}var id={newInstance:C.default.newInstance(ad,"vtkOpenGLTextureUnitManager"),extend:ad},sd=n(16),ld=n.n(sd);const{vtkDebugMacro:cd,vtkErrorMacro:ud}=C.default,dd=-1!==navigator.userAgent.indexOf("Chrome");function fd(e,t,n){const r=e.createFramebuffer(),o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,t,2,2,0,t,n,null),e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,o,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),a===e.FRAMEBUFFER_COMPLETE}let pd=0;const md=[];function gd(){pd--,md.forEach(e=>e(pd))}function hd(e,t){t.classHierarchy.push("vtkOpenGLRenderWindow");const n=[0,0];e.onModified((function(){t.renderable&&(t.size[0]===n[0]&&t.size[1]===n[1]||(n[0]=t.size[0],n[1]=t.size[1],t.canvas.setAttribute("width",t.size[0]),t.canvas.setAttribute("height",t.size[1]))),t.viewStream&&t.viewStream.setSize(t.size[0],t.size[1]),t.canvas.style.display=t.useOffScreen?"none":"block",t.el&&(t.el.style.cursor=t.cursorVisibility?t.cursor:"none"),t.containerSize=null})),e.buildPass=n=>{if(n){if(!t.renderable)return;e.prepareNodes(),e.addMissingNodes(t.renderable.getRenderersByReference()),e.removeUnusedNodes(),e.initialize(),t.children.forEach(t=>{t.setOpenGLRenderWindow(e)})}},e.initialize=()=>{if(!t.initialized){t.context=e.get3DContext(),t.textureUnitManager=id.newInstance(),t.textureUnitManager.setContext(t.context),t.shaderCache.setContext(t.context);const n=t.context;n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),n.depthFunc(n.LEQUAL),n.enable(n.BLEND),t.initialized=!0}},e.makeCurrent=()=>{t.context.makeCurrent()},e.setContainer=n=>{t.el&&t.el!==n&&(t.canvas.parentNode!==t.el&&ud("Error: canvas parent node does not match container"),t.el.removeChild(t.canvas),t.el.contains(t.bgImage)&&t.el.removeChild(t.bgImage)),t.el!==n&&(t.el=n,t.el&&(t.el.appendChild(t.canvas),t.useBackgroundImage&&t.el.appendChild(t.bgImage)),e.modified())},e.getContainer=()=>t.el,e.getContainerSize=()=>{if(!t.containerSize&&t.el){const{width:e,height:n}=t.el.getBoundingClientRect();t.containerSize=[e,n]}return t.containerSize||t.size},e.getFramebufferSize=()=>t.activeFramebuffer?t.activeFramebuffer.getSize():t.size,e.isInViewport=(t,n,r)=>{const o=r.getViewportByReference(),a=e.getFramebufferSize();return o[0]*a[0]<=t&&o[2]*a[0]>=t&&o[1]*a[1]<=n&&o[3]*a[1]>=n},e.getViewportSize=t=>{const n=t.getViewportByReference(),r=e.getFramebufferSize();return[(n[2]-n[0])*r[0],(n[3]-n[1])*r[1]]},e.getViewportCenter=t=>{const n=e.getViewportSize(t);return[.5*n[0],.5*n[1]]},e.displayToNormalizedDisplay=(t,n,r)=>{const o=e.getFramebufferSize();return[t/o[0],n/o[1],r]},e.normalizedDisplayToDisplay=(t,n,r)=>{const o=e.getFramebufferSize();return[t*o[0],n*o[1],r]},e.worldToView=(e,t,n,r)=>r.worldToView(e,t,n),e.viewToWorld=(e,t,n,r)=>r.viewToWorld(e,t,n),e.worldToDisplay=(t,n,r,o)=>{const a=o.worldToView(t,n,r),i=e.getViewportSize(o),s=o.viewToProjection(a[0],a[1],a[2],i[0]/i[1]),l=o.projectionToNormalizedDisplay(s[0],s[1],s[2]);return e.normalizedDisplayToDisplay(l[0],l[1],l[2])},e.displayToWorld=(t,n,r,o)=>{const a=e.displayToNormalizedDisplay(t,n,r),i=o.normalizedDisplayToProjection(a[0],a[1],a[2]),s=e.getViewportSize(o),l=o.projectionToView(i[0],i[1],i[2],s[0]/s[1]);return o.viewToWorld(l[0],l[1],l[2])},e.normalizedDisplayToViewport=(t,n,r,o)=>{let a=o.getViewportByReference();a=e.normalizedDisplayToDisplay(a[0],a[1],0);const i=e.normalizedDisplayToDisplay(t,n,r);return[i[0]-a[0]-.5,i[1]-a[1]-.5,r]},e.viewportToNormalizedViewport=(t,n,r,o)=>{const a=e.getViewportSize(o);return a&&0!==a[0]&&0!==a[1]?[t/(a[0]-1),n/(a[1]-1),r]:[t,n,r]},e.normalizedViewportToViewport=(t,n,r)=>{const o=e.getFramebufferSize();return[t*(o[0]-1),n*(o[1]-1),r]},e.displayToLocalDisplay=(t,n,r)=>[t,e.getFramebufferSize()[1]-n-1,r],e.viewportToNormalizedDisplay=(t,n,r,o)=>{let a=o.getViewportByReference();a=e.normalizedDisplayToDisplay(a[0],a[1],0);const i=t+a[0]+.5,s=n+a[1]+.5;return e.displayToNormalizedDisplay(i,s,r)},e.getPixelData=(e,n,r,o)=>{const a=new Uint8Array((r-e+1)*(o-n+1)*4);return t.context.readPixels(e,n,r-e+1,o-n+1,t.context.RGBA,t.context.UNSIGNED_BYTE,a),a},e.get3DContext=(n={preserveDrawingBuffer:!1,depth:!0,alpha:!0})=>{let r=null;const o="undefined"!=typeof WebGL2RenderingContext;t.webgl2=!1,t.defaultToWebgl2&&o&&(r=t.canvas.getContext("webgl2",n),r&&(t.webgl2=!0,cd("using webgl2"))),r||(cd("using webgl1"),r=t.canvas.getContext("webgl",n)||t.canvas.getContext("experimental-webgl",n));new ld.a({PROVIDE_MOBILE_VRDISPLAY:!0,DIRTY_SUBMIT_FRAME_BINDINGS:!1,BUFFER_SCALE:.75});return navigator.getVRDisplays&&navigator.getVRDisplays().then(n=>{n.length>0&&(t.vrDisplay=n[0],t.vrDisplay.depthNear=.01,t.vrDisplay.depthFar=100,e.invokeHaveVRDisplay())}),t.canvas.addEventListener("webglcontextlost",e=>{e.preventDefault()},!1),t.canvas.addEventListener("webglcontextrestored",e.restoreContext,!1),r},e.startVR=()=>{t.oldCanvasSize=t.size.slice(),t.vrDisplay.capabilities.canPresent?t.vrDisplay.requestPresent([{source:t.canvas}]).then(()=>{if(t.el&&t.vrDisplay.capabilities.hasExternalDisplay&&t.hideCanvasInVR&&(t.el.style.display="none"),t.queryVRSize){const n=t.vrDisplay.getEyeParameters("left"),r=t.vrDisplay.getEyeParameters("right"),o=Math.floor(n.renderWidth+r.renderWidth),a=Math.floor(Math.max(n.renderHeight,r.renderHeight));e.setSize(o,a)}else e.setSize(t.vrResolution);t.renderable.getRenderers()[0].resetCamera(),t.vrFrameData=new VRFrameData,t.renderable.getInteractor().switchToVRAnimation(),t.vrSceneFrame=t.vrDisplay.requestAnimationFrame(e.vrRender),dd&&(t.vrSceneFrame=t.vrDisplay.requestAnimationFrame(e.vrRender))}).catch(()=>{console.error("failed to requestPresent")}):ud("vrDisplay is not connected")},e.stopVR=()=>{t.renderable.getInteractor().returnFromVRAnimation(),t.vrDisplay.exitPresent(),t.vrDisplay.cancelAnimationFrame(t.vrSceneFrame),e.setSize(...t.oldCanvasSize),t.el&&t.vrDisplay.capabilities.hasExternalDisplay&&(t.el.style.display="block");const n=t.renderable.getRenderers()[0];n.getActiveCamera().setProjectionMatrix(null),n.setViewport(0,0,1,1),e.traverseAllPasses()},e.vrRender=()=>{if(!t.vrDisplay.isPresenting)return;t.renderable.getInteractor().updateGamepads(t.vrDisplay.displayId),t.vrSceneFrame=t.vrDisplay.requestAnimationFrame(e.vrRender),t.vrDisplay.getFrameData(t.vrFrameData);const n=t.renderable.getRenderers()[0];n.setViewport(0,0,.5,1),n.getActiveCamera().computeViewParametersFromPhysicalMatrix(t.vrFrameData.leftViewMatrix),n.getActiveCamera().setProjectionMatrix(t.vrFrameData.leftProjectionMatrix),e.traverseAllPasses(),n.setViewport(.5,0,1,1),n.getActiveCamera().computeViewParametersFromPhysicalMatrix(t.vrFrameData.rightViewMatrix),n.getActiveCamera().setProjectionMatrix(t.vrFrameData.rightProjectionMatrix),e.traverseAllPasses(),t.vrDisplay.submitFrame()},e.restoreContext=()=>{const t=xl.newInstance();t.setCurrentOperation("Release"),t.traverse(e,null)},e.activateTexture=n=>{const r=t.textureResourceIds.get(n);if(void 0!==r)return void t.context.activeTexture(t.context.TEXTURE0+r);const o=e.getTextureUnitManager().allocate();o<0?ud("Hardware does not support the number of textures defined."):(t.textureResourceIds.set(n,o),t.context.activeTexture(t.context.TEXTURE0+o))},e.deactivateTexture=n=>{const r=t.textureResourceIds.get(n);void 0!==r&&(e.getTextureUnitManager().free(r),t.textureResourceIds.delete(n))},e.getTextureUnitForTexture=e=>{const n=t.textureResourceIds.get(e);return void 0!==n?n:-1},e.getDefaultTextureInternalFormat=(e,n,r)=>{if(t.webgl2)switch(e){case T.UNSIGNED_CHAR:switch(n){case 1:return t.context.R8;case 2:return t.context.RG8;case 3:return t.context.RGB8;case 4:default:return t.context.RGBA8}default:case T.FLOAT:switch(n){case 1:return t.context.R16F;case 2:return t.context.RG16F;case 3:return t.context.RGB16F;case 4:default:return t.context.RGBA16F}}switch(n){case 1:return t.context.LUMINANCE;case 2:return t.context.LUMINANCE_ALPHA;case 3:return t.context.RGB;case 4:default:return t.context.RGBA}},e.setBackgroundImage=e=>{t.bgImage.src=e.src},e.setUseBackgroundImage=e=>{t.useBackgroundImage=e,t.useBackgroundImage&&!t.el.contains(t.bgImage)?t.el.appendChild(t.bgImage):!t.useBackgroundImage&&t.el.contains(t.bgImage)&&t.el.removeChild(t.bgImage)},e.captureNextImage=(n="image/png")=>{if(t.deleted)return null;t.imageFormat=n;const r=t.notifyStartCaptureImage;return t.notifyStartCaptureImage=!0,new Promise((n,o)=>{const a=e.onImageReady(e=>{t.notifyStartCaptureImage=r,a.unsubscribe(),n(e)})})},e.getGLInformations=()=>{const n=e.get3DContext(),r=n.getExtension("OES_texture_float"),o=n.getExtension("OES_texture_half_float"),a=n.getExtension("WEBGL_debug_renderer_info"),i=n.getExtension("WEBGL_draw_buffers"),s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),l=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",n.getParameter(n.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",n.getParameter(n.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",n.getParameter(n.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",s&&n.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",n.getParameter(n.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",n.getParameter(n.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",n.getParameter(n.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",n.getParameter(n.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",n.getParameter(n.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",n.getParameter(n.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",n.getParameter(n.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",n.getParameter(n.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",n.getParameter(n.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",n.getParameter(n.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",n.getParameter(n.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",n.getParameter(n.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",n.getParameter(n.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[r&&fd(n,n.RGBA,n.UNSIGNED_BYTE)?"RGBA":"",r&&fd(n,n.RGB,n.UNSIGNED_BYTE)?"RGB":"",r&&fd(n,n.LUMINANCE,n.UNSIGNED_BYTE)?"LUMINANCE":"",r&&fd(n,n.ALPHA,n.UNSIGNED_BYTE)?"ALPHA":"",r&&fd(n,n.LUMINANCE_ALPHA,n.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[o&&fd(n,n.RGBA,o.HALF_FLOAT_OES)?"RGBA":"",o&&fd(n,n.RGB,o.HALF_FLOAT_OES)?"RGB":"",o&&fd(n,n.LUMINANCE,o.HALF_FLOAT_OES)?"LUMINANCE":"",o&&fd(n,n.ALPHA,o.HALF_FLOAT_OES)?"ALPHA":"",o&&fd(n,n.LUMINANCE_ALPHA,o.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[r&&fd(n,n.RGBA,n.FLOAT)?"RGBA":"",r&&fd(n,n.RGB,n.FLOAT)?"RGB":"",r&&fd(n,n.LUMINANCE,n.FLOAT)?"LUMINANCE":"",r&&fd(n,n.ALPHA,n.FLOAT)?"ALPHA":"",r&&fd(n,n.LUMINANCE_ALPHA,n.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",i?n.getParameter(i.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",n.getSupportedExtensions().join("<br/>\t\t\t\t\t    ")],["WebGL Renderer","RENDERER",n.getParameter(n.RENDERER)],["WebGL Vendor","VENDOR",n.getParameter(n.VENDOR)],["WebGL Version","VERSION",n.getParameter(n.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",n.getParameter(n.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",a&&n.getParameter(a.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",a&&n.getParameter(a.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",t.webgl2?2:1]],c={};for(;l.length;){const[e,t,n]=l.pop();t&&(c[t]={label:e,value:n})}return c},e.traverseAllPasses=()=>{if(t.renderPasses)for(let n=0;n<t.renderPasses.length;++n)t.renderPasses[n].traverse(e,null);t.notifyStartCaptureImage&&function(n=t.imageFormat){const r=document.createElement("canvas"),o=r.getContext("2d");r.width=t.canvas.width,r.height=t.canvas.height,o.drawImage(t.canvas,0,0);const a=t.canvas.getBoundingClientRect();t.renderable.getRenderers().forEach(e=>{e.getViewProps().forEach(e=>{if(e.getContainer){const t=e.getContainer().getElementsByTagName("canvas");for(let e=0;e<t.length;e++){const n=t[e],r=n.getBoundingClientRect(),i=r.x-a.x,s=r.y-a.y;o.drawImage(n,i,s)}}})});const i=r.toDataURL(n);r.remove(),e.invokeImageReady(i)}()},e.disableDepthMask=()=>{t.depthMaskEnabled&&(t.context.depthMask(!1),t.depthMaskEnabled=!1)},e.enableDepthMask=()=>{t.depthMaskEnabled||(t.context.depthMask(!0),t.depthMaskEnabled=!0)},e.disableCullFace=()=>{t.cullFaceEnabled&&(t.context.disable(t.context.CULL_FACE),t.cullFaceEnabled=!1)},e.enableCullFace=()=>{t.cullFaceEnabled||(t.context.enable(t.context.CULL_FACE),t.cullFaceEnabled=!0)},e.setViewStream=n=>{if(t.viewStream===n)return!1;if(t.subscription&&(t.subscription.unsubscribe(),t.subscription=null),t.viewStream=n,t.viewStream){t.renderable.getRenderers()[0].getBackgroundByReference()[3]=0,e.setUseBackgroundImage(!0),t.subscription=t.viewStream.onImageReady(t=>e.setBackgroundImage(t.image)),t.viewStream.setSize(t.size[0],t.size[1]),t.viewStream.invalidateCache(),t.viewStream.render(),e.modified()}return!0},e.delete=C.default.chain(e.delete,e.setViewStream,gd)}const Ad={cullFaceEnabled:!1,depthMaskEnabled:!0,shaderCache:null,initialized:!1,context:null,canvas:null,size:[300,300],cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,vrResolution:[2160,1200],queryVRSize:!1,hideCanvasInVR:!0,activeFramebuffer:null,vrDisplay:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function vd(e,t,n={}){Object.assign(t,Ad,n),t.canvas=document.createElement("canvas"),t.canvas.style.width="100%",pd++,md.forEach(e=>e(pd)),t.bgImage=new Image,t.bgImage.style.position="absolute",t.bgImage.style.left="0",t.bgImage.style.top="0",t.bgImage.style.width="100%",t.bgImage.style.height="100%",t.bgImage.style.zIndex="-1",t.textureResourceIds=new Map,sl.extend(e,t,n),t.myFactory=qu.newInstance(),t.myFactory.registerOverride("vtkRenderWindow",yd),t.shaderCache=nd.newInstance(),t.shaderCache.setOpenGLRenderWindow(e),t.renderPasses[0]=Ml.newInstance(),C.default.event(e,t,"imageReady"),C.default.event(e,t,"haveVRDisplay"),C.default.get(e,t,["shaderCache","textureUnitManager","webgl2","vrDisplay","useBackgroundImage"]),C.default.setGet(e,t,["initialized","context","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","queryVRSize","hideCanvasInVR","useOffScreen","activeFramebuffer"]),C.default.setGetArray(e,t,["size","vrResolution"],2),hd(e,t)}const yd=C.default.newInstance(vd,"vtkOpenGLRenderWindow");var bd={newInstance:yd,extend:vd,pushMonitorGLContextCount:function(e){md.push(e)},popMonitorGLContextCount:function(e){return md.pop()}};const Td={renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1};function xd(e,t,n={}){Object.assign(t,Td,n),C.default.obj(e,t),C.default.setGet(e,t,["interactor","numberOfLayers","views"]),C.default.get(e,t,["neverRendered"]),C.default.getArray(e,t,["renderers"]),C.default.event(e,t,"completion"),function(e,t){t.classHierarchy.push("vtkRenderWindow"),e.addRenderer=n=>{e.hasRenderer(n)||(n.setRenderWindow(e),t.renderers.push(n),e.modified())},e.removeRenderer=n=>{t.renderers=t.renderers.filter(e=>e!==n),e.modified()},e.hasRenderer=e=>-1!==t.renderers.indexOf(e),e.addView=n=>{e.hasView(n)||(n.setRenderable(e),t.views.push(n),e.modified())},e.removeView=n=>{t.views=t.views.filter(e=>e!==n),e.modified()},e.hasView=e=>-1!==t.views.indexOf(e),e.render=()=>{t.interactor?t.interactor.render():t.views.forEach(e=>e.traverseAllPasses())},e.getStatistics=()=>{const e={propCount:0,invisiblePropCount:0};return t.renderers.forEach(t=>{t.getViewProps().forEach(t=>{if(t.getVisibility()){e.propCount+=1;const n=t.getMapper&&t.getMapper();if(n&&n.getPrimitiveCount){const t=n.getPrimitiveCount();Object.keys(t).forEach(n=>{e[n]||(e[n]=0),e[n]+=t[n]})}}else e.invisiblePropCount+=1})}),e.str=Object.keys(e).map(t=>`${t}: ${e[t]}`).join("\n"),e},e.captureImages=(n="image/png")=>(C.default.setImmediate(e.render),t.views.map(e=>e.captureNextImage?e.captureNextImage(n):void 0).filter(e=>!!e))}(e,t)}var Cd={newInstance:C.default.newInstance(xd,"vtkRenderWindow"),extend:xd};const Ed={Unknown:0,LeftController:1,RightController:2},Md={Unknown:0,Trigger:1,TrackPad:2,Grip:3,ApplicationMenu:4};var Sd={Device:Ed,Input:Md};const{Device:wd,Input:Rd}=Sd,{vtkWarningMacro:Pd,vtkErrorMacro:Od,normalizeWheel:Id,vtkOnceErrorMacro:Dd}=C.default,Vd={"OpenVR Gamepad":[Rd.TrackPad,Rd.Trigger,Rd.Grip,Rd.ApplicationMenu]},Ld=["StartAnimation","Animation","EndAnimation","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteractionEvent","InteractionEvent","EndInteractionEvent"];function _d(e){return e.stopPropagation(),e.preventDefault(),!1}const Fd={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,view:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{}};function Nd(e,t,n={}){Object.assign(t,Fd,n),C.default.obj(e,t),C.default.event(e,t,"RenderEvent"),Ld.forEach(n=>C.default.event(e,t,n)),C.default.get(e,t,["initialized","container","enabled","enableRender","interactorStyle","lastFrameTime","view"]),C.default.setGet(e,t,["lightFollowCamera","enabled","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker"]),function(e,t){t.classHierarchy.push("vtkRenderWindowInteractor");const n=new Set;let r=0;function o(n,r){t.currentRenderer=e.findPokedRenderer(n,r)}function a(e){const n=t.container.getBoundingClientRect(),r=t.view.getCanvas(),a=r.width/n.width,i=r.height/n.height,s={x:a*(e.clientX-n.left),y:i*(n.height-e.clientY+n.top),z:0};return o(s.x,s.y),s}function i(e){const t={};for(let n=0;n<e.length;n++){const r=e[n];t[r.identifier]=a(r)}return t}function s(e){return{controlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey}}function l(e){const t=s(e),n={key:e.key,keyCode:e.charCode};return Object.assign(n,t),n}function c(n,o=!1){const a=document,i=n?"addEventListener":"removeEventListener",s=n?"removeEventListener":"addEventListener";!o&&!n&&r>0&&--r,r&&!o||(r=0,t.container&&t.container[s]("mousemove",e.handleMouseMove),a[i]("mouseup",e.handleMouseUp),a[i]("mousemove",e.handleMouseMove),a[i]("touchend",e.handleTouchEnd,!1),a[i]("touchcancel",e.handleTouchEnd,!1),a[i]("touchmove",e.handleTouchMove,!1)),!o&&n&&++r}function u(){t.view&&t.enabled&&t.enableRender&&(t.inRender=!0,t.view.traverseAllPasses(),t.inRender=!1),e.invokeRenderEvent()}e.start=()=>{(t.initialized||(e.initialize(),t.initialized))&&e.startEventLoop()},e.setRenderWindow=e=>{Od("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},e.setInteractorStyle=n=>{t.interactorStyle!==n&&(null!=t.interactorStyle&&t.interactorStyle.setInteractor(null),t.interactorStyle=n,null!=t.interactorStyle&&t.interactorStyle.getInteractor()!==e&&t.interactorStyle.setInteractor(e))},e.initialize=()=>{t.initialized=!0,e.enable(),e.render()},e.enable=()=>e.setEnabled(!0),e.disable=()=>e.setEnabled(!1),e.startEventLoop=()=>Pd("empty event loop"),e.getCurrentRenderer=()=>(t.currentRenderer||o(0,0),t.currentRenderer),e.bindEvents=n=>{t.container=n,n.addEventListener("contextmenu",_d),n.addEventListener("wheel",e.handleWheel),n.addEventListener("DOMMouseScroll",e.handleWheel),n.addEventListener("mousemove",e.handleMouseMove),n.addEventListener("mousedown",e.handleMouseDown),document.querySelector("body").addEventListener("keypress",e.handleKeyPress),document.querySelector("body").addEventListener("keydown",e.handleKeyDown),document.querySelector("body").addEventListener("keyup",e.handleKeyUp),document.addEventListener("pointerlockchange",e.handlePointerLockChange),n.addEventListener("touchstart",e.handleTouchStart,!1)},e.unbindEvents=()=>{c(!1,!0),t.container.removeEventListener("contextmenu",_d),t.container.removeEventListener("wheel",e.handleWheel),t.container.removeEventListener("DOMMouseScroll",e.handleWheel),t.container.removeEventListener("mousemove",e.handleMouseMove),t.container.removeEventListener("mousedown",e.handleMouseDown),document.querySelector("body").removeEventListener("keypress",e.handleKeyPress),document.querySelector("body").removeEventListener("keydown",e.handleKeyDown),document.querySelector("body").removeEventListener("keyup",e.handleKeyUp),document.removeEventListener("pointerlockchange",e.handlePointerLockChange),t.container.removeEventListener("touchstart",e.handleTouchStart),t.container=null},e.handleKeyPress=t=>{const n=l(t);e.keyPressEvent(n)},e.handleKeyDown=t=>{const n=l(t);e.keyDownEvent(n)},e.handleKeyUp=t=>{const n=l(t);e.keyUpEvent(n)},e.handleMouseDown=t=>{if(t.button>2)return;c(!0),t.stopPropagation(),t.preventDefault();const n={position:a(t)},r=s(t);switch(Object.assign(n,r),t.button){case 0:e.leftButtonPressEvent(n);break;case 1:e.middleButtonPressEvent(n);break;case 2:e.rightButtonPressEvent(n);break;default:Od("Unknown mouse button pressed: "+t.button)}},e.requestPointerLock=()=>{e.getView().getCanvas().requestPointerLock()},e.exitPointerLock=()=>document.exitPointerLock(),e.isPointerLocked=()=>!!document.pointerLockElement,e.handlePointerLockChange=()=>{e.isPointerLocked()?e.startPointerLockEvent():e.endPointerLockEvent()},e.requestAnimation=r=>{void 0!==r?n.has(r)?Pd("requester is already registered for animating"):(n.add(r),1===n.size&&(t.lastFrameTime=.1,t.lastFrameStart=Date.now(),t.animationRequest=requestAnimationFrame(e.handleAnimation),e.startAnimationEvent())):Od("undefined requester, can not start animating")},e.isAnimating=()=>t.vrAnimation||null!==t.animationRequest,e.cancelAnimation=(r,o=!1)=>{if(n.has(r))n.delete(r),t.animationRequest&&0===n.size&&(cancelAnimationFrame(t.animationRequest),t.animationRequest=null,e.endAnimationEvent(),e.render());else if(!o){const e=r&&r.getClassName?r.getClassName():r;Pd(e+" did not request an animation")}},e.switchToVRAnimation=()=>{t.animationRequest&&(cancelAnimationFrame(t.animationRequest),t.animationRequest=null),t.vrAnimation=!0},e.returnFromVRAnimation=()=>{t.vrAnimation=!1,0!==n.size&&(t.FrameTime=-1,t.animationRequest=requestAnimationFrame(e.handleAnimation))},e.updateGamepads=n=>{const r=navigator.getGamepads();for(let o=0;o<r.length;++o){const a=r[o];if(a&&a.displayId===n){a.index in t.lastGamepadValues||(t.lastGamepadValues[a.index]={buttons:{}});for(let n=0;n<a.buttons.length;++n)n in t.lastGamepadValues[a.index].buttons||(t.lastGamepadValues[a.index].buttons[n]=!1),t.lastGamepadValues[a.index].buttons[n]!==a.buttons[n].pressed&&(e.button3DEvent({gamepad:a,position:a.pose.position,orientation:a.pose.orientation,pressed:a.buttons[n].pressed,device:"left"===a.hand?wd.LeftController:wd.RightController,input:Vd[a.id]&&Vd[a.id][n]?Vd[a.id][n]:Rd.Trigger}),t.lastGamepadValues[a.index].buttons[n]=a.buttons[n].pressed),t.lastGamepadValues[a.index].buttons[n]&&e.move3DEvent({gamepad:a,position:a.pose.position,orientation:a.pose.orientation,device:"left"===a.hand?wd.LeftController:wd.RightController})}}},e.handleMouseMove=n=>{const r={position:a(n)},o=s(n);Object.assign(r,o),0===t.moveTimeoutID?e.startMouseMoveEvent(r):(e.mouseMoveEvent(r),clearTimeout(t.moveTimeoutID)),t.moveTimeoutID=setTimeout(()=>{e.endMouseMoveEvent(),t.moveTimeoutID=0},200)},e.handleAnimation=()=>{const n=Date.now();-1===t.FrameTime?t.lastFrameTime=.1:t.lastFrameTime=(n-t.lastFrameStart)/1e3,t.lastFrameTime=Math.max(.01,t.lastFrameTime),t.lastFrameStart=n,e.animationEvent(),u(),t.animationRequest=requestAnimationFrame(e.handleAnimation)},e.handleWheel=n=>{n.stopPropagation(),n.preventDefault();const r=Id(n),o=s(n);Object.assign(r,o),0===t.wheelTimeoutID?e.startMouseWheelEvent(r):(e.mouseWheelEvent(r),clearTimeout(t.wheelTimeoutID)),t.wheelTimeoutID=setTimeout(()=>{e.endMouseWheelEvent(),t.wheelTimeoutID=0},200)},e.handleMouseUp=t=>{c(!1),t.stopPropagation(),t.preventDefault();const n={position:a(t)},r=s(t);switch(Object.assign(n,r),t.button){case 0:e.leftButtonReleaseEvent(n);break;case 1:e.middleButtonReleaseEvent(n);break;case 2:e.rightButtonReleaseEvent(n);break;default:Od("Unknown mouse button released: "+t.button)}},e.handleTouchStart=n=>{if(c(!0),n.stopPropagation(),n.preventDefault(),t.recognizeGestures&&n.touches.length>1){const t=i(n.touches);if(2===n.touches.length){const t={position:a(n.touches[0]),shiftKey:!1,altKey:!1,controlKey:!1};e.leftButtonReleaseEvent(t)}e.recognizeGesture("TouchStart",t)}else{const t={position:a(n.touches[0]),shiftKey:!1,altKey:!1,controlKey:!1};e.leftButtonPressEvent(t)}},e.handleTouchMove=n=>{if(n.stopPropagation(),n.preventDefault(),t.recognizeGestures&&n.touches.length>1){const t=i(n.touches);e.recognizeGesture("TouchMove",t)}else{const t={position:a(n.touches[0]),shiftKey:!1,altKey:!1,controlKey:!1};e.mouseMoveEvent(t)}},e.handleTouchEnd=n=>{if(n.stopPropagation(),n.preventDefault(),t.recognizeGestures)if(0===n.touches.length)if(1===n.changedTouches.length){const t={position:a(n.changedTouches[0]),shiftKey:!1,altKey:!1,controlKey:!1};e.leftButtonReleaseEvent(t),c(!1)}else{const t=i(n.changedTouches);e.recognizeGesture("TouchEnd",t),c(!1)}else if(1===n.touches.length){const t=i(n.changedTouches);e.recognizeGesture("TouchEnd",t);const r={position:a(n.touches[0]),shiftKey:!1,altKey:!1,controlKey:!1};e.leftButtonPressEvent(r)}else{const t=i(n.touches);e.recognizeGesture("TouchMove",t)}else{const t={position:a(n.changedTouches[0]),shiftKey:!1,altKey:!1,controlKey:!1};e.leftButtonReleaseEvent(t),c(!1)}},e.setView=n=>{t.view!==n&&(t.view=n,t.view.getRenderable().setInteractor(e),e.modified())},e.findPokedRenderer=(e=0,n=0)=>{if(!t.view)return null;const r=t.view.getRenderable().getRenderersByReference();r.sort((e,t)=>e.getLayer()-t.getLayer());let o=null,a=null,i=null,s=r.length;for(;s--;){const l=r[s];if(t.view.isInViewport(e,n,l)&&l.getInteractive()){i=l;break}null===o&&l.getInteractive()&&(o=l),null===a&&t.view.isInViewport(e,n,l)&&(a=l)}return null===i&&(i=o),null===i&&(i=a),null==i&&(i=r[0]),i},e.render=()=>{null!==t.animationRequest||t.inRender||u()},Ld.forEach(n=>{const r=n.charAt(0).toLowerCase()+n.slice(1);e[r+"Event"]=r=>{if(!t.enabled)return;if(!e.getCurrentRenderer())return void Dd("\n          Can not forward events without a current renderer on the interactor.\n        ");const o={type:n,pokedRenderer:t.currentRenderer};Object.assign(o,r),e["invoke"+n](o)}}),e.recognizeGesture=(n,r)=>{if(Object.keys(r).length>2)return;if(t.startingEventPositions||(t.startingEventPositions={}),"TouchStart"===n)return Object.keys(r).forEach(e=>{t.startingEventPositions[e]=r[e]}),void(t.currentGesture="Start");if("TouchEnd"===n)return"Pinch"===t.currentGesture&&(e.render(),e.endPinchEvent()),"Rotate"===t.currentGesture&&(e.render(),e.endRotateEvent()),"Pan"===t.currentGesture&&(e.render(),e.endPanEvent()),t.currentGesture="Start",void(t.startingEventPositions={});let o=0;const a=[],i=[];Object.keys(r).forEach(e=>{a[o]=r[e],i[o]=t.startingEventPositions[e],o++});const s=Math.sqrt((i[0].x-i[1].x)*(i[0].x-i[1].x)+(i[0].y-i[1].y)*(i[0].y-i[1].y)),l=Math.sqrt((a[0].x-a[1].x)*(a[0].x-a[1].x)+(a[0].y-a[1].y)*(a[0].y-a[1].y));let c=Fr(Math.atan2(i[1].y-i[0].y,i[1].x-i[0].x)),u=Fr(Math.atan2(a[1].y-a[0].y,a[1].x-a[0].x)),d=u-c;u=u+180>=360?u-180:u+180,c=c+180>=360?c-180:c+180,Math.abs(u-c)<Math.abs(d)&&(d=u-c);const f=[];if(f[0]=(a[0].x-i[0].x+a[1].x-i[1].x)/2,f[1]=(a[0].y-i[0].y+a[1].y-i[1].y)/2,"TouchMove"===n)if("Start"===t.currentGesture){let n=.01*Math.sqrt(t.container.clientWidth*t.container.clientWidth+t.container.clientHeight*t.container.clientHeight);n<15&&(n=15);const o=Math.abs(l-s),a=3.1415926*l*Math.abs(d)/360,i=Math.sqrt(f[0]*f[0]+f[1]*f[1]);if(o>n&&o>a&&o>i){t.currentGesture="Pinch";const n={scale:1,touches:r};e.startPinchEvent(n)}else if(a>n&&a>i){t.currentGesture="Rotate";const n={rotation:0,touches:r};e.startRotateEvent(n)}else if(i>n){t.currentGesture="Pan";const n={translation:[0,0],touches:r};e.startPanEvent(n)}}else{if("Rotate"===t.currentGesture){const t={rotation:d,touches:r};e.rotateEvent(t)}if("Pinch"===t.currentGesture){const t={scale:l/s,touches:r};e.pinchEvent(t)}if("Pan"===t.currentGesture){const t={translation:f,touches:r};e.panEvent(t)}}},e.handleVisibilityChange=()=>{t.lastFrameStart=Date.now()};const d=e.delete;e.delete=()=>{for(;n.size;)e.cancelAnimation(n.values().next().value);void 0!==document.hidden&&document.removeEventListener("visibilitychange",e.handleVisibilityChange),d()},void 0!==document.hidden&&document.addEventListener("visibilitychange",e.handleVisibilityChange,!1)}(e,t)}var Bd={newInstance:C.default.newInstance(Nd,"vtkRenderWindowInteractor"),extend:Nd,handledEvents:Ld,...Sd};const{vtkDebugMacro:kd}=C.default;const Gd={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function Ud(e,t,n={}){Object.assign(t,Gd,n),C.default.obj(e,t),C.default.get(e,t,["distance"]),C.default.setGet(e,t,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),C.default.getArray(e,t,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),C.default.setGetArray(e,t,["clippingRange","windowCenter"],2),C.default.setGetArray(e,t,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),function(e,t){t.classHierarchy.push("vtkCamera");const n=i.create(),r=i.fromValues(0,0,-1),o=i.fromValues(0,1,0),c=a.create(),u=i.create(),d=i.create(),f=i.create(),p=a.create(),m=a.create(),g=i.create(),h=i.create();function A(){t.viewPlaneNormal[0]=-t.directionOfProjection[0],t.viewPlaneNormal[1]=-t.directionOfProjection[1],t.viewPlaneNormal[2]=-t.directionOfProjection[2]}e.orthogonalizeViewUp=()=>{const n=e.getViewMatrix();t.viewUp[0]=n[4],t.viewUp[1]=n[5],t.viewUp[2]=n[6],e.modified()},e.setPosition=(n,r,o)=>{n===t.position[0]&&r===t.position[1]&&o===t.position[2]||(t.position[0]=n,t.position[1]=r,t.position[2]=o,e.computeDistance(),e.modified())},e.setFocalPoint=(n,r,o)=>{n===t.focalPoint[0]&&r===t.focalPoint[1]&&o===t.focalPoint[2]||(t.focalPoint[0]=n,t.focalPoint[1]=r,t.focalPoint[2]=o,e.computeDistance(),e.modified())},e.setDistance=n=>{if(t.distance===n)return;t.distance=n,t.distance<1e-20&&(t.distance=1e-20,kd("Distance is set to minimum."));const r=t.directionOfProjection;t.focalPoint[0]=t.position[0]+r[0]*t.distance,t.focalPoint[1]=t.position[1]+r[1]*t.distance,t.focalPoint[2]=t.position[2]+r[2]*t.distance,e.modified()},e.computeDistance=()=>{const e=t.focalPoint[0]-t.position[0],n=t.focalPoint[1]-t.position[1],r=t.focalPoint[2]-t.position[2];if(t.distance=Math.sqrt(e*e+n*n+r*r),t.distance<1e-20){t.distance=1e-20,kd("Distance is set to minimum.");const e=t.directionOfProjection;t.focalPoint[0]=t.position[0]+e[0]*t.distance,t.focalPoint[1]=t.position[1]+e[1]*t.distance,t.focalPoint[2]=t.position[2]+e[2]*t.distance}t.directionOfProjection[0]=e/t.distance,t.directionOfProjection[1]=n/t.distance,t.directionOfProjection[2]=r/t.distance,A()},e.dolly=n=>{if(n<=0)return;const r=t.distance/n;e.setPosition(t.focalPoint[0]-r*t.directionOfProjection[0],t.focalPoint[1]-r*t.directionOfProjection[1],t.focalPoint[2]-r*t.directionOfProjection[2])},e.roll=n=>{const r=t.position,o=t.focalPoint,l=t.viewUp,c=s.fromValues(l[0],l[1],l[2],0);a.identity(p);const u=i.fromValues(o[0]-r[0],o[1]-r[1],o[2]-r[2]);a.rotate(p,p,_r(n),u),s.transformMat4(c,c,p),t.viewUp[0]=c[0],t.viewUp[1]=c[1],t.viewUp[2]=c[2],e.modified()},e.azimuth=n=>{const r=t.focalPoint;a.identity(m),a.translate(m,m,i.fromValues(r[0],r[1],r[2])),a.rotate(m,m,_r(n),i.fromValues(t.viewUp[0],t.viewUp[1],t.viewUp[2])),a.translate(m,m,i.fromValues(-r[0],-r[1],-r[2])),i.transformMat4(g,i.fromValues(t.position[0],t.position[1],t.position[2]),m),e.setPosition(g[0],g[1],g[2])},e.yaw=n=>{const r=t.position;a.identity(m),a.translate(m,m,i.fromValues(r[0],r[1],r[2])),a.rotate(m,m,_r(n),i.fromValues(t.viewUp[0],t.viewUp[1],t.viewUp[2])),a.translate(m,m,i.fromValues(-r[0],-r[1],-r[2])),i.transformMat4(h,i.fromValues(t.focalPoint[0],t.focalPoint[1],t.focalPoint[2]),m),e.setFocalPoint(h[0],h[1],h[2])},e.elevation=n=>{const r=t.focalPoint,o=e.getViewMatrix(),s=[-o[0],-o[1],-o[2]];a.identity(m),a.translate(m,m,i.fromValues(r[0],r[1],r[2])),a.rotate(m,m,_r(n),i.fromValues(s[0],s[1],s[2])),a.translate(m,m,i.fromValues(-r[0],-r[1],-r[2])),i.transformMat4(g,i.fromValues(t.position[0],t.position[1],t.position[2]),m),e.setPosition(g[0],g[1],g[2])},e.pitch=n=>{const r=t.position,o=e.getViewMatrix(),s=[o[0],o[1],o[2]];a.identity(m),a.translate(m,m,i.fromValues(r[0],r[1],r[2])),a.rotate(m,m,_r(n),i.fromValues(s[0],s[1],s[2])),a.translate(m,m,i.fromValues(-r[0],-r[1],-r[2])),i.transformMat4(h,i.fromValues(...t.focalPoint),m),e.setFocalPoint(...h)},e.zoom=n=>{n<=0||(t.parallelProjection?t.parallelScale/=n:t.viewAngle/=n,e.modified())},e.translate=(n,r,o)=>{const a=[n,r,o];Hr(t.position,a,t.position),Hr(t.focalPoint,a,t.focalPoint),e.computeDistance(),e.modified()},e.applyTransform=n=>{const r=[...t.viewUp,1],o=[],a=[],i=[];r[0]+=t.position[0],r[1]+=t.position[1],r[2]+=t.position[2],s.transformMat4(o,[...t.position,1],n),s.transformMat4(a,[...t.focalPoint,1],n),s.transformMat4(i,r,n),i[0]-=o[0],i[1]-=o[1],i[2]-=o[2],e.setPosition(...o.slice(0,3)),e.setFocalPoint(...a.slice(0,3)),e.setViewUp(...i.slice(0,3))},e.getThickness=()=>t.clippingRange[1]-t.clippingRange[0],e.setThickness=n=>{let r=n;r<1e-20&&(r=1e-20,kd("Thickness is set to minimum.")),e.setClippingRange(t.clippingRange[0],t.clippingRange[0]+r)},e.setThicknessFromFocalPoint=n=>{let r=n;r<1e-20&&(r=1e-20,kd("Thickness is set to minimum.")),e.setClippingRange(t.distance-r/2,t.distance+r/2)},e.setRoll=e=>{},e.getRoll=()=>{},e.setObliqueAngles=(e,t)=>{},e.getOrientation=()=>{},e.getOrientationWXYZ=()=>{},e.getFrustumPlanes=e=>{},e.getCameraLightTransformMatrix=()=>{},e.deepCopy=e=>{},e.physicalOrientationToWorldDirection=e=>{const t=l.fromValues(e[0],e[1],e[2],e[3]),n=l.create(),r=l.fromValues(0,0,1,0);return l.conjugate(n,t),l.multiply(r,t,r),l.multiply(r,r,n),[r[0],r[1],r[2]]},e.getPhysicalToWorldMatrix=t=>{e.getWorldToPhysicalMatrix(t),a.invert(t,t)},e.getWorldToPhysicalMatrix=e=>{a.identity(e);const n=[3];Xr(t.physicalViewNorth,t.physicalViewUp,n),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[4]=t.physicalViewUp[0],e[5]=t.physicalViewUp[1],e[6]=t.physicalViewUp[2],e[8]=-t.physicalViewNorth[0],e[9]=-t.physicalViewNorth[1],e[10]=-t.physicalViewNorth[2],a.transpose(e,e),i.set(u,1/t.physicalScale,1/t.physicalScale,1/t.physicalScale),a.scale(e,e,u),a.translate(e,e,t.physicalTranslation)},e.computeViewParametersFromViewMatrix=s=>{a.invert(c,s),i.transformMat4(u,n,c),e.computeDistance();const l=t.distance;e.setPosition(u[0],u[1],u[2]),i.transformMat4(d,r,c),i.subtract(d,d,u),i.normalize(d,d),e.setDirectionOfProjection(d[0],d[1],d[2]),i.transformMat4(f,o,c),i.subtract(f,f,u),i.normalize(f,f),e.setViewUp(f[0],f[1],f[2]),e.setDistance(l)},e.computeViewParametersFromPhysicalMatrix=t=>{e.getWorldToPhysicalMatrix(c),a.multiply(c,t,c),e.computeViewParametersFromViewMatrix(c)},e.setViewMatrix=n=>{t.viewMatrix=n,t.viewMatrix&&(a.copy(c,t.viewMatrix),e.computeViewParametersFromViewMatrix(c),a.transpose(t.viewMatrix,t.viewMatrix))},e.getViewMatrix=()=>{if(t.viewMatrix)return t.viewMatrix;const e=a.create();return a.lookAt(c,i.fromValues(...t.position),i.fromValues(...t.focalPoint),i.fromValues(...t.viewUp)),a.transpose(c,c),a.copy(e,c),e},e.setProjectionMatrix=e=>{t.projectionMatrix=e},e.getProjectionMatrix=(e,n,r)=>{const o=a.create();if(t.projectionMatrix){const e=1/t.physicalScale;return i.set(u,e,e,e),a.copy(o,t.projectionMatrix),a.scale(o,o,u),a.transpose(o,o),o}a.identity(c);const s=t.clippingRange[1]-t.clippingRange[0],l=[t.clippingRange[0]+(n+1)*s/2,t.clippingRange[0]+(r+1)*s/2];if(t.parallelProjection){const n=t.parallelScale*e,r=t.parallelScale,o=(t.windowCenter[0]-1)*n,i=(t.windowCenter[0]+1)*n,s=(t.windowCenter[1]-1)*r,u=(t.windowCenter[1]+1)*r;a.ortho(c,o,i,s,u,l[0],l[1]),a.transpose(c,c)}else{if(t.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const n=Math.tan(_r(t.viewAngle)/2);let r,o;!0===t.useHorizontalViewAngle?(r=t.clippingRange[0]*n,o=t.clippingRange[0]*n/e):(r=t.clippingRange[0]*n*e,o=t.clippingRange[0]*n);const a=(t.windowCenter[0]-1)*r,i=(t.windowCenter[0]+1)*r,s=(t.windowCenter[1]-1)*o,u=(t.windowCenter[1]+1)*o,d=l[0],f=l[1];c[0]=2*d/(i-a),c[5]=2*d/(u-s),c[2]=(a+i)/(i-a),c[6]=(s+u)/(u-s),c[10]=-(d+f)/(f-d),c[14]=-1,c[11]=-2*d*f/(f-d),c[15]=0}}return a.copy(o,c),o},e.getCompositeProjectionMatrix=(t,n,r)=>{const o=e.getViewMatrix(),i=e.getProjectionMatrix(t,n,r),s=a.create();return a.multiply(s,o,i),s},e.setDirectionOfProjection=(e,n,r)=>{if(t.directionOfProjection[0]===e&&t.directionOfProjection[1]===n&&t.directionOfProjection[2]===r)return;t.directionOfProjection[0]=e,t.directionOfProjection[1]=n,t.directionOfProjection[2]=r;const o=t.directionOfProjection;t.focalPoint[0]=t.position[0]+o[0]*t.distance,t.focalPoint[1]=t.position[1]+o[1]*t.distance,t.focalPoint[2]=t.position[2]+o[2]*t.distance,A()},e.setDeviceAngles=(n,r,o,s)=>{const l=[3];Xr(t.physicalViewNorth,t.physicalViewUp,l);const c=a.create();a.rotate(c,c,_r(n),t.physicalViewUp),a.rotate(c,c,_r(r),l),a.rotate(c,c,_r(o),t.physicalViewNorth),a.rotate(c,c,_r(-s),t.physicalViewUp);const u=i.fromValues(-t.physicalViewUp[0],-t.physicalViewUp[1],-t.physicalViewUp[2]),d=i.fromValues(t.physicalViewNorth[0],t.physicalViewNorth[1],t.physicalViewNorth[2]);i.transformMat4(u,u,c),i.transformMat4(d,d,c),e.setDirectionOfProjection(u[0],u[1],u[2]),e.setViewUp(d[0],d[1],d[2]),e.modified()},e.setOrientationWXYZ=(t,n,r,o)=>{const s=a.create();if(0!==t&&(0!==n||0!==r||0!==o)){const e=_r(t),i=l.create();l.setAxisAngle(i,[n,r,o],e),a.fromQuat(s,i)}const c=i.fromValues(0,0,-1),u=i.create();i.transformMat4(u,c,s);const d=i.fromValues(0,1,0),f=i.create();i.transformMat4(f,d,s),e.setDirectionOfProjection(...u),e.setViewUp(...f),e.modified()},e.computeClippingRange=e=>{let n=null,r=null;n=t.viewPlaneNormal,r=t.position;const o=-n[0],a=-n[1],i=-n[2],s=-(o*r[0]+a*r[1]+i*r[2]),l=[o*e[0]+a*e[2]+i*e[4]+s,1e-18];for(let t=0;t<2;t++)for(let n=0;n<2;n++)for(let r=0;r<2;r++){const c=o*e[r]+a*e[2+n]+i*e[4+t]+s;l[0]=c<l[0]?c:l[0],l[1]=c>l[1]?c:l[1]}return l}}(e,t)}var Wd={newInstance:C.default.newInstance(Ud,"vtkCamera"),extend:Ud};const zd={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function Hd(e,t,n={}){Object.assign(t,zd,n),C.default.obj(e,t),C.default.setGet(e,t,["intensity","switch","positional","exponent","coneAngle","transformMatrix","lightType","shadowAttenuation"]),C.default.setGetArray(e,t,["color","position","focalPoint","attenuationValues"],3),function(e,t){t.classHierarchy.push("vtkLight"),e.getTransformedPosition=()=>t.transformMatrix?[]:[].concat(t.position),e.getTransformedFocalPoint=()=>t.transformMatrix?[]:[].concat(t.focalPoint),e.getDirection=()=>(t.directionMTime<t.mtime&&(t.direction[0]=t.focalPoint[0]-t.position[0],t.direction[1]=t.focalPoint[1]-t.position[1],t.direction[2]=t.focalPoint[2]-t.position[2],Yr(t.direction),t.directionMTime=t.mtime),t.direction),e.setDirectionAngle=(t,n)=>{const r=_r(t),o=_r(n);e.setPosition(Math.cos(r)*Math.sin(o),Math.sin(r),Math.cos(r)*Math.cos(o)),e.setFocalPoint(0,0,0),e.setPositional(0)},e.setLightTypeToHeadLight=()=>{e.setLightType("HeadLight")},e.setLightTypeToCameraLight=()=>{e.setLightType("CameraLight")},e.setLightTypeToSceneLight=()=>{e.setTransformMatrix(null),e.setLightType("SceneLight")},e.lightTypeIsHeadLight=()=>"HeadLight"===t.lightType,e.lightTypeIsSceneLight=()=>"SceneLight"===t.lightType,e.lightTypeIsCameraLight=()=>"CameraLight"===t.lightType}(e,t)}var jd={newInstance:C.default.newInstance(Hd,"vtkLight"),extend:Hd,LIGHT_TYPES:["HeadLight","CameraLight","SceneLight"]};const{vtkErrorMacro:Kd}=C.default;function Xd(e,t){function n(e,t=[]){t.push(e);const r=e.getNestedProps();if(r&&r.length)for(let e=0;e<r.length;e++)n(r[e],t);return t}var r;t.classHierarchy.push("vtkViewport"),e.getViewProps=()=>t.props,e.hasViewProp=e=>!!t.props.filter(t=>t===e).length,e.addViewProp=n=>{n&&!e.hasViewProp(n)&&(t.props=t.props.concat(n))},e.removeViewProp=e=>{const n=t.props.filter(t=>t!==e);t.props.length!==n.length&&(t.props=n)},e.removeAllViewProps=()=>{t.props=[]},e.getViewPropsWithNestedProps=()=>{const e=[];for(let r=0;r<t.props.length;r++)n(t.props[r],e);return e},e.addActor2D=e.addViewProp,e.removeActor2D=t=>{e.removeViewProp(t)},e.getActors2D=()=>(t.actors2D=[],t.props.forEach(e=>{t.actors2D=t.actors2D.concat(e.getActors2D())}),t.actors2D),e.displayToView=()=>Kd("call displayToView on your view instead"),e.viewToDisplay=()=>Kd("callviewtodisplay on your view instead"),e.getSize=()=>Kd("call getSize on your View instead"),e.normalizedDisplayToProjection=(t,n,r)=>{const o=e.normalizedDisplayToNormalizedViewport(t,n,r);return e.normalizedViewportToProjection(o[0],o[1],o[2])},e.normalizedDisplayToNormalizedViewport=(e,n,r)=>{const o=[t.viewport[2]-t.viewport[0],t.viewport[3]-t.viewport[1]];return[(e-t.viewport[0])/o[0],(n-t.viewport[1])/o[1],r]},e.normalizedViewportToProjection=(e,t,n)=>[2*e-1,2*t-1,2*n-1],e.projectionToNormalizedDisplay=(t,n,r)=>{const o=e.projectionToNormalizedViewport(t,n,r);return e.normalizedViewportToNormalizedDisplay(o[0],o[1],o[2])},e.normalizedViewportToNormalizedDisplay=(e,n,r)=>{const o=[t.viewport[2]-t.viewport[0],t.viewport[3]-t.viewport[1]];return[e*o[0]+t.viewport[0],n*o[1]+t.viewport[1],r]},e.projectionToNormalizedViewport=(e,t,n)=>[.5*(e+1),.5*(t+1),.5*(n+1)],e.PickPropFrom=(r="PickPropFrom",()=>Kd(`vtkViewport::${r} - NOT IMPLEMENTED`))}const Qd={vtkWindow:null,background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function Yd(e,t,n={}){Object.assign(t,Qd,n),C.default.obj(e,t),C.default.event(e,t,"event"),C.default.setGetArray(e,t,["viewport"],4),C.default.setGetArray(e,t,["background","background2"],3),Xd(e,t)}var qd={newInstance:C.default.newInstance(Yd,"vtkViewport"),extend:Yd};const{vtkDebugMacro:Zd,vtkErrorMacro:$d,vtkWarningMacro:Jd}=C;function ef(e){return()=>$d(`vtkRenderer::${e} - NOT IMPLEMENTED`)}const tf={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,createdLight:null,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:fo(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,pass:0};function nf(e,t,n={}){Object.assign(t,tf,n),qd.extend(e,t,n),C.get(e,t,["renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),C.setGet(e,t,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","useShadows","pass"]),C.getArray(e,t,["actors","volumes","lights"]),C.setGetArray(e,t,["background"],4,1),function(e,t){for(t.classHierarchy.push("vtkRenderer"),t.background||(t.background=[0,0,0,1]);t.background.length<3;)t.background.push(0);3===t.background.length&&t.background.push(1);const n={type:"ComputeVisiblePropBoundsEvent",renderer:e},r={type:"ResetCameraClippingRangeEvent",renderer:e},o={type:"ResetCameraEvent",renderer:e};e.updateCamera=()=>(t.activeCamera||(Zd("No cameras are on, creating one."),e.getActiveCameraAndResetIfCreated()),t.activeCamera.render(e),!0),e.updateLightsGeometryToFollowCamera=()=>{const n=e.getActiveCameraAndResetIfCreated();t.lights.forEach(e=>{e.lightTypeIsSceneLight()||e.lightTypeIsCameraLight()||(e.lightTypeIsHeadLight()?(e.setPositionFrom(n.getPositionByReference()),e.setFocalPointFrom(n.getFocalPointByReference()),e.modified(n.getMTime())):$d("light has unknown light type",e.get()))})},e.updateLightGeometry=()=>!t.lightFollowCamera||e.updateLightsGeometryToFollowCamera(),e.allocateTime=ef("allocateTime"),e.updateGeometry=ef("updateGeometry"),e.getVTKWindow=()=>t.renderWindow,e.setLayer=n=>{Zd(e.getClassName(),e,"setting Layer to ",n),t.layer!==n&&(t.layer=n,e.modified()),e.setPreserveColorBuffer(!!n)},e.setActiveCamera=n=>t.activeCamera!==n&&(t.activeCamera=n,e.modified(),e.invokeEvent({type:"ActiveCameraEvent",camera:n}),!0),e.makeCamera=()=>{const t=Wd.newInstance();return e.invokeEvent({type:"CreateCameraEvent",camera:t}),t},e.getActiveCamera=()=>(t.activeCamera||(t.activeCamera=e.makeCamera()),t.activeCamera),e.getActiveCameraAndResetIfCreated=()=>(t.activeCamera||(e.getActiveCamera(),e.resetCamera()),t.activeCamera),e.getActors=()=>(t.actors=[],t.props.forEach(e=>{t.actors=t.actors.concat(e.getActors())}),t.actors),e.addActor=e.addViewProp,e.removeActor=n=>{t.actors=t.actors.filter(e=>e!==n),e.removeViewProp(n),e.modified()},e.removeAllActors=()=>{t.actors.forEach(t=>{e.removeViewProp(t)}),t.actors=[],e.modified()},e.getVolumes=()=>(t.volumes=[],t.props.forEach(e=>{t.volumes=t.volumes.concat(e.getVolumes())}),t.volumes),e.addVolume=e.addViewProp,e.removeVolume=n=>{t.volumes=t.volumes.filter(e=>e!==n),e.removeViewProp(n),e.modified()},e.removeAllVolumes=()=>{t.volumes.forEach(t=>{e.removeViewProp(t)}),t.volumes=[],e.modified()},e.addLight=n=>{t.lights=[].concat(t.lights,n),e.modified()},e.removeLight=n=>{t.lights=t.lights.filter(e=>e!==n),e.modified()},e.removeAllLights=()=>{t.lights=[],e.modified()},e.setLightCollection=n=>{t.lights=n,e.modified()},e.makeLight=jd.newInstance,e.createLight=()=>{t.automaticLightCreation&&(t.createdLight&&(e.removeLight(t.createdLight),t.createdLight.delete(),t.createdLight=null),t.createdLight=e.makeLight(),e.addLight(t.createdLight),t.createdLight.setLightTypeToHeadLight(),t.createdLight.setPosition(e.getActiveCamera().getPosition()),t.createdLight.setFocalPoint(e.getActiveCamera().getFocalPoint()))},e.normalizedDisplayToWorld=(t,n,r,o)=>{let a=e.normalizedDisplayToProjection(t,n,r);return a=e.projectionToView(a[0],a[1],a[2],o),e.viewToWorld(a[0],a[1],a[2])},e.worldToNormalizedDisplay=(t,n,r,o)=>{let a=e.worldToView(t,n,r);return a=e.viewToProjection(a[0],a[1],a[2],o),e.projectionToNormalizedDisplay(a[0],a[1],a[2])},e.viewToWorld=(e,n,r)=>{if(null===t.activeCamera)return $d("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const o=t.activeCamera.getViewMatrix();a.invert(o,o),a.transpose(o,o);const s=i.fromValues(e,n,r);return i.transformMat4(s,s,o),[s[0],s[1],s[2]]},e.projectionToView=(e,n,r,o)=>{if(null===t.activeCamera)return $d("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const s=t.activeCamera.getProjectionMatrix(o,-1,1);a.invert(s,s),a.transpose(s,s);const l=i.fromValues(e,n,r);return i.transformMat4(l,l,s),[l[0],l[1],l[2]]},e.worldToView=(e,n,r)=>{if(null===t.activeCamera)return $d("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const o=t.activeCamera.getViewMatrix();a.transpose(o,o);const s=i.fromValues(e,n,r);return i.transformMat4(s,s,o),[s[0],s[1],s[2]]},e.viewToProjection=(e,n,r,o)=>{if(null===t.activeCamera)return $d("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const s=t.activeCamera.getProjectionMatrix(o,-1,1);a.transpose(s,s);const l=i.fromValues(e,n,r);return i.transformMat4(l,l,s),[l[0],l[1],l[2]]},e.computeVisiblePropBounds=()=>{t.allBounds[0]=la.INIT_BOUNDS[0],t.allBounds[1]=la.INIT_BOUNDS[1],t.allBounds[2]=la.INIT_BOUNDS[2],t.allBounds[3]=la.INIT_BOUNDS[3],t.allBounds[4]=la.INIT_BOUNDS[4],t.allBounds[5]=la.INIT_BOUNDS[5];let r=!0;e.invokeEvent(n);for(let e=0;e<t.props.length;++e){const n=t.props[e];if(n.getVisibility()&&n.getUseBounds()){const e=n.getBounds();e&&ro(e)&&(r=!1,e[0]<t.allBounds[0]&&(t.allBounds[0]=e[0]),e[1]>t.allBounds[1]&&(t.allBounds[1]=e[1]),e[2]<t.allBounds[2]&&(t.allBounds[2]=e[2]),e[3]>t.allBounds[3]&&(t.allBounds[3]=e[3]),e[4]<t.allBounds[4]&&(t.allBounds[4]=e[4]),e[5]>t.allBounds[5]&&(t.allBounds[5]=e[5]))}}return r&&(no(t.allBounds),Zd("Can't compute bounds, no 3D props are visible")),t.allBounds},e.resetCamera=(n=null)=>{const r=n||e.computeVisiblePropBounds(),a=[0,0,0];if(!ro(r))return Zd("Cannot reset camera!"),!1;let i=null;if(!e.getActiveCamera())return $d("Trying to reset non-existent camera"),!1;i=t.activeCamera.getViewPlaneNormal(),t.activeCamera.setViewAngle(30),a[0]=(r[0]+r[1])/2,a[1]=(r[2]+r[3])/2,a[2]=(r[4]+r[5])/2;let s=r[1]-r[0],l=r[3]-r[2],c=r[5]-r[4];s*=s,l*=l,c*=c;let u=s+l+c;u=0===u?1:u,u=.5*Math.sqrt(u);const d=_r(t.activeCamera.getViewAngle()),f=u,p=u/Math.sin(.5*d),m=t.activeCamera.getViewUp();return Math.abs(Kr(m,i))>.999&&(Jd("Resetting view-up since view plane normal is parallel"),t.activeCamera.setViewUp(-m[2],m[0],m[1])),t.activeCamera.setFocalPoint(a[0],a[1],a[2]),t.activeCamera.setPosition(a[0]+p*i[0],a[1]+p*i[1],a[2]+p*i[2]),e.resetCameraClippingRange(r),t.activeCamera.setParallelScale(f),t.activeCamera.setPhysicalScale(u),t.activeCamera.setPhysicalTranslation(-a[0],-a[1],-a[2]),e.invokeEvent(o),!0},e.resetCameraClippingRange=(n=null)=>{const o=n||e.computeVisiblePropBounds();if(!ro(o))return Zd("Cannot reset camera clipping range!"),!1;if(e.getActiveCameraAndResetIfCreated(),!t.activeCamera)return $d("Trying to reset clipping range of non-existent camera"),!1;const a=t.activeCamera.computeClippingRange(o);let i=0;if(t.activeCamera.getParallelProjection())i=.1*t.activeCamera.getParallelScale();else{const e=_r(t.activeCamera.getViewAngle());i=.2*Math.tan(e/2)*a[1]}return a[1]-a[0]<i&&(i=i-a[1]+a[0],a[1]+=i/2,a[0]-=i/2),a[0]<0&&(a[0]=0),a[0]=.99*a[0]-(a[1]-a[0])*t.clippingRangeExpansion,a[1]=1.01*a[1]+(a[1]-a[0])*t.clippingRangeExpansion,a[0]=a[0]>=a[1]?.01*a[1]:a[0],t.nearClippingPlaneTolerance||(t.nearClippingPlaneTolerance=.01),a[0]<t.nearClippingPlaneTolerance*a[1]&&(a[0]=t.nearClippingPlaneTolerance*a[1]),t.activeCamera.setClippingRange(a[0],a[1]),e.invokeEvent(r),!1},e.setRenderWindow=e=>{e!==t.renderWindow&&(t.vtkWindow=e,t.renderWindow=e)},e.visibleActorCount=()=>t.props.filter(e=>e.getVisibility()).length,e.visibleVolumeCount=e.visibleActorCount,e.getMTime=()=>{let e=t.mtime;const n=t.activeCamera?t.activeCamera.getMTime():0;n>e&&(e=n);const r=t.createdLight?t.createdLight.getMTime():0;return r>e&&(e=r),e},e.getTransparent=()=>!!t.preserveColorBuffer,e.isActiveCameraCreated=()=>!!t.activeCamera}(e,t)}var rf={newInstance:C.newInstance(nf,"vtkRenderer"),extend:nf};const{vtkErrorMacro:of,VOID:af}=C.default;const sf={computeWorldToDisplay:function(e,t,n,r){return e.getRenderWindow().getViews()[0].worldToDisplay(t,n,r,e)},computeDisplayToWorld:function(e,t,n,r){return e.getRenderWindow().getViews()[0].displayToWorld(t,n,r,e)}};const lf={enabled:!0,interactor:null,priority:0,processEvents:!0,subscribedEvents:[]};function cf(e,t,n={}){Object.assign(t,lf,n),C.default.obj(e,t),C.default.event(e,t,"InteractionEvent"),C.default.event(e,t,"StartInteractionEvent"),C.default.event(e,t,"EndInteractionEvent"),C.default.get(e,t,["interactor","enabled"]),C.default.setGet(e,t,["priority","processEvents"]),function(e,t){t.classHierarchy.push("vtkInteractorObserver");const n={...e};function r(){for(;t.subscribedEvents.length;)t.subscribedEvents.pop().unsubscribe()}function o(){Bd.handledEvents.forEach(n=>{e["handle"+n]&&t.subscribedEvents.push(t.interactor["on"+n](r=>t.processEvents?e["handle"+n](r):af,t.priority))})}e.setInteractor=n=>{n!==t.interactor&&(r(),t.interactor=n,n&&t.enabled&&o(),e.modified())},e.setEnabled=n=>{n!==t.enabled&&(r(),n&&(t.interactor?o():of("\n          The interactor must be set before subscribing to events\n        ")),t.enabled=n,e.modified())},e.computeDisplayToWorld=(e,n,r,o)=>e?t.interactor.getView().displayToWorld(n,r,o,e):null,e.computeWorldToDisplay=(e,n,r,o)=>e?t.interactor.getView().worldToDisplay(n,r,o,e):null,e.setPriority=e=>{n.setPriority(e)&&t.interactor&&(r(),o())}}(e,t)}var uf={newInstance:C.default.newInstance(cf,"vtkInteractorObserver"),extend:cf,...sf};var df={States:{IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025}};const{States:ff}=df,pf={Rotate:ff.IS_ROTATE,Pan:ff.IS_PAN,Spin:ff.IS_SPIN,Dolly:ff.IS_DOLLY,CameraPose:ff.IS_CAMERA_POSE,WindowLevel:ff.IS_WINDOW_LEVEL,Slice:ff.IS_SLICE};const mf={state:ff.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function gf(e,t,n={}){Object.assign(t,mf,n),uf.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkInteractorStyle"),Object.keys(pf).forEach(n=>{C.default.event(e,t,`Start${n}Event`),e["start"+n]=()=>{t.state===ff.IS_NONE&&(t.state=pf[n],t.interactor.requestAnimation(e),e.invokeStartInteractionEvent({type:"StartInteractionEvent"}),e[`invokeStart${n}Event`]({type:`Start${n}Event`}))},C.default.event(e,t,`End${n}Event`),e["end"+n]=()=>{t.state===pf[n]&&(t.state=ff.IS_NONE,t.interactor.cancelAnimation(e),e.invokeEndInteractionEvent({type:"EndInteractionEvent"}),e[`invokeEnd${n}Event`]({type:`End${n}Event`}),t.interactor.render())}}),e.handleKeyPress=e=>{const n=t.interactor;let r=null;switch(e.key){case"r":case"R":e.pokedRenderer.resetCamera(),n.render();break;case"w":case"W":r=e.pokedRenderer.getActors(),r.forEach(e=>{const t=e.getProperty();t.setRepresentationToWireframe&&t.setRepresentationToWireframe()}),n.render();break;case"s":case"S":r=e.pokedRenderer.getActors(),r.forEach(e=>{const t=e.getProperty();t.setRepresentationToSurface&&t.setRepresentationToSurface()}),n.render();break;case"v":case"V":r=e.pokedRenderer.getActors(),r.forEach(e=>{const t=e.getProperty();t.setRepresentationToPoints&&t.setRepresentationToPoints()}),n.render()}}}(e,t)}var hf={newInstance:C.default.newInstance(gf,"vtkInteractorStyle"),extend:gf,...df};const{States:Af}=df;const vf={motionFactor:10};function yf(e,t,n={}){Object.assign(t,vf,n),hf.extend(e,t,n),C.default.setGet(e,t,["motionFactor"]),function(e,t){t.classHierarchy.push("vtkInteractorStyleTrackballCamera"),e.handleMouseMove=n=>{const r=n.position,o=n.pokedRenderer;switch(t.state){case Af.IS_ROTATE:e.handleMouseRotate(o,r),e.invokeInteractionEvent({type:"InteractionEvent"});break;case Af.IS_PAN:e.handleMousePan(o,r),e.invokeInteractionEvent({type:"InteractionEvent"});break;case Af.IS_DOLLY:e.handleMouseDolly(o,r),e.invokeInteractionEvent({type:"InteractionEvent"});break;case Af.IS_SPIN:e.handleMouseSpin(o,r),e.invokeInteractionEvent({type:"InteractionEvent"})}t.previousPosition=r},e.handleButton3D=n=>{n&&n.pressed&&n.device===Ed.RightController&&n.input===Md.TrackPad?e.startCameraPose():n&&!n.pressed&&n.device===Ed.RightController&&n.input===Md.TrackPad&&t.state===Af.IS_CAMERA_POSE&&e.endCameraPose()},e.handleMove3D=n=>{switch(t.state){case Af.IS_CAMERA_POSE:e.updateCameraPose(n)}},e.updateCameraPose=e=>{const t=e.pokedRenderer.getActiveCamera(),n=t.getPhysicalTranslation(),r=.05*e.gamepad.axes[1]/t.getPhysicalScale(),o=t.physicalOrientationToWorldDirection(e.orientation);t.setPhysicalTranslation(n[0]+o[0]*r,n[1]+o[1]*r,n[2]+o[2]*r)},e.handleLeftButtonPress=n=>{const r=n.position;t.previousPosition=r,n.shiftKey?n.controlKey||n.altKey?e.startDolly():e.startPan():n.controlKey||n.altKey?e.startSpin():e.startRotate()},e.handleLeftButtonRelease=()=>{switch(t.state){case Af.IS_DOLLY:e.endDolly();break;case Af.IS_PAN:e.endPan();break;case Af.IS_SPIN:e.endSpin();break;case Af.IS_ROTATE:e.endRotate()}},e.handleStartMouseWheel=t=>{e.startDolly(),e.handleMouseWheel(t)},e.handleEndMouseWheel=()=>{e.endDolly()},e.handleStartPinch=n=>{t.previousScale=n.scale,e.startDolly()},e.handleEndPinch=()=>{e.endDolly()},e.handleStartRotate=n=>{t.previousRotation=n.rotation,e.startRotate()},e.handleEndRotate=()=>{e.endRotate()},e.handleStartPan=n=>{t.previousTranslation=n.translation,e.startPan()},e.handleEndPan=()=>{e.endPan()},e.handlePinch=n=>{e.dollyByFactor(n.pokedRenderer,n.scale/t.previousScale),t.previousScale=n.scale},e.handlePan=n=>{const r=n.pokedRenderer.getActiveCamera();let o=r.getFocalPoint();o=e.computeWorldToDisplay(n.pokedRenderer,o[0],o[1],o[2]);const a=o[2],i=n.translation,s=t.previousTranslation,l=e.computeDisplayToWorld(n.pokedRenderer,o[0]+i[0]-s[0],o[1]+i[1]-s[1],a),c=e.computeDisplayToWorld(n.pokedRenderer,o[0],o[1],a),u=[];u[0]=c[0]-l[0],u[1]=c[1]-l[1],u[2]=c[2]-l[2],o=r.getFocalPoint();const d=r.getPosition();r.setFocalPoint(u[0]+o[0],u[1]+o[1],u[2]+o[2]),r.setPosition(u[0]+d[0],u[1]+d[1],u[2]+d[2]),t.interactor.getLightFollowCamera()&&n.pokedRenderer.updateLightsGeometryToFollowCamera(),r.orthogonalizeViewUp(),t.previousTranslation=n.translation},e.handleRotate=e=>{const n=e.pokedRenderer.getActiveCamera();n.roll(e.rotation-t.previousRotation),n.orthogonalizeViewUp(),t.previousRotation=e.rotation},e.handleMouseRotate=(e,n)=>{const r=t.interactor,o=n.x-t.previousPosition.x,a=n.y-t.previousPosition.y,i=r.getView().getViewportSize(e);let s=-.1,l=-.1;i[0]&&i[1]&&(s=-20/i[1],l=-20/i[0]);const c=o*l*t.motionFactor,u=a*s*t.motionFactor,d=e.getActiveCamera();Number.isNaN(c)||Number.isNaN(u)||(d.azimuth(c),d.elevation(u),d.orthogonalizeViewUp()),t.autoAdjustCameraClippingRange&&e.resetCameraClippingRange(),r.getLightFollowCamera()&&e.updateLightsGeometryToFollowCamera()},e.handleMouseSpin=(e,n)=>{const r=t.interactor,o=e.getActiveCamera(),a=r.getView().getViewportCenter(e),i=Fr(Math.atan2(t.previousPosition.y-a[1],t.previousPosition.x-a[0])),s=Fr(Math.atan2(n.y-a[1],n.x-a[0]))-i;Number.isNaN(s)||(o.roll(s),o.orthogonalizeViewUp())},e.handleMousePan=(n,r)=>{const o=n.getActiveCamera();let a=o.getFocalPoint();a=e.computeWorldToDisplay(n,a[0],a[1],a[2]);const i=a[2],s=e.computeDisplayToWorld(n,r.x,r.y,i),l=e.computeDisplayToWorld(n,t.previousPosition.x,t.previousPosition.y,i),c=[];c[0]=l[0]-s[0],c[1]=l[1]-s[1],c[2]=l[2]-s[2],a=o.getFocalPoint();const u=o.getPosition();o.setFocalPoint(c[0]+a[0],c[1]+a[1],c[2]+a[2]),o.setPosition(c[0]+u[0],c[1]+u[1],c[2]+u[2]),t.interactor.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()},e.handleMouseDolly=(n,r)=>{const o=r.y-t.previousPosition.y,a=t.interactor.getView().getViewportCenter(n),i=t.motionFactor*o/a[1];e.dollyByFactor(n,1.1**i)},e.handleMouseWheel=t=>{const n=1-t.spinY/10;e.dollyByFactor(t.pokedRenderer,n)},e.dollyByFactor=(e,n)=>{if(Number.isNaN(n))return;const r=e.getActiveCamera();r.getParallelProjection()?r.setParallelScale(r.getParallelScale()/n):(r.dolly(n),t.autoAdjustCameraClippingRange&&e.resetCameraClippingRange()),t.interactor.getLightFollowCamera()&&e.updateLightsGeometryToFollowCamera()}}(e,t)}var bf={newInstance:C.default.newInstance(yf,"vtkInteractorStyleTrackballCamera"),extend:yf};function Tf(e){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cf(e,t){return(Cf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ef(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sf(e);if(t){var o=Sf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mf(this,n)}}function Mf(e,t){return!t||"object"!==Tf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sf(e){return(Sf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wf={width:"100%",height:"100%",position:"relative"},Rf={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},Pf={display:"none"},Of=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cf(e,t)}(a,e);var t,n,r,o=Ef(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).containerRef=u.a.createRef(),t.renderWindow=Cd.newInstance(),t.renderer=rf.newInstance({background:e.background}),t.renderWindow.addRenderer(t.renderer),t.openglRenderWindow=bd.newInstance(),t.renderWindow.addView(t.openglRenderWindow),t.interactor=Bd.newInstance(),t.interactor.setView(t.openglRenderWindow),t.interactor.initialize(),t.interactor.setInteractorStyle(bf.newInstance()),t.resizeObserver=new ResizeObserver((function(){return t.onResize()})),t.resetCamera=t.renderer.resetCamera,t.renderView=t.renderWindow.render,t}return t=a,(n=[{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,r={view:this},o=u.a.Children.map(n,(function(e){return u.a.cloneElement(e,r)}));return u.a.createElement("div",{id:t,style:wf},u.a.createElement("div",{style:Rf,ref:this.containerRef}),u.a.createElement("div",{style:Pf},o))}},{key:"onResize",value:function(){var e=this.containerRef.current;if(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;this.openglRenderWindow.setSize(Math.max(n,10),Math.max(r,10)),this.renderWindow.render()}}},{key:"componentDidMount",value:function(){var e=this.containerRef.current;this.openglRenderWindow.setContainer(e),this.interactor.bindEvents(e),this.onResize(),this.resizeObserver.observe(e)}},{key:"componentWillUnmount",value:function(){this.resizeObserver.disconnect(),this.resizeObserver=null,this.interactor.unbindEvents(),this.openglRenderWindow.setContainer(null),this.renderWindow.removeRenderer(this.renderer),this.renderWindow.removeView(this.openglRenderWindow),this.interactor.delete(),this.interactor=null,this.renderer.delete(),this.renderer=null,this.renderWindow.delete(),this.renderWindow=null,this.openglRenderWindow.delete(),this.openglRenderWindow=null}}])&&xf(t.prototype,n),r&&xf(t,r),a}(c.Component);Of.defaultProps={background:[.2,.3,.4]},Of.propTypes={id:f.a.string,background:f.a.array,setProps:f.a.func,children:f.a.oneOfType([f.a.arrayOf(f.a.node),f.a.node])},n.d(t,"VtkCellData",(function(){return b})),n.d(t,"VtkDataArray",(function(){return Oo})),n.d(t,"VtkFieldData",(function(){return Bo})),n.d(t,"VtkGeometryRepresentation",(function(){return Qi})),n.d(t,"VtkPointData",(function(){return ns})),n.d(t,"VtkPolyDataSource",(function(){return el})),n.d(t,"VtkView",(function(){return Of}))}]);
//# sourceMappingURL=dash_vtk.min.js.map